<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[runtimeä¹‹NSMutableArrayå®‰å…¨]]></title>
      <url>http://yoursite.com/2016/06/25/runtime%E4%B9%8BNSMutableArray%E5%AE%89%E5%85%A8/</url>
      <content type="html"><![CDATA[<p>æ˜¨å¤©çš„<strong><a href="http://www.masyang.com/2016/01/22/runtimeä¹‹NSArrayã€NSDictionaryå®‰å…¨/" target="_blank" rel="external">åšæ–‡:runtimeä¹‹NSArrayå®‰å…¨</a></strong>å·²ç»ä»‹ç»äº†æœ‰å…³é€šè¿‡<font color="red"> Swizzing </font>ä½¿NSArrayå®‰å…¨çš„æ“ä½œ,é‚£ä¹ˆä»Šå¤©æˆ‘ä»¬æ¥è°ˆä¸€ä¸‹ç›¸å¯¹ç¹ççš„ä½¿ç”¨Swizzingè®©NSMutableArrayå®‰å…¨çš„æ“ä½œ.<small>PS:æ–‡ç¬”ä¸è¡Œ,æœ›æµ·æ¶µ</small></p>
   <a id="more"></a>  
<p><strong><a href="https://github.com/OneHalfTooth/Runtime_Safe" target="_blank" rel="external">demoåœ°å€ : https://github.com/OneHalfTooth/Runtime_Safe</a></strong></p>
<h2 id="ç”¨åˆ°çš„æ–¹æ³•"><a href="#ç”¨åˆ°çš„æ–¹æ³•" class="headerlink" title="ç”¨åˆ°çš„æ–¹æ³•"></a>ç”¨åˆ°çš„æ–¹æ³•</h2><font color="green"><br>//å¾—åˆ°ç±»çš„å®ä¾‹æ–¹æ³•çš„å®ç° è¿”å›å€¼ä¸ºMethodç±»å‹</font><br><strong>1ã€</strong> class_getInstanceMethod(Class cls, SEL name)<br><br><font color="green"> //å¾—åˆ°ç±»çš„ç±»æ–¹æ³•çš„å®ç° è¿”å›å€¼ä¸ºMethodç±»å‹</font><br><strong>2ã€</strong> class_getClassMethod(Class cls, SEL name)<br><br><font color="green"> //äº¤æ¢æ–¹æ³•m1 å’Œæ–¹æ³•m2çš„å®ç°</font><br><strong>3ã€</strong> method_exchangeImplementations(Method m1, Method m2)<br><br><font color="green"> /*å°±åƒApplicationæœ‰ç”Ÿå‘½å‘¨æœŸå›è°ƒæ–¹æ³•ä¸€æ ·,åœ¨Objective-Cçš„ç±»è¢«åŠ è½½å’Œåˆå§‹åŒ–çš„æ—¶å€™çš„å›è°ƒæ–¹æ³•,å¯ä»¥ä½¿ç”¨ Method Swizzing ä»¥ä¿è¯ Method SwizzingæˆåŠŸ*/</font><br><strong>4ã€</strong> + (void)load<br>

<h2 id="è¦è§£å†³çš„ç—›ç‚¹"><a href="#è¦è§£å†³çš„ç—›ç‚¹" class="headerlink" title="è¦è§£å†³çš„ç—›ç‚¹"></a>è¦è§£å†³çš„ç—›ç‚¹</h2><p><strong>NSMutableArray * array = [[NSMutableArray alloc]init];</strong></p>
<p><font color="green">/* arrayè¿½åŠ ä¸€ä¸ªnilå¯¹è±¡*/</font><br><strong>1.</strong> [array addObject:nil];</p>
<p><font color="green">/* arrayè¿½åŠ ä¸€ä¸ªnilçš„æ•°ç»„*/</font><br><strong>2.</strong> [array addObjectsFromArray:nil];</p>
<p><font color="green">/* arrayæ’å…¥ä¸€ä¸ªnil*/</font><br><strong>3.</strong> [array insertObject:nil atIndex:0];</p>
<p><font color="green">/* åœ¨arrayå¤§äºarray.count ä½ç½®æ’å…¥ä¸€ä¸ªå¯¹è±¡*/</font><br><strong>4.</strong> [array insertObject:@â€keyâ€ atIndex:9999];</p>
<p><font color="green">/* arrayç§»é™¤ä¸€ä¸ªnilçš„å¯¹è±¡*/</font><br><strong>5.</strong> [array removeObject:nil];</p>
<p><font color="green">/* ç§»é™¤arrayå¤§äºarray.count ä½ç½®çš„å¯¹è±¡*/</font><br><strong>6.</strong> [array removeObjectAtIndex:9999];</p>
<p><strong>ä»¥ä¸Šæƒ…å†µåŸºæœ¬éƒ½èƒ½å¯¼è‡´åº”ç”¨crash,ç°åœ¨æˆ‘ä»¬å°±æ¥å½»åº•è§£å†³è¿™ç§crash</strong></p>
<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><h5 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h5><ol>
<li>ä½¿ç”¨runtime <font color="red"> Method Swizzing </font>æ›¿æ¢ä¸Šè¿°å‡ ä¸ªæ–¹æ³•</li>
<li>è®©ç¨‹åºæ¯æ¬¡è°ƒç”¨çš„ä»¥ä¸Šå‡ ä¸ªæ–¹æ³•ä¹‹å‰,é¦–å…ˆè°ƒç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ–¹æ³•</li>
<li>åœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ–¹æ³•ä¸­æ ¡éªŒå‚æ•°åˆæ³•æ€§ç­‰,ä»¥ä¿éšœä¹‹åè°ƒç”¨ç³»ç»Ÿçš„æ–¹æ³•ä¸ä¼šäº§ç”Ÿ<font color="red">crash</font></li>
<li>æ‰§è¡Œå®Œå‚æ•°åˆæ³•æ€§åˆ¤æ–­ä¹‹å,è°ƒç”¨ç³»ç»Ÿçš„æ–¹æ³•,ä»¥è¾¾åˆ°é¢„æœŸè°ƒç”¨ç›®çš„</li>
</ol>
<h5 id="è¦ç‚¹"><a href="#è¦ç‚¹" class="headerlink" title="è¦ç‚¹ "></a><font color="red">è¦ç‚¹ </font></h5><ol>
<li>åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­NSMutableArrayå¯¹è±¡çš„Class åº”è¯¥æ˜¯<font color="red"><strong>__NSArrayM</strong> </font><small>(æ³¨æ„æ˜¯åŒä¸‹åˆ’çº¿)</small></li>
<li>å¿…é¡»ä¿è¯åœ¨NSMutableArrayè¿™ä¸ªå¯¹è±¡åˆå§‹åŒ–,æˆ–è€…ä½¿ç”¨ä¹‹å‰å·²ç»å®Œæˆ<font color="red"> <strong>Method Swizzing</strong> </font>æ›¿æ¢</li>
<li>arr[0] = @â€valueâ€ å’Œ [array addObject:@â€valueâ€] æˆ–è€… [array insertObject:@â€valueâ€ atIndex:0]<font color="red"><strong>è°ƒç”¨çš„ç³»ç»Ÿæ–¹æ³•æ˜¯ä¸åŒçš„</strong></font>.</li>
</ol>
<h5 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h5><h6 id="ä¸€ã€ä½¿ç”¨Method-Swizzingæ›¿æ¢ä¸Šè¿°å‡ ä¸ªæ–¹æ³•"><a href="#ä¸€ã€ä½¿ç”¨Method-Swizzingæ›¿æ¢ä¸Šè¿°å‡ ä¸ªæ–¹æ³•" class="headerlink" title="ä¸€ã€ä½¿ç”¨Method Swizzingæ›¿æ¢ä¸Šè¿°å‡ ä¸ªæ–¹æ³•"></a><small>ä¸€ã€ä½¿ç”¨<font color="red">Method Swizzing</font>æ›¿æ¢ä¸Šè¿°å‡ ä¸ªæ–¹æ³•</small></h6><p>è‡ªå®šä¹‰ä¸Šè¿°çš„å‡ ä¸ªæ–¹æ³•,ç”¨æ¥æ›¿æ¢ç³»ç»Ÿçš„å‡ ä¸ªæ–¹æ³•<small>(è¦æ±‚:å‚æ•°ç±»å‹,è¿”å›å€¼æœ€å¥½ä¿æŒä¸€è‡´)<font color="red">çœ‹å®Œè¿™å‡ ä¸ªæ–¹æ³•,å¯èƒ½æœ‰äº›è®¸ç–‘æƒ‘,ç¨åä¸ºä½ è§£ç­”</font></small>.</p>
<pre><code>//ç”¨æ¥æ›¿æ¢removeObject:æ–¹æ³•
-(void)customRemoveObject:(id)anObject{
    if (anObject) {/*å‚æ•°åˆæ³•æ€§åˆ¤æ–­*/
        //è°ƒç”¨ç³»ç»Ÿçš„RemoveObject:æ–¹æ³•
        [self customRemoveObject:anObject];
    }else{
        NSLog(@&quot;æ•°ç»„ç§»é™¤äº†ä¸€ä¸ªnilçš„å…ƒç´ &quot;);
    }
}
//æ›¿æ¢removeObjectAtIndex:æ–¹æ³•
-(void)customRemoveObjectAtIndex:(NSUInteger)index{
    if (index &lt; self.count) {/*å‚æ•°åˆæ³•æ€§åˆ¤æ–­*/
        //è°ƒç”¨ç³»ç»Ÿçš„RemoveObjectAtIndex:æ–¹æ³•
        [self customRemoveObjectAtIndex:index];
    }else{
        NSLog(@&quot;æ•°ç»„è¶Šç•Œæ“ä½œ,ä¸‹æ ‡ä¸º%lu&quot;,index);
    }
}
//ç”¨æ¥æ›¿æ¢åŒç±»çš„ arr[0] = @&quot;value&quot;è¿™ç§å†™æ³•
-(void)msySetObject:(id)obj atIndexedSubscript:(NSUInteger)idx{
    if (obj) {/*å‚æ•°åˆæ³•æ€§åˆ¤æ–­*/
        //è°ƒç”¨ç³»ç»Ÿçš„setObject:atIndexedSubscript:æ–¹æ³•
        [self msySetObject:obj atIndexedSubscript:idx];
    }else{
        NSLog(@&quot;æ•°ç»„èµ‹å€¼ä¸ºnilï¼š%sä¼ äº†ä¸ªç©ºå€¼\n&quot;,__func__);
    }
}
- (void)msyInsertObject:(id)anObject atIndex:(NSUInteger)index{
    if (anObject &amp;&amp; index &lt;= self.count) {/*å‚æ•°åˆæ³•æ€§åˆ¤æ–­*/
        //è°ƒç”¨ç³»ç»Ÿçš„insertObject:atIndex:æ–¹æ³•
        [self msyInsertObject:anObject atIndex:index];
    }else{
        NSLog(@&quot;æ•°ç»„èµ‹å€¼ä¸ºnilï¼š%sä¼ äº†ä¸ªç©ºå€¼\n&quot;,__func__);
    }
}
- (void)msyAddObject:(id)obj{
    if (obj) {/*å‚æ•°åˆæ³•æ€§åˆ¤æ–­*/
    //è°ƒç”¨ç³»ç»Ÿçš„ObjectAtIndex:æ–¹æ³•
        [self msyAddObject:obj];
    }else{
        NSLog(@&quot;æ•°ç»„èµ‹å€¼ä¸ºnilï¼š%sä¼ äº†ä¸ªç©ºå€¼\n&quot;,__func__);
    }
}
- (id)custmeObjectAtIndex:(NSInteger)index{
    if (index &gt;= self.count) {/*å‚æ•°åˆæ³•æ€§åˆ¤æ–­*/
        return nil;
    }
    //è°ƒç”¨ç³»ç»Ÿçš„ObjectAtIndex:æ–¹æ³•
    return [self custmeObjectAtIndex:index];
}
</code></pre><p><strong>è‡³æ­¤ ç”¨æ¥æ›¿æ¢ç³»ç»Ÿæ–¹æ³•çš„æ–¹æ³•å·²ç»å‡†å¤‡å¥½äº†</strong><br><br><strong>ç„¶åæˆ‘ä»¬è¦ç”¨è‡ªå·±çš„æ–¹æ³•å»æ›¿æ¢ç³»ç»Ÿçš„æ–¹æ³•çš„å®ç°</strong></p>
<pre><code>//å¿…é¡»åŒ…å«è¿è¡Œæ—¶çš„åº“
#import &lt;objc/runtime.h&gt;

//åœ¨loadæ–¹æ³•é‡Œè¾¹äº¤æ¢è‡ªå®šä¹‰æ–¹æ³•ä¸ç³»ç»Ÿæ–¹æ³•çš„å®ç°,
//å› ä¸ºè¿™ä¸ªæ–¹æ³•ä¼šåœ¨ç±»åˆå§‹åŒ–ä¹‹å‰æ‰§è¡Œ,è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¿è¯ç³»ç»Ÿæ–¹æ³•çš„å®ç°å·²ç»è¢«æˆ‘ä»¬æ›¿æ¢
+(void)load{

//å…ˆè·å–NSMutableArrayçš„Class @&quot;__NSArrayM&quot; ä¸ºåŒä¸‹åˆ’çº¿
Class arrayM = NSClassFromString(@&quot;__NSArrayM&quot;);

//è·å–å®ä¾‹æ–¹æ³•addObject:çš„Method
Method methodSuper = class_getInstanceMethod(arrayM, @selector(addObject:));
//è·å–è‡ªå·±å®šä¹‰çš„å®ä¾‹æ–¹æ³•msyAddObject:çš„Method
Method method = class_getInstanceMethod(arrayM, @selector(msyAddObject:));
//äº¤æ¢ä¸¤ä¸ªæ–¹æ³•çš„å®ç°
method_exchangeImplementations(methodSuper, method);

//ä¸€ä¸‹æ³¨é‡ŠåŒä¸Š
Method methodSuperInsert = class_getInstanceMethod(arrayM, @selector(insertObject:atIndex:));
Method methodInsert = class_getInstanceMethod(arrayM, @selector(msyInsertObject:atIndex:));
method_exchangeImplementations(methodSuperInsert, methodInsert);

Method methodSuperSetObj = class_getInstanceMethod(arrayM, @selector(setObject:atIndexedSubscript:));
Method methodSetObj = class_getInstanceMethod(arrayM, @selector(msySetObject:atIndexedSubscript:));
method_exchangeImplementations(methodSetObj, methodSuperSetObj);

Method methodSuperRemove = class_getInstanceMethod(arrayM, @selector(removeObjectAtIndex:));
Method methodRemove = class_getInstanceMethod(arrayM, @selector(customRemoveObjectAtIndex:));
method_exchangeImplementations(methodSuperRemove, methodRemove);

Method methodSuperRemoveObj = class_getInstanceMethod(arrayM, @selector(removeObject:));
Method methodRemoveObj = class_getInstanceMethod(arrayM, @selector(customRemoveObject:));
method_exchangeImplementations(methodSuperRemoveObj, methodRemoveObj);

Method objectAtIndex = class_getInstanceMethod(arrayM, @selector(objectAtIndex:));
Method customeObjectAtIndex = class_getInstanceMethod(arrayM, @selector(custmeObjectAtIndex:));
method_exchangeImplementations(objectAtIndex, customeObjectAtIndex);
</code></pre><p>}</p>
<h6 id="äºŒã€åˆ›å»ºä¸€ä¸ªNSMutableArray-çš„åˆ†ç±»-å°†ä¸Šè¿°ä»£ç æ”¾å…¥"><a href="#äºŒã€åˆ›å»ºä¸€ä¸ªNSMutableArray-çš„åˆ†ç±»-å°†ä¸Šè¿°ä»£ç æ”¾å…¥" class="headerlink" title="äºŒã€åˆ›å»ºä¸€ä¸ªNSMutableArray çš„åˆ†ç±»,å°†ä¸Šè¿°ä»£ç æ”¾å…¥"></a><small>äºŒã€åˆ›å»ºä¸€ä¸ªNSMutableArray çš„åˆ†ç±»,å°†ä¸Šè¿°ä»£ç æ”¾å…¥</small></h6><p><img src="/img/NSMutableArraySafeImage.png"><br>ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†<br><br>ç„¶åä½ å°±å¯ä»¥æ„‰å¿«çš„è¿™æ ·äº†</p>
<pre><code>NSMutableArray * array = [[NSMutableArray alloc]init];
[array addObject:nil];
[array addObjectsFromArray:nil];
[array insertObject:nil atIndex:0];
[array insertObject:@&quot;value&quot; atIndex:9999];
[array insertObjects:nil atIndexes:0];
[array removeObject:nil];
[array removeObjectAtIndex:9999];
[array removeObjectsInArray:nil];
</code></pre><p>å¹¶ä¸”ä½ ä¼šç¥å¥‡çš„å‘ç°ä»–æ²¡æœ‰crash</p>
<h2 id="é—ç•™é—®é¢˜"><a href="#é—ç•™é—®é¢˜" class="headerlink" title="é—ç•™é—®é¢˜"></a>é—ç•™é—®é¢˜</h2><ol>
<li><strong>ä¸Šè¿°ä»£ç ä¸­å‡ºç°äº†è‡ªå·±è°ƒç”¨è‡ªå·±</strong></li>
</ol>
<pre><code>-(void)msyAddObject:(id)obj{
        if (obj) {/*å‚æ•°åˆæ³•æ€§åˆ¤æ–­*/
          [self msyAddObject:obj];//è°ƒç”¨ç³»ç»Ÿçš„addObject:æ–¹æ³•
      }else{
           NSLog(@&quot;æ•°ç»„èµ‹å€¼ä¸ºnilï¼š%sä¼ äº†ä¸ªç©ºå€¼\n&quot;,__func__);
      }
 }
</code></pre><p><small>å¦‚æœä½ ç»†å¿ƒè‚¯å®šä¼šå‘ç°ç¬¬3è¡Œä»£ç å‡ºç°äº†è‡ªå·±è°ƒç”¨è‡ªå·±çš„æƒ…å†µ,ä½†æ˜¯æˆ‘åœ¨åè¾¹çš„æ³¨é‡Šç¡®æ˜¯<font color="green">//è°ƒç”¨ç³»ç»Ÿçš„addObject:æ–¹æ³•</font>.<br>æ­£å¸¸çš„è¯´,è¿™ç§æƒ…å†µåº”è¯¥æ˜¯ä¸€ä¸ªæ­»å¾ªç¯,ä½†æ˜¯ä½ ä¸è¦å¿˜äº†ç°åœ¨æˆ‘ä»¬ä½¿ç”¨äº†Method Swizzing,æˆ‘ä»¬å·²ç»ç”¨runtime å°†<font color="red">msyAddObject:æ–¹æ³•çš„æ–¹æ³•çš„<big><strong>å®ç°</strong></big>ä¸addObject:çš„<strong><big>å®ç°</big></strong>äº¤æ¢</font><br>æˆ‘ä»¬äº¤æ¢çš„åªæ˜¯å®ç°,åªæ˜¯æ–¹æ³•åè¿˜æ˜¯æ²¡æœ‰å˜,æ‰€ä»¥å†™åœ¨msyAddObject:çš„ä»£ç ,ç»è¿‡æˆ‘ä»¬çš„<font color="red">method_exchangeImplementations(Method m1,Method m2)</font>ä¹‹åå·²ç»ä¸æ˜¯å†™åœ¨msyAddObject:é‡Œè¾¹,è€Œæ˜¯åœ¨ç³»ç»Ÿçš„addObject:ä¸­,æ‰€ä»¥æˆ‘ä»¬åœ¨msyAddObject:è°ƒç”¨msyAddObject:çš„æ—¶å€™,å…¶å®æ˜¯è°ƒç”¨ç³»ç»ŸaddObject:çš„å®ç°,æ‰€ä»¥å¹¶ä¸æ˜¯è‡ªå·±è°ƒç”¨è‡ªå·±ğŸ˜„,ä¹Ÿå°±ä¸ä¼šå‡ºç°æ­»å¾ªç¯äº†</small></p>
<ol>
<li><strong>æˆ–è®¸ä½ å‘ç°æœ¬äººåœ¨åˆ›å»ºåˆ†ç±»çš„æ—¶å€™å‡ºç°äº†ä¸€ä¸ª#ifdef DEBUG #else #endif</strong></li>
</ol>
<p><small>è¿™æ˜¯æ¡ä»¶ç¼–è¯‘,è¡¨ç¤ºåœ¨debugæ¨¡å¼ä¸‹ ä¼šç¼–è¯‘#ifdef å’Œ #elseä¹‹é—´çš„ä»£ç ,åœ¨releaseæ¨¡å¼ä¼šç¼–è¯‘#else #endifä¹‹é—´çš„ä»£ç ,è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™èƒ½å¤Ÿå°½å¤šçš„å‘ç°é—®é¢˜,è€Œåœ¨ä¸Šçº¿çš„æ—¶å€™å°½å¤šçš„é¿å…é—®é¢˜</small></p>
<h2 id="è¡¨è¾¾èƒ½åŠ›å¾ˆå·®-å¯èƒ½æœ‰äº›ä¸œè¥¿æ²¡è¯´æ¸…æ¥š-å¦‚æœ‰éœ€è¦å¯ä»¥æ·±å…¥æ²Ÿé€š"><a href="#è¡¨è¾¾èƒ½åŠ›å¾ˆå·®-å¯èƒ½æœ‰äº›ä¸œè¥¿æ²¡è¯´æ¸…æ¥š-å¦‚æœ‰éœ€è¦å¯ä»¥æ·±å…¥æ²Ÿé€š" class="headerlink" title="è¡¨è¾¾èƒ½åŠ›å¾ˆå·®,å¯èƒ½æœ‰äº›ä¸œè¥¿æ²¡è¯´æ¸…æ¥š,å¦‚æœ‰éœ€è¦å¯ä»¥æ·±å…¥æ²Ÿé€š."></a>è¡¨è¾¾èƒ½åŠ›å¾ˆå·®,å¯èƒ½æœ‰äº›ä¸œè¥¿æ²¡è¯´æ¸…æ¥š,å¦‚æœ‰éœ€è¦å¯ä»¥æ·±å…¥æ²Ÿé€š.</h2><p><strong><a href="https://github.com/OneHalfTooth/Runtime_Safe" target="_blank" rel="external">demoåœ°å€ : https://github.com/OneHalfTooth/Runtime_Safe</a></strong><br><br><strong>ä¸ªäººé‚®ç®±:mayang_email@sina.cn</strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[runtimeä¹‹NSMutableDictionaryå®‰å…¨]]></title>
      <url>http://yoursite.com/2016/06/24/runtime%E4%B9%8BNSMutableDictionary%E5%AE%89%E5%85%A8/</url>
      <content type="html"><![CDATA[<p>ä¼—æ‰€å‘¨çŸ¥,appleè¦æ±‚æˆ‘ä»¬åœ¨NSMutableDictionaryä¸­ä¸èƒ½æ’å…¥nil,æ‰€ä»¥æˆ‘ä»¬ä¸€æ—¦å‡ºç°è¿™ç§æ“ä½œå°±ä¼šcrash,ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ä¿è¯å®Œå…¨ä¸ä¼šå‡ºç°è¿™ç§æ“ä½œ,é™¤éä½¿ç”¨å¤§é‡ifå»åšå‚æ•°åˆæ³•æ€§åˆ¤æ–­</p>
<a id="more"></a>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">NSMutableDictionary * testDic = [[NSMutableDictionary alloc]init];</div><div class="line">[testDic setObject:nil forKey:@&quot;key&quot;];</div><div class="line">[testDic removeObjectForKey:nil];</div></pre></td></tr></table></figure>
<p><strong>æ¯”å¦‚ä»¥ä¸Šä¸¤ç§æƒ…å†µ,è‚¯å®šæ¯«ä¸çŠ¹è±«çš„å°±crash</strong><br><br><strong>æ³¨æ„:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">testDic[&quot;key&quot;] = nil;</div></pre></td></tr></table></figure></p>
<p>æ˜¯ä¸ä¼šå´©æºƒçš„,å› ä¸ºç³»ç»Ÿé»˜è®¤åšäº†ç©ºå€¼æ£€æŸ¥,æ¨èä»¥åéƒ½ç”¨è¿™ç§å†™æ³•.</p>
<h5 id="æˆ‘ä»¬ç°åœ¨è¦åšçš„å¦‚æœå°±æ˜¯ä½ ä¸€ä¸å°å¿ƒå‡ºç°ä»¥ä¸Šæ“ä½œ-ç¨‹åºä¸ä¼šcrash"><a href="#æˆ‘ä»¬ç°åœ¨è¦åšçš„å¦‚æœå°±æ˜¯ä½ ä¸€ä¸å°å¿ƒå‡ºç°ä»¥ä¸Šæ“ä½œ-ç¨‹åºä¸ä¼šcrash" class="headerlink" title="æˆ‘ä»¬ç°åœ¨è¦åšçš„å¦‚æœå°±æ˜¯ä½ ä¸€ä¸å°å¿ƒå‡ºç°ä»¥ä¸Šæ“ä½œ,ç¨‹åºä¸ä¼šcrash"></a>æˆ‘ä»¬ç°åœ¨è¦åšçš„å¦‚æœå°±æ˜¯ä½ ä¸€ä¸å°å¿ƒå‡ºç°ä»¥ä¸Šæ“ä½œ,ç¨‹åºä¸ä¼šcrash</h5><p><strong>æˆ‘ä»¬è¦ç”¨åˆ°è¿™ä¹ˆå‡ ä¸ªæ–¹æ³•</strong></p>
<font color="green"><br>//å¾—åˆ°ç±»çš„å®ä¾‹æ–¹æ³•çš„å®ç° è¿”å›å€¼ä¸ºMethodç±»å‹</font><br><strong>1ã€</strong> class_getInstanceMethod(Class cls, SEL name)<br><br><font color="green"> //å¾—åˆ°ç±»çš„ç±»æ–¹æ³•çš„å®ç° è¿”å›å€¼ä¸ºMethodç±»å‹</font><br><strong>2ã€</strong> class_getClassMethod(Class cls, SEL name)<br><br><font color="green"> //äº¤æ¢æ–¹æ³•m1 å’Œæ–¹æ³•m2çš„å®ç°</font><br><strong>3ã€</strong> method_exchangeImplementations(Method m1, Method m2)<br><br><font color="green"> /*å°±åƒApplicationæœ‰ç”Ÿå‘½å‘¨æœŸå›è°ƒæ–¹æ³•ä¸€æ ·,åœ¨Objective-Cçš„ç±»è¢«åŠ è½½å’Œåˆå§‹åŒ–çš„æ—¶å€™çš„å›è°ƒæ–¹æ³•,å¯ä»¥ä½¿ç”¨ Method Swizzing ä»¥ä¿è¯ Method SwizzingæˆåŠŸ*/</font><br><strong>4ã€</strong> + (void)load<br>

<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><ol>
<li>ä½¿ç”¨runtime <font color="red"> Method Swizzing </font>æ›¿æ¢ä¸Šè¿°å‡ ä¸ªæ–¹æ³•</li>
<li>è®©ç¨‹åºæ¯æ¬¡è°ƒç”¨çš„ä»¥ä¸Šå‡ ä¸ªæ–¹æ³•ä¹‹å‰,é¦–å…ˆè°ƒç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ–¹æ³•</li>
<li>åœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ–¹æ³•ä¸­æ ¡éªŒå‚æ•°åˆæ³•æ€§ç­‰,ä»¥ä¿éšœä¹‹åè°ƒç”¨ç³»ç»Ÿçš„æ–¹æ³•ä¸ä¼šäº§ç”Ÿ<font color="red">crash</font></li>
<li>æ‰§è¡Œå®Œå‚æ•°åˆæ³•æ€§åˆ¤æ–­ä¹‹å,è°ƒç”¨ç³»ç»Ÿçš„æ–¹æ³•,ä»¥è¾¾åˆ°é¢„æœŸè°ƒç”¨ç›®çš„</li>
</ol>
<h3 id="è¦ç‚¹"><a href="#è¦ç‚¹" class="headerlink" title="è¦ç‚¹ "></a><font color="red">è¦ç‚¹ </font></h3><ol>
<li>åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­NSMutableArrayå¯¹è±¡çš„Class åº”è¯¥æ˜¯<font color="red"><strong>__NSDictionaryM</strong> </font><small>(æ³¨æ„æ˜¯åŒä¸‹åˆ’çº¿)</small></li>
<li>å¿…é¡»ä¿è¯åœ¨NSMutableArrayè¿™ä¸ªå¯¹è±¡åˆå§‹åŒ–,æˆ–è€…ä½¿ç”¨ä¹‹å‰å·²ç»å®Œæˆ<font color="red"> <strong>Method Swizzing</strong> </font>æ›¿æ¢</li>
</ol>
<h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p> <strong>é¦–å…ˆæˆ‘ä»¬æ¥å®Œæˆå‰ä¸‰æ­¥</strong></p>
<pre><code> -(void)customSetObject:(id)anObject forKey:(id&lt;NSCopying&gt;)aKey{
    if (anObject) {
       [self customSetObject:anObject forKey:aKey];
    }else{
       NSLog(@&quot;setObjectäº†ä¸€ä¸ªç©ºï¼Œkeyä¸º%@&quot;,aKey);
   }
}
-(void)customRemoveObjectForKey:(id)aKey{
    if (aKey) {
        [self customRemoveObjectForKey:aKey];
    }else{
       NSLog(@&quot;removeäº†ä¸€ä¸ªç©ºï¼Œkeyä¸º%@&quot;,aKey);
    }
}
</code></pre><p><strong>è‡³æ­¤ ç”¨æ¥æ›¿æ¢ç³»ç»Ÿæ–¹æ³•çš„æ–¹æ³•å·²ç»å‡†å¤‡å¥½äº†</strong><br><br><strong>ç„¶åæˆ‘ä»¬è¦ç”¨è‡ªå·±çš„æ–¹æ³•å»æ›¿æ¢ç³»ç»Ÿçš„æ–¹æ³•çš„å®ç°</strong></p>
<pre><code>+(void)load{
    Class dictCls = NSClassFromString(@&quot;__NSDictionaryM&quot;);

    Method methodSetObjSuper = class_getInstanceMethod(dictCls, NSSelectorFromString(@&quot;setObject:forKey:&quot;));
    Method methodSetObj = class_getInstanceMethod(dictCls, @selector(customSetObject:forKey:));
    method_exchangeImplementations(methodSetObj, methodSetObjSuper);

    Method methodSuperRemoveKey = class_getInstanceMethod(dictCls, @selector(removeObjectForKey:));
    Method methodRemoveKey = class_getInstanceMethod(dictCls, @selector(customRemoveObjectForKey:));
    method_exchangeImplementations(methodRemoveKey, methodSuperRemoveKey);
}
</code></pre><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯</strong> NSMutableDictionaryåœ¨ç¼–è¯‘çš„æ—¶å€™æ˜¯__NSDictionaryMç±»(åŒä¸‹åˆ’çº¿)</p>
<h3 id="ç„¶åæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªNSMutableDictionaryçš„åˆ†ç±»å°†ä»£ç æ”¾è¿›å»"><a href="#ç„¶åæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªNSMutableDictionaryçš„åˆ†ç±»å°†ä»£ç æ”¾è¿›å»" class="headerlink" title="ç„¶åæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªNSMutableDictionaryçš„åˆ†ç±»å°†ä»£ç æ”¾è¿›å»"></a>ç„¶åæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªNSMutableDictionaryçš„åˆ†ç±»å°†ä»£ç æ”¾è¿›å»</h3><p><strong>æ¯”å¦‚</strong><br><img src="/img/NSMutableDictionary.png"><br>ç„¶åä½ å°±å¯ä»¥å°è¯•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">NSMutableDictionary * testDic = [[NSMutableDictionary alloc]init];</div><div class="line">[testDic setObject:nil forKey:@&quot;key&quot;];</div><div class="line">[testDic removeObjectForKey:nil];</div></pre></td></tr></table></figure></p>
<p>ç„¶åä½ å°±ä¼šå‘ç°ç¨‹åºå¹¶æ²¡æœ‰å´©æºƒ,å…¶å®åŸç†éå¸¸ç®€å•.</p>
<ol>
<li>æˆ‘ä»¬åœ¨ç¨‹åºå¼€å§‹è¿è¡Œçš„æ—¶å€™å·²ç»å°†ç³»ç»Ÿçš„æ–¹æ³•å®ç°æ›¿æ¢æˆè‡ªå·±çš„,åŒæ—¶ä¹Ÿå°†è‡ªå·±çš„æ–¹æ³•å®ç°æ›¿æ¢æˆç³»ç»Ÿçš„,æ‰€ä»¥å¦‚æœæƒ³æ‰§è¡Œç³»ç»Ÿçš„æ–¹æ³•,å…¶å®ä¼šå…ˆæ‰§è¡Œæˆ‘ä»¬è‡ªå®šä¹‰çš„æ–¹æ³•å®ç°,æˆ‘ä»¬åœ¨è‡ªå·±çš„æ–¹æ³•å®ç°ä¸­åšå‚æ•°åˆæ³•æ€§åˆ¤æ–­,å¦‚æœä¸ä¼šå¼•èµ·ç³»ç»Ÿå´©æºƒé‚£æˆ‘ä»¬å°±å»è°ƒç”¨ç³»ç»Ÿæ–¹æ³•,ä¼šå¼•èµ·çš„è¯å°±ä¸è°ƒç”¨,æ‰€ä»¥è‚¯å®šä¸ä¼šå´©æºƒ.</li>
</ol>
<h2 id="demo-https-github-com-OneHalfTooth-Runtime-Safe"><a href="#demo-https-github-com-OneHalfTooth-Runtime-Safe" class="headerlink" title="demo(https://github.com/OneHalfTooth/Runtime_Safe"></a><a href="https://github.com/OneHalfTooth/Runtime_Safe" target="_blank" rel="external">demo(https://github.com/OneHalfTooth/Runtime_Safe</a></h2><p><strong>ä¸ªäººé‚®ç®±:mayang_email@sina.cn</strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[runtimeä¹‹NSDictionaryå®‰å…¨]]></title>
      <url>http://yoursite.com/2016/06/23/runtime%E4%B9%8BNSDictionary%E5%AE%89%E5%85%A8/</url>
      <content type="html"><![CDATA[<p>æ˜¨å¤©å·²ç»å†™æ–‡ç« æ¢è®¨<a href="http://www.masyang.com/2016/01/23/runtimeä¹‹NSMutableArrayå®‰å…¨/" target="_blank" rel="external">runtimeä¹‹NSDictionaryå®‰å…¨</a>é‚£ä¹ˆä»Šå¤©æˆ‘ä»¬å°±æ¥æ¢è®¨ä¸€ä¸‹æ€æ ·è®©NSDictionaryå®‰å…¨,ä½¿NSDictionaryæ“ä½œnilè€Œä¸crash<br><a id="more"></a></p>
<h2 id="è¦è§£å†³çš„é—®é¢˜"><a href="#è¦è§£å†³çš„é—®é¢˜" class="headerlink" title="è¦è§£å†³çš„é—®é¢˜"></a>è¦è§£å†³çš„é—®é¢˜</h2><p> åœ¨NSDictionaryä¸­ä¸ç®¡æ˜¯keyè¿˜æ˜¯valueæ˜¯ä¸èƒ½å‡ºç°nilçš„,ç„¶è€Œæˆ‘ä»¬åœ¨åšä»»ä½•æœ‰å…³NSDictionaryæ“ä½œçš„æ—¶å€™æˆ‘ä»¬éƒ½è¦è€ƒè™‘è¿™ä¸ªé—®é¢˜,å‚æ•°ä¼šä¸ä¼šæ˜¯nil,ä¼šä¸ä¼šå¼•èµ·å´©æºƒ.ç„¶åæˆ‘ä»¬ä¸ºäº†ç¨‹åºçš„å¥å£®æ€§,å°±å†™äº†ä¸€å †if,æ¥æ ¡éªŒå‚æ•°åˆæ³•æ€§.æ¥ä¿è¯ç¨‹åºä¸ä¼šå†è¿è¡Œçš„æ—¶å€™crash.<br> ç°åœ¨æˆ‘ä»¬ç”¨runtime,ä»æ ¹æœ¬ä¸Šå»é¢„é˜²NSDictionaryæ’å…¥nilå´©æºƒè¿™ç§é—®é¢˜<br><br> <strong>ç›¸å¯¹äºNSMutableDictionaryæ¥è¯´NSDictionaryæˆ‘ä»¬éœ€è¦è§£å†³çš„é—®é¢˜å°±è¦å°‘çš„å¤š</strong><br><br>æ¯”å¦‚<font color="red"><strong>NSDictionary * test = @{@â€crashâ€: nil, @â€keyâ€: @â€valueâ€};</strong></font><br><br><strong>åœ¨è¿™åªæ¼”ç¤ºæ›¿æ¢ä¸€ä¸ªæ–¹æ³•,å¦‚æœ‰æ›´å¤šéœ€è¦è¯·çœ‹<a href="https://github.com/OneHalfTooth/Runtime_Safe" target="_blank" rel="external">demo:https://github.com/OneHalfTooth/Runtime_Safe</a></strong></p>
<h2 id="è¦ä½¿ç”¨çš„æ–¹æ³•"><a href="#è¦ä½¿ç”¨çš„æ–¹æ³•" class="headerlink" title="è¦ä½¿ç”¨çš„æ–¹æ³•"></a>è¦ä½¿ç”¨çš„æ–¹æ³•</h2><font color="green"><br>//å¾—åˆ°ç±»çš„å®ä¾‹æ–¹æ³•çš„å®ç° è¿”å›å€¼ä¸ºMethodç±»å‹</font><br><strong>1ã€</strong> class_getInstanceMethod(Class cls, SEL name)<br><br><font color="green"> //å¾—åˆ°ç±»çš„ç±»æ–¹æ³•çš„å®ç° è¿”å›å€¼ä¸ºMethodç±»å‹</font><br><strong>2ã€</strong> class_getClassMethod(Class cls, SEL name)<br><br><font color="green"> //äº¤æ¢æ–¹æ³•m1 å’Œæ–¹æ³•m2çš„å®ç°</font><br><strong>3ã€</strong> method_exchangeImplementations(Method m1, Method m2)<br><br><font color="green"> /*å°±åƒApplicationæœ‰ç”Ÿå‘½å‘¨æœŸå›è°ƒæ–¹æ³•ä¸€æ ·,åœ¨Objective-Cçš„ç±»è¢«åŠ è½½å’Œåˆå§‹åŒ–çš„æ—¶å€™çš„å›è°ƒæ–¹æ³•,å¯ä»¥ä½¿ç”¨ Method Swizzing ä»¥ä¿è¯ Method SwizzingæˆåŠŸ*/</font><br><strong>4ã€</strong> + (void)load<br>

<h2 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h2><h5 id="è§£å†³æ€è·¯"><a href="#è§£å†³æ€è·¯" class="headerlink" title="è§£å†³æ€è·¯"></a>è§£å†³æ€è·¯</h5><ol>
<li>ä½¿ç”¨è‡ªå®šä¹‰çš„æ–¹æ³•,å°†ç³»ç»Ÿçš„æ–¹æ³•æ›¿æ¢æ‰</li>
<li>åœ¨è‡ªå®šä¹‰æ–¹æ³•ä¸­åšå‚æ•°åˆæ³•æ€§åˆ¤æ–­</li>
<li>è°ƒç”¨ç³»ç»Ÿçš„æ–¹æ³•ä»¥è¾¾åˆ°é¢„æœŸç›®çš„</li>
<li>äº¤æ¢è‡ªå®šä¹‰æ–¹æ³•ä¸ç³»ç»Ÿæ–¹æ³•çš„å®ç°</li>
</ol>
<h5 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h5><ol>
<li>å®ç°è§£å†³æ€è·¯çš„å‰ä¸‰æ­¥<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">+(instancetype)customDictionaryWithObjects:(const id [])objects forKeys:(const id &lt;NSCopying&gt; [])keys count:(NSUInteger)cnt &#123;</div><div class="line">	id nObjects[cnt];</div><div class="line">	id nKeys[cnt];</div><div class="line">	int i=0, j=0;</div><div class="line">	for (; i&lt;cnt &amp;&amp; j&lt;cnt; i++) &#123;</div><div class="line">		if (objects[i] &amp;&amp; keys[i]) &#123;</div><div class="line">			nObjects[j] = objects[i];</div><div class="line">			nKeys[j] = keys[i];</div><div class="line">			j++;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	return [self customDictionaryWithObjects:nObjects forKeys:nKeys count:j];//è°ƒç”¨ç³»ç»Ÿçš„æ–¹æ³•</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><strong>å¯¹objectsè¿›è¡Œç©ºå€¼è¿‡æ»¤ï¼Œå¦‚æœæ˜¯ç©ºå€¼çš„è¯ï¼Œä¸æ’å…¥å­—å…¸ã€‚è¾¾åˆ°å‚æ•°åˆæ³•æ€§åˆ¤æ–­çš„ç›®çš„</strong></p>
<ol>
<li>æ›¿æ¢ç³»ç»Ÿçš„æ–¹æ³•</li>
</ol>
<pre><code>+(void)load{
    Method originalMethod = class_getClassMethod(self, @selector(dictionaryWithObjects:forKeys:count:));
    Method swizzledMethod = class_getClassMethod(self, @selector(customDictionaryWithObjects:forKeys:count:));
    method_exchangeImplementations(originalMethod, swizzledMethod);
}
</code></pre><h2 id="ä¸€äº›é—®é¢˜"><a href="#ä¸€äº›é—®é¢˜" class="headerlink" title="ä¸€äº›é—®é¢˜"></a>ä¸€äº›é—®é¢˜</h2><ol>
<li><p><strong>ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åœ¨loadä¸­æ‰§è¡ŒMethod Swizzing</strong><br><br> å› ä¸ºè¿™ä¸ªæ–¹æ³•ä¼šåœ¨ç±»åˆå§‹åŒ–ä¹‹å‰æ‰§è¡Œ,è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¿è¯ç³»ç»Ÿæ–¹æ³•çš„å®ç°å·²ç»è¢«æˆ‘ä»¬æ›¿æ¢</p>
</li>
<li><p><strong>ä»¥ä¸Šä»£ç ä¸­å‡ºç°è‡ªå·±è°ƒç”¨è‡ªå·±çš„æ­»å¾ªç¯</strong><br> å¦‚æœä½ ç»†å¿ƒè‚¯å®šä¼šå‘ç°ä¸Šè¾¹è‡ªå®šä¹‰æ–¹æ³•é‡Œè¾¹å‡ºç°äº†è‡ªå·±è°ƒç”¨è‡ªå·±çš„æƒ…å†µ,ä½†æ˜¯æˆ‘åœ¨åè¾¹çš„æ³¨é‡Šç¡®æ˜¯//è°ƒç”¨ç³»ç»Ÿçš„æ–¹æ³•. æ­£å¸¸çš„è¯´,è¿™ç§æƒ…å†µåº”è¯¥æ˜¯ä¸€ä¸ªæ­»å¾ªç¯,ä½†æ˜¯ä½ ä¸è¦å¿˜äº†ç°åœ¨æˆ‘ä»¬ä½¿ç”¨äº†Method Swizzing,æˆ‘ä»¬å·²ç»ç”¨runtime å°†è‡ªå®šä¹‰æ–¹æ³•çš„æ–¹æ³•çš„å®ç°ä¸ç³»ç»Ÿçš„å®ç°äº¤æ¢ æˆ‘ä»¬äº¤æ¢çš„åªæ˜¯å®ç°,åªæ˜¯æ–¹æ³•åè¿˜æ˜¯æ²¡æœ‰å˜</p>
</li>
</ol>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[runtimeä¹‹NSArrayå®‰å…¨]]></title>
      <url>http://yoursite.com/2016/06/22/runtime%E4%B9%8BNSArray%E3%80%81NSDictionary%E5%AE%89%E5%85%A8/</url>
      <content type="html"><![CDATA[<p>çœ‹äº†<a href="http://www.cnblogs.com/muyushifang07/p/5737564.html" target="_blank" rel="external"><strong>æ²é›¨åæ–¹07</strong></a>çš„è¿™ç¯‡åšå®¢ä¹‹åï¼Œæˆ‘å†³å®šå°†è‡ªå·±å¼€å‘è¿‡ç¨‹ä¸­ç”¨çš„ä¸€ä¸ªå°æŠ€å·§åˆ†äº«ä¸€ä¸‹,ä»¥æ–¹ä¾¿å„ç§çŒ¿çš„ç¨‹åºå¼€å‘ã€‚</p>
   <a id="more"></a>  
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨appleçš„æ·«å¨ä¸‹NSArray,NSDictionary,NSMutableArray,NSMutableDictionaryæ˜¯ä¸ä¸èƒ½å‡ºç°æœ‰å…³nilçš„æ“ä½œ,ä¸€æ—¦æ“ä½œå°±ä¼šå‡ºç°<strong>crash</strong>çš„åæœ,å¦‚æœæˆ‘ä»¬è¦é¿å…è¿™ç§<strong>crash</strong>é‚£ä¹ˆå°±è¦å¢åŠ è®¸å¤šif,ç°åœ¨æˆ‘ä»¬æ¥åˆ©ç”¨runtimeå½»åº•è§£å†³è¿™ä¸ªé—®é¢˜.<br><br><br><a href="https://github.com/OneHalfTooth/Runtime_Safe" target="_blank" rel="external">demoåœ°å€ : https://github.com/OneHalfTooth/Runtime_Safe</a></p>
<p><strong>é¦–å…ˆæˆ‘ä»¬å¯èƒ½ç”¨åˆ°å‡ ä¸ªå‡½æ•°</strong>ï¼ˆéœ€è¦åŒ…å«<font color="red">è¿è¡Œæ—¶åº“</font>ï¼‰<br><br> <font color="red">class_getInstanceMethod(Class cls, SEL name):å¾—åˆ°ç±»çš„å®ä¾‹æ–¹æ³•</font></p>
  <font color="red">class_getClassMethod(Class cls, SEL name):å¾—åˆ°ç±»çš„ç±»æ–¹æ³•</font>

<p>  <font color="red"> method_exchangeImplementations(Method m1, Method m2) : äº¤æ¢æ–¹æ³•m1 å’Œæ–¹æ³•m2çš„å®ç°</font></p>
<h2 id="runtimeä¹‹NSArrayçš„nilæ“ä½œ"><a href="#runtimeä¹‹NSArrayçš„nilæ“ä½œ" class="headerlink" title="runtimeä¹‹NSArrayçš„nilæ“ä½œ"></a>runtimeä¹‹NSArrayçš„nilæ“ä½œ</h2><p>ç ä»£ç çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¸€ä¸å°å¿ƒå¯èƒ½å°±ä¼šå‡ºç°ç±»ä¼¼äºè¿™ç§æƒ…å†µ</p>
<pre><code>NSArray * temp = @[@&quot;0&quot;,@&quot;1&quot;,@&quot;2&quot;];
NSString * str = [temp objectAtIndex:4];
</code></pre><p>åæœå°±æ˜¯<strong>crash</strong><br><br>ä½†æ˜¯æˆ‘ä»¬å‘ç°å¤§ç‰›ä»¬å†™ä»£ç çš„æ—¶å€™é€šå¸¸<strong>å¾ˆå°‘å‡ºç°å¯¹æ•°ç»„è¶Šç•Œ</strong>çš„å¼‚å¸¸å¤„ç†æƒ…å†µ,åˆ°åº•æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Œå…¶å®æˆ‘ä¹Ÿä¸çŸ¥é“ğŸ˜<br><br>è€Œæˆ‘æ˜¯ä½¿ç”¨runtimeçš„é»‘é­”æ³•æ¥è§£å†³è¿™ç§æƒ…å†µçš„,è¯·çœ‹æºç <br></p>
<pre><code>- (id)custmeObjectAtIndex:(NSInteger)index{
if (index &gt;= self.count) {
    return nil;
}
//æˆ–è®¸ä½ å¯¹è¿™é‡Œæœ‰ä¸ªç–‘é—®ï¼Œç¨åè§£ç­”
return [self custmeObjectAtIndex:index];
}
</code></pre><p>é¦–å…ˆæˆ‘å£°æ˜ä¸€ä¸ªæ–¹æ³•,å› ä¸ºæˆ‘è¦ç”¨é»‘é­”æ³•<font color="red">ï¼ˆMethod Swizzlingï¼‰</font>å°†ç³»ç»Ÿçš„<strong>objectAtIndex:</strong>æ–¹æ³•å®ç°ç»™æ›¿æ¢æ‰,è¿™æ ·åšçš„ç›®çš„æ˜¯åœ¨<strong>NSArrayè°ƒç”¨objectAtIndex:</strong>æ–¹æ³•çš„æ—¶å€™ï¼Œé¦–å…ˆè°ƒç”¨<strong>(custmeObjectAtIndex:)</strong>æœ¬äººå®šä¹‰å¥½çš„æ–¹æ³•,ç„¶ååœ¨custmeObjectAtIndex:è¿™ä¸ªæ–¹æ³•ä¸­å»åˆ¤æ–­å‚æ•°åˆæ³•æ€§ï¼Œå†åšä¸‹ä¸€æ­¥æ‰“ç®—.<br><br>ç„¶åæˆ‘ä»¬å¼€å§‹ä½¿ç”¨<font color="red">ï¼ˆMethod Swizzlingï¼‰</font>å°†ç³»ç»Ÿ<strong>objectAtIndex:</strong>çš„å®ç°å’Œ<strong>(custmeObjectAtIndex:)</strong>çš„å®ç°è¿›è¡Œäº¤æ¢</p>
<pre><code>//NSArray åœ¨ç¼–è¯‘çš„æ—¶å€™åå­—å¹¶ä¸æ˜¯NSarrayè€Œæ˜¯__NSArray0
Class arrayM = NSClassFromString(@&quot;__NSArray0&quot;);

//è·å–åˆ°ç³»ç»ŸobjectAtIndex:
Method objectAtIndex = class_getInstanceMethod(arrayM, @selector(objectAtIndex:));

//è·å–è‡ªå®šä¹‰çš„custmeObjectAtIndex:
Method customeObjectAtIndex = class_getInstanceMethod(arrayM, @selector(custmeObjectAtIndex:));

//äº¤æ¢ä¸¤ä¸ªæ–¹æ³•çš„å®ç°
method_exchangeImplementations(objectAtIndex, customeObjectAtIndex);
</code></pre><p>è‡³æ­¤,æˆ‘ä»¬å¸¸è§çš„æ•°ç»„è¶Šç•Œcrashå·²ç»è¢«è§£å†³äº†,ä½†æ˜¯ä½ æ˜¯ä¸æ˜¯å·²ç»è’™åœˆäº†ğŸ˜,ä¸ºä»€ä¹ˆåœ¨<strong>- (id)custmeObjectAtIndex:(NSInteger)index</strong>æ–¹æ³•ä¸­å‡ºç°äº† <strong>[self custmeObjectAtIndex:index];</strong>è‡ªå·±è°ƒç”¨è‡ªå·±è¿™ç§æƒ…å†µå‘¢,å‰è¾¹æˆ‘å·²ç»è¯´äº†æ˜¯äº¤æ¢ä¸¤ä¸ªæ–¹æ³•çš„å®ç°,æ‰€ä»¥è¯´ä¸¤ä¸ªæ–¹æ³•çš„å†…å®¹<strong>(ç®€å•çš„è¯´å°±æ˜¯æ–¹æ³•é‡Œè¾¹çš„ä»£ç )</strong>å·²ç»è¢«äº¤æ¢,æ‰€ä»¥[self custmeObjectAtIndex:index]è¿™å¥ä»£ç è°ƒç”¨çš„ç³»ç»ŸobjectAtIndex:çš„å®ç°ï¼Œæ‰€ä»¥å¹¶ä¸æ˜¯è‡ªå·±è°ƒç”¨è‡ªå·±</p>
<p><strong>æˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„ä¸€ç‚¹,æˆ‘ä»¬å¿…é¡»ä¿è¯ä»»ä½•æ—¶é—´,åªè¦æ˜¯æœ‰å…³NSArrayçš„æ“ä½œ,æˆ‘ä»¬çš„runtimeå·²ç»æ‰§è¡Œè¿‡äº†<br>æ‰€ä»¥æˆ‘ä»¬è¦åœ¨+ (void)loadæ–¹æ³•å»æ‰§è¡Œè¿™ä¸ªSwizzing</strong></p>
<pre><code>#import &lt;UIKit/UIKit.h&gt;
#import &lt;objc/runtime.h&gt;

//åˆ†ç±»
@implementation NSArray (Safe)
//åˆå§‹åŒ–çš„æ—¶å€™ä¼šè¢«æ‰§è¡Œä¸€æ¬¡
+ (void)load {

Method originalMethod = class_getClassMethod(self, @selector(arrayWithObjects:count:));
Method swizzledMethod = class_getClassMethod(self, @selector(customArrayWithObjects:count:));
method_exchangeImplementations(originalMethod, swizzledMethod);

Class arrayM = NSClassFromString(@&quot;__NSArray0&quot;);
Method objectAtIndex = class_getInstanceMethod(arrayM, @selector(objectAtIndex:));
Method customeObjectAtIndex = class_getInstanceMethod(arrayM, @selector(custmeObjectAtIndex:));
method_exchangeImplementations(objectAtIndex, customeObjectAtIndex);

}


+ (instancetype)customArrayWithObjects:(const id [])objects count:(NSUInteger)cnt {

    id nObjects[cnt];
    int i=0, j=0;
    for (; i&lt;cnt &amp;&amp; j&lt;cnt; i++) {
        if (objects[i]) {
            nObjects[j] = objects[i];
            j++;
        }
    }
    return [self customArrayWithObjects:nObjects count:j];
}

- (id)custmeObjectAtIndex:(NSInteger)index{

    if (index &gt;= self.count) {
        return nil;
    }
return [self custmeObjectAtIndex:index];
}
</code></pre><p><strong>è‡³æ­¤ä¸€ä¸ªå…³äºNSArrayçš„å®‰å…¨ç±»å·²ç»ç»“æŸ,å½“ç„¶è¿™åªæ˜¯ä¸€éƒ¨åˆ†,æ›´è¯¦ç»†è¯·<a href="https://github.com/OneHalfTooth/Runtime_Safe" target="_blank" rel="external">æŸ¥çœ‹demo:https://github.com/OneHalfTooth/Runtime_Safe</a></strong><br><br><strong>æ¬¢è¿æå‡ºæ‚¨çš„å®è´µæ„è§:<font color="blue">mayang_email@sina.cn</font></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[åˆè¯†ReactiveCocoa]]></title>
      <url>http://yoursite.com/2016/05/11/%E5%88%9D%E8%AF%86ReactiveCocoa/</url>
      <content type="html"><![CDATA[<p><a href="https://github.com/ReactiveCocoa/ReactiveCocoa" target="_blank" rel="external">ReactiveCocoa</a>(ç®€ç§°ä¸ºRAC), æ˜¯ç”±Githubå¼€æºçš„ä¸€ä¸ªåº”ç”¨äºiOSå’ŒOSå¼€å‘çš„æ–°æ¡†æ¶, RACå…·æœ‰å‡½æ•°å¼ç¼–ç¨‹å’Œå“åº”å¼ç¼–ç¨‹çš„ç‰¹æ€§, é€šè¿‡è¿™ç¯‡æ–‡ç« å¯¹RACæœ‰ä¸€ä¸ªç®€å•çš„äº†è§£ã€‚</p>
<a id="more"></a>
<h3 id="1-å¦‚ä½•å¯¼å…¥ReactiveCocoaæ¡†æ¶"><a href="#1-å¦‚ä½•å¯¼å…¥ReactiveCocoaæ¡†æ¶" class="headerlink" title="1.å¦‚ä½•å¯¼å…¥ReactiveCocoaæ¡†æ¶"></a>1.å¦‚ä½•å¯¼å…¥ReactiveCocoaæ¡†æ¶</h3><p>é€šå¸¸éƒ½ä¼šä½¿ç”¨CocoaPodsï¼ˆç”¨äºç®¡ç†ç¬¬ä¸‰æ–¹æ¡†æ¶çš„æ’ä»¶ï¼‰å¸®åŠ©æˆ‘ä»¬å¯¼å…¥ã€‚PS:<a href="http://code4app.com/article/cocoapods-install-usage" target="_blank" rel="external">CocoaPodsæ•™ç¨‹</a><br><strong>æ³¨æ„:</strong> 2.5ç‰ˆæœ¬ä»¥åä¸æ”¯æŒiOS7</p>
<h3 id="2-ReactiveCocoaå¸¸è§ç±»"><a href="#2-ReactiveCocoaå¸¸è§ç±»" class="headerlink" title="2.ReactiveCocoaå¸¸è§ç±»"></a>2.ReactiveCocoaå¸¸è§ç±»</h3><p>ã€€ã€€å­¦ä¹ æ¡†æ¶é¦–è¦ä¹‹å¤„:ä¸ªäººè®¤ä¸ºå…ˆè¦ææ¸…æ¥šæ¡†æ¶ä¸­å¸¸ç”¨çš„ç±»ï¼Œåœ¨RACä¸­æœ€æ ¸å¿ƒçš„ç±»RACSiganl,æå®šè¿™ä¸ªç±»å°±èƒ½ç”¨ReactiveCocoaå¼€å‘äº†ã€‚<br><strong>RACSiganlï¼š</strong> ä¿¡å·ç±»,ä¸€èˆ¬è¡¨ç¤ºå°†æ¥æœ‰æ•°æ®ä¼ é€’ï¼Œåªè¦æœ‰æ•°æ®æ”¹å˜ï¼Œä¿¡å·å†…éƒ¨æ¥æ”¶åˆ°æ•°æ®ï¼Œå°±ä¼šé©¬ä¸Šå‘å‡ºæ•°æ®ã€‚</p>
<ul>
<li>ä¿¡å·ç±»(RACSiganl)ï¼Œåªæ˜¯è¡¨ç¤ºå½“æ•°æ®æ”¹å˜æ—¶ï¼Œä¿¡å·å†…éƒ¨ä¼šå‘å‡ºæ•°æ®ï¼Œå®ƒæœ¬èº«ä¸å…·å¤‡å‘é€ä¿¡å·çš„èƒ½åŠ›ï¼Œè€Œæ˜¯äº¤ç»™å†…éƒ¨ä¸€ä¸ªè®¢é˜…è€…å»å‘å‡ºã€‚</li>
<li>é»˜è®¤ä¸€ä¸ªä¿¡å·éƒ½æ˜¯å†·ä¿¡å·ï¼Œä¹Ÿå°±æ˜¯å€¼æ”¹å˜äº†ï¼Œä¹Ÿä¸ä¼šè§¦å‘ï¼Œåªæœ‰è®¢é˜…äº†è¿™ä¸ªä¿¡å·ï¼Œè¿™ä¸ªä¿¡å·æ‰ä¼šå˜ä¸ºçƒ­ä¿¡å·ï¼Œå€¼æ”¹å˜äº†æ‰ä¼šè§¦å‘ã€‚</li>
<li>å¦‚ä½•è®¢é˜…ä¿¡å·ï¼šè°ƒç”¨ä¿¡å·RACSignalçš„subscribeNextå°±èƒ½è®¢é˜…ã€‚</li>
<li><code>RACSiganl</code>ç®€å•ä½¿ç”¨:</li>
</ul>
<pre><code>
    // RACSignalä½¿ç”¨æ­¥éª¤ï¼š
    // 1.åˆ›å»ºä¿¡å· + (RACSignal *)createSignal:(RACDisposable * (^)(id<racsubscriber> subscriber))didSubscribe
    // 2.è®¢é˜…ä¿¡å·,æ‰ä¼šæ¿€æ´»ä¿¡å·. - (RACDisposable *)subscribeNext:(void (^)(id x))nextBlock
    // 3.å‘é€ä¿¡å· - (void)sendNext:(id)value

    // RACSignalåº•å±‚å®ç°ï¼š
    // 1.åˆ›å»ºä¿¡å·ï¼Œé¦–å…ˆæŠŠdidSubscribeä¿å­˜åˆ°ä¿¡å·ä¸­ï¼Œè¿˜ä¸ä¼šè§¦å‘ã€‚
    // 2.å½“ä¿¡å·è¢«è®¢é˜…ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨signalçš„subscribeNext:nextBlock
    // 2.2 subscribeNextå†…éƒ¨ä¼šåˆ›å»ºè®¢é˜…è€…subscriberï¼Œå¹¶ä¸”æŠŠnextBlockä¿å­˜åˆ°subscriberä¸­ã€‚
    // 2.1 subscribeNextå†…éƒ¨ä¼šè°ƒç”¨siganlçš„didSubscribe
    // 3.siganlçš„didSubscribeä¸­è°ƒç”¨[subscriber sendNext:@1];
    // 3.1 sendNextåº•å±‚å…¶å®å°±æ˜¯æ‰§è¡Œsubscriberçš„nextBlock

    // 1.åˆ›å»ºä¿¡å·
    RACSignal *siganl = [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
        // blockè°ƒç”¨æ—¶åˆ»ï¼šæ¯å½“æœ‰è®¢é˜…è€…è®¢é˜…ä¿¡å·ï¼Œå°±ä¼šè°ƒç”¨blockã€‚
        // 2.å‘é€ä¿¡å·
        [subscriber sendNext:@1];
        // å¦‚æœä¸åœ¨å‘é€æ•°æ®ï¼Œæœ€å¥½å‘é€ä¿¡å·å®Œæˆï¼Œå†…éƒ¨ä¼šè‡ªåŠ¨è°ƒç”¨[RACDisposable disposable]å–æ¶ˆè®¢é˜…ä¿¡å·ã€‚
        [subscriber sendCompleted];
        return [RACDisposable disposableWithBlock:^{
            // blockè°ƒç”¨æ—¶åˆ»ï¼šå½“ä¿¡å·å‘é€å®Œæˆæˆ–è€…å‘é€é”™è¯¯ï¼Œå°±ä¼šè‡ªåŠ¨æ‰§è¡Œè¿™ä¸ªblock,å–æ¶ˆè®¢é˜…ä¿¡å·ã€‚
            // æ‰§è¡Œå®ŒBlockåï¼Œå½“å‰ä¿¡å·å°±ä¸åœ¨è¢«è®¢é˜…äº†ã€‚
            NSLog(@"ä¿¡å·è¢«é”€æ¯");
        }];
    }];
    // 3.è®¢é˜…ä¿¡å·,æ‰ä¼šæ¿€æ´»ä¿¡å·.
    [siganl subscribeNext:^(id x) {
        // blockè°ƒç”¨æ—¶åˆ»ï¼šæ¯å½“æœ‰ä¿¡å·å‘å‡ºæ•°æ®ï¼Œå°±ä¼šè°ƒç”¨block.
        NSLog(@"æ¥æ”¶åˆ°æ•°æ®:%@",x);
    }];</racsubscriber></racsubscriber></code></pre>


<p><strong>RACSubscriber</strong>: è¡¨ç¤ºè®¢é˜…è€…çš„æ„æ€ï¼Œç”¨äºå‘é€ä¿¡å·ï¼Œè¿™æ˜¯ä¸€ä¸ªåè®®ï¼Œä¸æ˜¯ä¸€ä¸ªç±»ï¼Œåªè¦éµå®ˆè¿™ä¸ªåè®®ï¼Œå¹¶ä¸”å®ç°æ–¹æ³•æ‰èƒ½æˆä¸ºè®¢é˜…è€…ã€‚é€šè¿‡createåˆ›å»ºçš„ä¿¡å·ï¼Œéƒ½æœ‰ä¸€ä¸ªè®¢é˜…è€…ï¼Œå¸®åŠ©ä»–å‘é€æ•°æ®ã€‚<br><strong>RACDisposable</strong>: ç”¨äºå–æ¶ˆè®¢é˜…æˆ–è€…æ¸…ç†èµ„æºï¼Œå½“ä¿¡å·å‘é€å®Œæˆæˆ–è€…å‘é€é”™è¯¯çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨è§¦å‘å®ƒã€‚</p>
<ul>
<li><code>ä½¿ç”¨åœºæ™¯</code>:ä¸æƒ³ç›‘å¬æŸä¸ªä¿¡å·æ—¶ï¼Œå¯ä»¥é€šè¿‡å®ƒä¸»åŠ¨å–æ¶ˆè®¢é˜…ä¿¡å·ã€‚</li>
</ul>
<p><strong>RACSubject</strong>:ä¿¡å·æä¾›è€…ï¼Œè‡ªå·±å¯ä»¥å……å½“ä¿¡å·ï¼Œåˆèƒ½å‘é€ä¿¡å·ã€‚</p>
<ul>
<li><code>ä½¿ç”¨åœºæ™¯</code>:é€šå¸¸ç”¨æ¥ä»£æ›¿ä»£ç†ï¼Œæœ‰äº†å®ƒï¼Œå°±ä¸å¿…è¦å®šä¹‰ä»£ç†äº†ã€‚</li>
</ul>
<p><strong>RACReplaySubjec</strong>:é‡å¤æä¾›ä¿¡å·ç±»ï¼ŒRACSubjectçš„å­ç±»ã€‚</p>
<ul>
<li><code>RACReplaySubject</code>ä¸<code>RACSubject</code>åŒºåˆ«:<br>ã€€ã€€ã€€&gt; RACReplaySubjectå¯ä»¥å…ˆå‘é€ä¿¡å·ï¼Œåœ¨è®¢é˜…ä¿¡å·ï¼ŒRACSubjectå°±ä¸å¯ä»¥ã€‚</li>
<li><code>ä½¿ç”¨åœºæ™¯ä¸€</code>:å¦‚æœä¸€ä¸ªä¿¡å·æ¯è¢«è®¢é˜…ä¸€æ¬¡ï¼Œå°±éœ€è¦æŠŠä¹‹å‰çš„å€¼é‡å¤å‘é€ä¸€éï¼Œä½¿ç”¨é‡å¤æä¾›ä¿¡å·ç±»ã€‚</li>
<li><code>ä½¿ç”¨åœºæ™¯äºŒ</code>:å¯ä»¥è®¾ç½®capacityæ•°é‡æ¥é™åˆ¶ç¼“å­˜çš„valueçš„æ•°é‡,å³åªç¼“å……æœ€æ–°çš„å‡ ä¸ªå€¼ã€‚</li>
<li><code>RACSubject</code>å’Œ<code>RACReplaySubject</code>ç®€å•ä½¿ç”¨:</li>
</ul>
<pre><code>
// RACSubjectä½¿ç”¨æ­¥éª¤
    // 1.åˆ›å»ºä¿¡å· [RACSubject subject]ï¼Œè·ŸRACSiganlä¸ä¸€æ ·ï¼Œåˆ›å»ºä¿¡å·æ—¶æ²¡æœ‰blockã€‚
    // 2.è®¢é˜…ä¿¡å· - (RACDisposable *)subscribeNext:(void (^)(id x))nextBlock
    // 3.å‘é€ä¿¡å· sendNext:(id)value

    // RACSubject:åº•å±‚å®ç°å’ŒRACSignalä¸ä¸€æ ·ã€‚
    // 1.è°ƒç”¨subscribeNextè®¢é˜…ä¿¡å·ï¼Œåªæ˜¯æŠŠè®¢é˜…è€…ä¿å­˜èµ·æ¥ï¼Œå¹¶ä¸”è®¢é˜…è€…çš„nextBlockå·²ç»èµ‹å€¼äº†ã€‚
    // 2.è°ƒç”¨sendNextå‘é€ä¿¡å·ï¼Œéå†åˆšåˆšä¿å­˜çš„æ‰€æœ‰è®¢é˜…è€…ï¼Œä¸€ä¸ªä¸€ä¸ªè°ƒç”¨è®¢é˜…è€…çš„nextBlockã€‚

    // 1.åˆ›å»ºä¿¡å·
    RACSubject *subject = [RACSubject subject];

    // 2.è®¢é˜…ä¿¡å·
    [subject subscribeNext:^(id x) {
        // blockè°ƒç”¨æ—¶åˆ»ï¼šå½“ä¿¡å·å‘å‡ºæ–°å€¼ï¼Œå°±ä¼šè°ƒç”¨.
        NSLog(@"ç¬¬ä¸€ä¸ªè®¢é˜…è€…%@",x);
    }];
    [subject subscribeNext:^(id x) {
        // blockè°ƒç”¨æ—¶åˆ»ï¼šå½“ä¿¡å·å‘å‡ºæ–°å€¼ï¼Œå°±ä¼šè°ƒç”¨.
        NSLog(@"ç¬¬äºŒä¸ªè®¢é˜…è€…%@",x);
    }];

    // 3.å‘é€ä¿¡å·
    [subject sendNext:@"1"];


    // RACReplaySubjectä½¿ç”¨æ­¥éª¤:
    // 1.åˆ›å»ºä¿¡å· [RACSubject subject]ï¼Œè·ŸRACSiganlä¸ä¸€æ ·ï¼Œåˆ›å»ºä¿¡å·æ—¶æ²¡æœ‰blockã€‚
    // 2.å¯ä»¥å…ˆè®¢é˜…ä¿¡å·ï¼Œä¹Ÿå¯ä»¥å…ˆå‘é€ä¿¡å·ã€‚
    // 2.1 è®¢é˜…ä¿¡å· - (RACDisposable *)subscribeNext:(void (^)(id x))nextBlock
    // 2.2 å‘é€ä¿¡å· sendNext:(id)value

    // RACReplaySubject:åº•å±‚å®ç°å’ŒRACSubjectä¸ä¸€æ ·ã€‚
    // 1.è°ƒç”¨sendNextå‘é€ä¿¡å·ï¼ŒæŠŠå€¼ä¿å­˜èµ·æ¥ï¼Œç„¶åéå†åˆšåˆšä¿å­˜çš„æ‰€æœ‰è®¢é˜…è€…ï¼Œä¸€ä¸ªä¸€ä¸ªè°ƒç”¨è®¢é˜…è€…çš„nextBlockã€‚
    // 2.è°ƒç”¨subscribeNextè®¢é˜…ä¿¡å·ï¼Œéå†ä¿å­˜çš„æ‰€æœ‰å€¼ï¼Œä¸€ä¸ªä¸€ä¸ªè°ƒç”¨è®¢é˜…è€…çš„nextBlock

    // å¦‚æœæƒ³å½“ä¸€ä¸ªä¿¡å·è¢«è®¢é˜…ï¼Œå°±é‡å¤æ’­æ”¾ä¹‹å‰æ‰€æœ‰å€¼ï¼Œéœ€è¦å…ˆå‘é€ä¿¡å·ï¼Œåœ¨è®¢é˜…ä¿¡å·ã€‚
    // ä¹Ÿå°±æ˜¯å…ˆä¿å­˜å€¼ï¼Œåœ¨è®¢é˜…å€¼ã€‚

    // 1.åˆ›å»ºä¿¡å·
    RACReplaySubject *replaySubject = [RACReplaySubject subject];

    // 2.å‘é€ä¿¡å·
    [replaySubject sendNext:@1];
    [replaySubject sendNext:@2];

    // 3.è®¢é˜…ä¿¡å·
    [replaySubject subscribeNext:^(id x) {

        NSLog(@"ç¬¬ä¸€ä¸ªè®¢é˜…è€…æ¥æ”¶åˆ°çš„æ•°æ®%@",x);
    }];

    // è®¢é˜…ä¿¡å·
    [replaySubject subscribeNext:^(id x) {

        NSLog(@"ç¬¬äºŒä¸ªè®¢é˜…è€…æ¥æ”¶åˆ°çš„æ•°æ®%@",x);
    }];
</code></pre>

<ul>
<li><code>RACSubject</code>æ›¿æ¢ä»£ç†</li>
</ul>
<pre><code>
// éœ€æ±‚:
    // 1.ç»™å½“å‰æ§åˆ¶å™¨æ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œmodalåˆ°å¦ä¸€ä¸ªæ§åˆ¶å™¨ç•Œé¢
    // 2.å¦ä¸€ä¸ªæ§åˆ¶å™¨viewä¸­æœ‰ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»æŒ‰é’®ï¼Œé€šçŸ¥å½“å‰æ§åˆ¶å™¨

æ­¥éª¤ä¸€ï¼šåœ¨ç¬¬äºŒä¸ªæ§åˆ¶å™¨.hï¼Œæ·»åŠ ä¸€ä¸ªRACSubjectä»£æ›¿ä»£ç†ã€‚
@interface TwoViewController : UIViewController

@property (nonatomic, strong) RACSubject *delegateSignal;

@end

æ­¥éª¤äºŒï¼šç›‘å¬ç¬¬äºŒä¸ªæ§åˆ¶å™¨æŒ‰é’®ç‚¹å‡»
@implementation TwoViewController
- (IBAction)notice:(id)sender {
    // é€šçŸ¥ç¬¬ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œå‘Šè¯‰å®ƒï¼ŒæŒ‰é’®è¢«ç‚¹äº†

     // é€šçŸ¥ä»£ç†
     // åˆ¤æ–­ä»£ç†ä¿¡å·æ˜¯å¦æœ‰å€¼
    if (self.delegateSignal) {
        // æœ‰å€¼ï¼Œæ‰éœ€è¦é€šçŸ¥
        [self.delegateSignal sendNext:nil];
    }
}
@end

æ­¥éª¤ä¸‰ï¼šåœ¨ç¬¬ä¸€ä¸ªæ§åˆ¶å™¨ä¸­ï¼Œç›‘å¬è·³è½¬æŒ‰é’®ï¼Œç»™ç¬¬äºŒä¸ªæ§åˆ¶å™¨çš„ä»£ç†ä¿¡å·èµ‹å€¼ï¼Œå¹¶ä¸”ç›‘å¬.
@implementation OneViewController
- (IBAction)btnClick:(id)sender {

    // åˆ›å»ºç¬¬äºŒä¸ªæ§åˆ¶å™¨
    TwoViewController *twoVc = [[TwoViewController alloc] init];

    // è®¾ç½®ä»£ç†ä¿¡å·
    twoVc.delegateSignal = [RACSubject subject];

    // è®¢é˜…ä»£ç†ä¿¡å·
    [twoVc.delegateSignal subscribeNext:^(id x) {

        NSLog(@"ç‚¹å‡»äº†é€šçŸ¥æŒ‰é’®");
    }];

    // è·³è½¬åˆ°ç¬¬äºŒä¸ªæ§åˆ¶å™¨
    [self presentViewController:twoVc animated:YES completion:nil];

}
@end
</code></pre>

<ul>
<li><code>RACTuple</code>:å…ƒç»„ç±»,ç±»ä¼¼NSArray,ç”¨æ¥åŒ…è£…å€¼.</li>
<li><code>RACSequence</code>:RACä¸­çš„é›†åˆç±»ï¼Œç”¨äºä»£æ›¿NSArray,NSDictionary,å¯ä»¥ä½¿ç”¨å®ƒæ¥å¿«é€Ÿéå†æ•°ç»„å’Œå­—å…¸ã€‚</li>
<li><code>ä½¿ç”¨åœºæ™¯</code>ï¼š1.å­—å…¸è½¬æ¨¡å‹</li>
<li><code>RACSequence</code>å’Œ<code>RACTuple</code>ç®€å•ä½¿ç”¨</li>
</ul>
<pre><code>
// 1.éå†æ•°ç»„
    NSArray *numbers = @[@1,@2,@3,@4];

    // è¿™é‡Œå…¶å®æ˜¯ä¸‰æ­¥
    // ç¬¬ä¸€æ­¥: æŠŠæ•°ç»„è½¬æ¢æˆé›†åˆRACSequence numbers.rac_sequence
    // ç¬¬äºŒæ­¥: æŠŠé›†åˆRACSequenceè½¬æ¢RACSignalä¿¡å·ç±»,numbers.rac_sequence.signal
    // ç¬¬ä¸‰æ­¥: è®¢é˜…ä¿¡å·ï¼Œæ¿€æ´»ä¿¡å·ï¼Œä¼šè‡ªåŠ¨æŠŠé›†åˆä¸­çš„æ‰€æœ‰å€¼ï¼Œéå†å‡ºæ¥ã€‚
    [numbers.rac_sequence.signal subscribeNext:^(id x) {

        NSLog(@"%@",x);
    }];


    // 2.éå†å­—å…¸,éå†å‡ºæ¥çš„é”®å€¼å¯¹ä¼šåŒ…è£…æˆRACTuple(å…ƒç»„å¯¹è±¡)
    NSDictionary *dict = @{@"name":@"xmg",@"age":@18};
    [dict.rac_sequence.signal subscribeNext:^(RACTuple *x) {

        // è§£åŒ…å…ƒç»„ï¼Œä¼šæŠŠå…ƒç»„çš„å€¼ï¼ŒæŒ‰é¡ºåºç»™å‚æ•°é‡Œé¢çš„å˜é‡èµ‹å€¼
        RACTupleUnpack(NSString *key,NSString *value) = x;

        // ç›¸å½“äºä»¥ä¸‹å†™æ³•
//        NSString *key = x[0];
//        NSString *value = x[1];

        NSLog(@"%@ %@",key,value);

    }];


    // 3.å­—å…¸è½¬æ¨¡å‹
    // 3.1 OCå†™æ³•
    NSString *filePath = [[NSBundle mainBundle] pathForResource:@"flags.plist" ofType:nil];

    NSArray *dictArr = [NSArray arrayWithContentsOfFile:filePath];

    NSMutableArray *items = [NSMutableArray array];

    for (NSDictionary *dict in dictArr) {
        FlagItem *item = [FlagItem flagWithDict:dict];
        [items addObject:item];
    }

    // 3.2 RACå†™æ³•
    NSString *filePath = [[NSBundle mainBundle] pathForResource:@"flags.plist" ofType:nil];

    NSArray *dictArr = [NSArray arrayWithContentsOfFile:filePath];

    NSMutableArray *flags = [NSMutableArray array];

    _flags = flags;

    // rac_sequenceæ³¨æ„ç‚¹ï¼šè°ƒç”¨subscribeNextï¼Œå¹¶ä¸ä¼šé©¬ä¸Šæ‰§è¡ŒnextBlockï¼Œè€Œæ˜¯ä¼šç­‰ä¸€ä¼šã€‚
    [dictArr.rac_sequence.signal subscribeNext:^(id x) {
        // è¿ç”¨RACéå†å­—å…¸ï¼Œxï¼šå­—å…¸

        FlagItem *item = [FlagItem flagWithDict:x];

        [flags addObject:item];

    }];

    NSLog(@"%@",  NSStringFromCGRect([UIScreen mainScreen].bounds));


    // 3.3 RACé«˜çº§å†™æ³•:
    NSString *filePath = [[NSBundle mainBundle] pathForResource:@"flags.plist" ofType:nil];

    NSArray *dictArr = [NSArray arrayWithContentsOfFile:filePath];
    // map:æ˜ å°„çš„æ„æ€ï¼Œç›®çš„ï¼šæŠŠåŸå§‹å€¼valueæ˜ å°„æˆä¸€ä¸ªæ–°å€¼
    // array: æŠŠé›†åˆè½¬æ¢æˆæ•°ç»„
    // åº•å±‚å®ç°ï¼šå½“ä¿¡å·è¢«è®¢é˜…ï¼Œä¼šéå†é›†åˆä¸­çš„åŸå§‹å€¼ï¼Œæ˜ å°„æˆæ–°å€¼ï¼Œå¹¶ä¸”ä¿å­˜åˆ°æ–°çš„æ•°ç»„é‡Œã€‚
    NSArray *flags = [[dictArr.rac_sequence map:^id(id value) {

        return [FlagItem flagWithDict:value];

    }] array];
</code></pre>

<ul>
<li><code>RACMulticastConnection</code>:ç”¨äºå½“ä¸€ä¸ªä¿¡å·ï¼Œè¢«å¤šæ¬¡è®¢é˜…æ—¶ï¼Œä¸ºäº†ä¿è¯åˆ›å»ºä¿¡å·æ—¶ï¼Œé¿å…å¤šæ¬¡è°ƒç”¨åˆ›å»ºä¿¡å·ä¸­çš„blockï¼Œé€ æˆå‰¯ä½œç”¨ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªç±»å¤„ç†ã€‚</li>
<li><code>ä½¿ç”¨æ³¨æ„</code>:RACMulticastConnectioné€šè¿‡RACSignalçš„-publishæˆ–è€…-muticast:æ–¹æ³•åˆ›å»º.</li>
<li><code>RACMulticastConnection</code>ç®€å•ä½¿ç”¨:</li>
</ul>
<pre><code>
// RACMulticastConnectionä½¿ç”¨æ­¥éª¤:
    // 1.åˆ›å»ºä¿¡å· + (RACSignal *)createSignal:(RACDisposable * (^)(id<racsubscriber> subscriber))didSubscribe
    // 2.åˆ›å»ºè¿æ¥ RACMulticastConnection *connect = [signal publish];
    // 3.è®¢é˜…ä¿¡å·,æ³¨æ„ï¼šè®¢é˜…çš„ä¸åœ¨æ˜¯ä¹‹å‰çš„ä¿¡å·ï¼Œè€Œæ˜¯è¿æ¥çš„ä¿¡å·ã€‚ [connect.signal subscribeNext:nextBlock]
    // 4.è¿æ¥ [connect connect]

    // RACMulticastConnectionåº•å±‚åŸç†:
    // 1.åˆ›å»ºconnectï¼Œconnect.sourceSignal -> RACSignal(åŸå§‹ä¿¡å·)  connect.signal -> RACSubject
    // 2.è®¢é˜…connect.signalï¼Œä¼šè°ƒç”¨RACSubjectçš„subscribeNextï¼Œåˆ›å»ºè®¢é˜…è€…ï¼Œè€Œä¸”æŠŠè®¢é˜…è€…ä¿å­˜èµ·æ¥ï¼Œä¸ä¼šæ‰§è¡Œblockã€‚
    // 3.[connect connect]å†…éƒ¨ä¼šè®¢é˜…RACSignal(åŸå§‹ä¿¡å·)ï¼Œå¹¶ä¸”è®¢é˜…è€…æ˜¯RACSubject
    // 3.1.è®¢é˜…åŸå§‹ä¿¡å·ï¼Œå°±ä¼šè°ƒç”¨åŸå§‹ä¿¡å·ä¸­çš„didSubscribe
    // 3.2 didSubscribeï¼Œæ‹¿åˆ°è®¢é˜…è€…è°ƒç”¨sendNextï¼Œå…¶å®æ˜¯è°ƒç”¨RACSubjectçš„sendNext
    // 4.RACSubjectçš„sendNext,ä¼šéå†RACSubjectæ‰€æœ‰è®¢é˜…è€…å‘é€ä¿¡å·ã€‚
    // 4.1 å› ä¸ºåˆšåˆšç¬¬äºŒæ­¥ï¼Œéƒ½æ˜¯åœ¨è®¢é˜…RACSubjectï¼Œå› æ­¤ä¼šæ‹¿åˆ°ç¬¬äºŒæ­¥æ‰€æœ‰çš„è®¢é˜…è€…ï¼Œè°ƒç”¨ä»–ä»¬çš„nextBlock


    // éœ€æ±‚ï¼šå‡è®¾åœ¨ä¸€ä¸ªä¿¡å·ä¸­å‘é€è¯·æ±‚ï¼Œæ¯æ¬¡è®¢é˜…ä¸€æ¬¡éƒ½ä¼šå‘é€è¯·æ±‚ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´å¤šæ¬¡è¯·æ±‚ã€‚
    // è§£å†³ï¼šä½¿ç”¨RACMulticastConnectionå°±èƒ½è§£å†³.

    // 1.åˆ›å»ºè¯·æ±‚ä¿¡å·
   RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {


        NSLog(@"å‘é€è¯·æ±‚");

        return nil;
    }];
    // 2.è®¢é˜…ä¿¡å·
    [signal subscribeNext:^(id x) {

        NSLog(@"æ¥æ”¶æ•°æ®");

    }];
    // 2.è®¢é˜…ä¿¡å·
    [signal subscribeNext:^(id x) {

        NSLog(@"æ¥æ”¶æ•°æ®");

    }];

    // 3.è¿è¡Œç»“æœï¼Œä¼šæ‰§è¡Œä¸¤éå‘é€è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡è®¢é˜…éƒ½ä¼šå‘é€ä¸€æ¬¡è¯·æ±‚


    // RACMulticastConnection:è§£å†³é‡å¤è¯·æ±‚é—®é¢˜
    // 1.åˆ›å»ºä¿¡å·
    RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {


        NSLog(@"å‘é€è¯·æ±‚");
        [subscriber sendNext:@1];

        return nil;
    }];

    // 2.åˆ›å»ºè¿æ¥
    RACMulticastConnection *connect = [signal publish];

    // 3.è®¢é˜…ä¿¡å·ï¼Œ
    // æ³¨æ„ï¼šè®¢é˜…ä¿¡å·ï¼Œä¹Ÿä¸èƒ½æ¿€æ´»ä¿¡å·ï¼Œåªæ˜¯ä¿å­˜è®¢é˜…è€…åˆ°æ•°ç»„ï¼Œå¿…é¡»é€šè¿‡è¿æ¥,å½“è°ƒç”¨è¿æ¥ï¼Œå°±ä¼šä¸€æ¬¡æ€§è°ƒç”¨æ‰€æœ‰è®¢é˜…è€…çš„sendNext:
    [connect.signal subscribeNext:^(id x) {

        NSLog(@"è®¢é˜…è€…ä¸€ä¿¡å·");

    }];

    [connect.signal subscribeNext:^(id x) {

        NSLog(@"è®¢é˜…è€…äºŒä¿¡å·");

    }];

    // 4.è¿æ¥,æ¿€æ´»ä¿¡å·
    [connect connect];
</racsubscriber></racsubscriber></racsubscriber></code></pre>

<ul>
<li><code>RACCommand</code>:RACä¸­ç”¨äºå¤„ç†äº‹ä»¶çš„ç±»ï¼Œå¯ä»¥æŠŠäº‹ä»¶å¦‚ä½•å¤„ç†,äº‹ä»¶ä¸­çš„æ•°æ®å¦‚ä½•ä¼ é€’ï¼ŒåŒ…è£…åˆ°è¿™ä¸ªç±»ä¸­ï¼Œä»–å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç›‘æ§äº‹ä»¶çš„æ‰§è¡Œè¿‡ç¨‹ã€‚</li>
<li><code>ä½¿ç”¨åœºæ™¯</code>:ç›‘å¬æŒ‰é’®ç‚¹å‡»ï¼Œç½‘ç»œè¯·æ±‚</li>
<li><code>RACCommand</code>ç®€å•ä½¿ç”¨</li>
</ul>
<pre><code>
// ä¸€ã€RACCommandä½¿ç”¨æ­¥éª¤:
    // 1.åˆ›å»ºå‘½ä»¤ initWithSignalBlock:(RACSignal * (^)(id input))signalBlock
    // 2.åœ¨signalBlockä¸­ï¼Œåˆ›å»ºRACSignalï¼Œå¹¶ä¸”ä½œä¸ºsignalBlockçš„è¿”å›å€¼
    // 3.æ‰§è¡Œå‘½ä»¤ - (RACSignal *)execute:(id)input

    // äºŒã€RACCommandä½¿ç”¨æ³¨æ„:
    // 1.signalBlockå¿…é¡»è¦è¿”å›ä¸€ä¸ªä¿¡å·ï¼Œä¸èƒ½ä¼ nil.
    // 2.å¦‚æœä¸æƒ³è¦ä¼ é€’ä¿¡å·ï¼Œç›´æ¥åˆ›å»ºç©ºçš„ä¿¡å·[RACSignal empty];
    // 3.RACCommandä¸­ä¿¡å·å¦‚æœæ•°æ®ä¼ é€’å®Œï¼Œå¿…é¡»è°ƒç”¨[subscriber sendCompleted]ï¼Œè¿™æ—¶å‘½ä»¤æ‰ä¼šæ‰§è¡Œå®Œæ¯•ï¼Œå¦åˆ™æ°¸è¿œå¤„äºæ‰§è¡Œä¸­ã€‚

    // ä¸‰ã€RACCommandè®¾è®¡æ€æƒ³ï¼šå†…éƒ¨signalBlockä¸ºä»€ä¹ˆè¦è¿”å›ä¸€ä¸ªä¿¡å·ï¼Œè¿™ä¸ªä¿¡å·æœ‰ä»€ä¹ˆç”¨ã€‚
    // 1.åœ¨RACå¼€å‘ä¸­ï¼Œé€šå¸¸ä¼šæŠŠç½‘ç»œè¯·æ±‚å°è£…åˆ°RACCommandï¼Œç›´æ¥æ‰§è¡ŒæŸä¸ªRACCommandå°±èƒ½å‘é€è¯·æ±‚ã€‚
    // 2.å½“RACCommandå†…éƒ¨è¯·æ±‚åˆ°æ•°æ®çš„æ—¶å€™ï¼Œéœ€è¦æŠŠè¯·æ±‚çš„æ•°æ®ä¼ é€’ç»™å¤–ç•Œï¼Œè¿™æ—¶å€™å°±éœ€è¦é€šè¿‡signalBlockè¿”å›çš„ä¿¡å·ä¼ é€’äº†ã€‚

    // å››ã€å¦‚ä½•æ‹¿åˆ°RACCommandä¸­è¿”å›ä¿¡å·å‘å‡ºçš„æ•°æ®ã€‚
    // 1.RACCommandæœ‰ä¸ªæ‰§è¡Œä¿¡å·æºexecutionSignalsï¼Œè¿™ä¸ªæ˜¯signal of signals(ä¿¡å·çš„ä¿¡å·),æ„æ€æ˜¯ä¿¡å·å‘å‡ºçš„æ•°æ®æ˜¯ä¿¡å·ï¼Œä¸æ˜¯æ™®é€šçš„ç±»å‹ã€‚
    // 2.è®¢é˜…executionSignalså°±èƒ½æ‹¿åˆ°RACCommandä¸­è¿”å›çš„ä¿¡å·ï¼Œç„¶åè®¢é˜…signalBlockè¿”å›çš„ä¿¡å·ï¼Œå°±èƒ½è·å–å‘å‡ºçš„å€¼ã€‚

    // äº”ã€ç›‘å¬å½“å‰å‘½ä»¤æ˜¯å¦æ­£åœ¨æ‰§è¡Œexecuting

    // å…­ã€ä½¿ç”¨åœºæ™¯,ç›‘å¬æŒ‰é’®ç‚¹å‡»ï¼Œç½‘ç»œè¯·æ±‚


    // 1.åˆ›å»ºå‘½ä»¤
    RACCommand *command = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(id input) {


        NSLog(@"æ‰§è¡Œå‘½ä»¤");

        // åˆ›å»ºç©ºä¿¡å·,å¿…é¡»è¿”å›ä¿¡å·
        //        return [RACSignal empty];

        // 2.åˆ›å»ºä¿¡å·,ç”¨æ¥ä¼ é€’æ•°æ®
        return [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {

            [subscriber sendNext:@"è¯·æ±‚æ•°æ®"];

            // æ³¨æ„ï¼šæ•°æ®ä¼ é€’å®Œï¼Œæœ€å¥½è°ƒç”¨sendCompletedï¼Œè¿™æ—¶å‘½ä»¤æ‰æ‰§è¡Œå®Œæ¯•ã€‚
            [subscriber sendCompleted];

            return nil;
        }];

    }];

    // å¼ºå¼•ç”¨å‘½ä»¤ï¼Œä¸è¦è¢«é”€æ¯ï¼Œå¦åˆ™æ¥æ”¶ä¸åˆ°æ•°æ®
    _conmmand = command;


    // 3.æ‰§è¡Œå‘½ä»¤
    [self.conmmand execute:@1];

    // 4.è®¢é˜…RACCommandä¸­çš„ä¿¡å·
    [command.executionSignals subscribeNext:^(id x) {

        [x subscribeNext:^(id x) {

            NSLog(@"%@",x);
        }];

    }];

    // RACé«˜çº§ç”¨æ³•
    // switchToLatest:ç”¨äºsignal of signalsï¼Œè·å–signal of signalså‘å‡ºçš„æœ€æ–°ä¿¡å·,ä¹Ÿå°±æ˜¯å¯ä»¥ç›´æ¥æ‹¿åˆ°RACCommandä¸­çš„ä¿¡å·
    [command.executionSignals.switchToLatest subscribeNext:^(id x) {

        NSLog(@"%@",x);
    }];

    // 5.ç›‘å¬å‘½ä»¤æ˜¯å¦æ‰§è¡Œå®Œæ¯•,é»˜è®¤ä¼šæ¥ä¸€æ¬¡ï¼Œå¯ä»¥ç›´æ¥è·³è¿‡ï¼Œskipè¡¨ç¤ºè·³è¿‡ç¬¬ä¸€æ¬¡ä¿¡å·ã€‚
    [[command.executing skip:1] subscribeNext:^(id x) {

        if ([x boolValue] == YES) {
            // æ­£åœ¨æ‰§è¡Œ
            NSLog(@"æ­£åœ¨æ‰§è¡Œ");

        }else{
            // æ‰§è¡Œå®Œæˆ
            NSLog(@"æ‰§è¡Œå®Œæˆ");
        }

    }];
</racsubscriber></code></pre>

<ul>
<li><code>RACScheduler</code>:RACä¸­çš„é˜Ÿåˆ—ï¼Œç”¨GCDå°è£…çš„ã€‚</li>
<li><code>RACUnit</code>:è¡¨â½°streamä¸åŒ…å«æœ‰æ„ä¹‰çš„å€¼,ä¹Ÿå°±æ˜¯çœ‹åˆ°è¿™ä¸ªï¼Œå¯ä»¥ç›´æ¥ç†è§£ä¸ºnil.</li>
<li><code>RACEvent</code>: æŠŠæ•°æ®åŒ…è£…æˆä¿¡å·äº‹ä»¶(signal event)ã€‚å®ƒä¸»è¦é€šè¿‡RACSignalçš„-materializeæ¥ä½¿ç”¨ï¼Œç„¶å¹¶åµã€‚</li>
</ul>
<h3 id="3-ReactiveCocoaå¼€å‘ä¸­å¸¸è§ç”¨æ³•ã€‚"><a href="#3-ReactiveCocoaå¼€å‘ä¸­å¸¸è§ç”¨æ³•ã€‚" class="headerlink" title="3.ReactiveCocoaå¼€å‘ä¸­å¸¸è§ç”¨æ³•ã€‚"></a>3.ReactiveCocoaå¼€å‘ä¸­å¸¸è§ç”¨æ³•ã€‚</h3><p>3.1 ä»£æ›¿ä»£ç†ï¼š</p>
<ul>
<li><code>rac_signalForSelector</code>ï¼šç”¨äºæ›¿ä»£ä»£ç†ã€‚</li>
</ul>
<p>3.2 ä»£æ›¿KVO :</p>
<ul>
<li><code>rac_valuesAndChangesForKeyPath</code>ï¼šç”¨äºç›‘å¬æŸä¸ªå¯¹è±¡çš„å±æ€§æ”¹å˜ã€‚</li>
</ul>
<p>3.3 ç›‘å¬äº‹ä»¶:</p>
<ul>
<li><code>rac_signalForControlEvents</code>ï¼šç”¨äºç›‘å¬æŸä¸ªäº‹ä»¶ã€‚</li>
</ul>
<p>3.4 ä»£æ›¿é€šçŸ¥:</p>
<ul>
<li><code>rac_addObserverForName</code>:ç”¨äºç›‘å¬æŸä¸ªé€šçŸ¥ã€‚</li>
</ul>
<p>3.5 ç›‘å¬æ–‡æœ¬æ¡†æ–‡å­—æ”¹å˜:</p>
<ul>
<li><code>rac_textSignal</code>:åªè¦æ–‡æœ¬æ¡†å‘å‡ºæ”¹å˜å°±ä¼šå‘å‡ºè¿™ä¸ªä¿¡å·ã€‚</li>
</ul>
<p>3.6 å¤„ç†å½“ç•Œé¢æœ‰å¤šæ¬¡è¯·æ±‚æ—¶ï¼Œéœ€è¦éƒ½è·å–åˆ°æ•°æ®æ—¶ï¼Œæ‰èƒ½å±•ç¤ºç•Œé¢</p>
<ul>
<li><code>rac_liftSelector:withSignalsFromArray:Signals</code>:å½“ä¼ å…¥çš„Signals(ä¿¡å·æ•°ç»„)ï¼Œæ¯ä¸€ä¸ªsignaléƒ½è‡³å°‘sendNextè¿‡ä¸€æ¬¡ï¼Œå°±ä¼šå»è§¦å‘ç¬¬ä¸€ä¸ªselectorå‚æ•°çš„æ–¹æ³•ã€‚</li>
<li>ä½¿ç”¨æ³¨æ„ï¼šå‡ ä¸ªä¿¡å·ï¼Œå‚æ•°ä¸€çš„æ–¹æ³•å°±å‡ ä¸ªå‚æ•°ï¼Œæ¯ä¸ªå‚æ•°å¯¹åº”ä¿¡å·å‘å‡ºçš„æ•°æ®ã€‚</li>
</ul>
<p>3.7 ä»£ç æ¼”ç¤º</p>
<pre><code>
// 1.ä»£æ›¿ä»£ç†
    // éœ€æ±‚ï¼šè‡ªå®šä¹‰redView,ç›‘å¬çº¢è‰²viewä¸­æŒ‰é’®ç‚¹å‡»
    // ä¹‹å‰éƒ½æ˜¯éœ€è¦é€šè¿‡ä»£ç†ç›‘å¬ï¼Œç»™çº¢è‰²Viewæ·»åŠ ä¸€ä¸ªä»£ç†å±æ€§ï¼Œç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ï¼Œé€šçŸ¥ä»£ç†åšäº‹æƒ…
    // rac_signalForSelector:æŠŠè°ƒç”¨æŸä¸ªå¯¹è±¡çš„æ–¹æ³•çš„ä¿¡æ¯è½¬æ¢æˆä¿¡å·ï¼Œå°±è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå°±ä¼šå‘é€ä¿¡å·ã€‚
    // è¿™é‡Œè¡¨ç¤ºåªè¦redVè°ƒç”¨btnClick:,å°±ä¼šå‘å‡ºä¿¡å·ï¼Œè®¢é˜…å°±å¥½äº†ã€‚
    [[redV rac_signalForSelector:@selector(btnClick:)] subscribeNext:^(id x) {
        NSLog(@"ç‚¹å‡»çº¢è‰²æŒ‰é’®");
    }];

    // 2.KVO
    // æŠŠç›‘å¬redVçš„centerå±æ€§æ”¹å˜è½¬æ¢æˆä¿¡å·ï¼Œåªè¦å€¼æ”¹å˜å°±ä¼šå‘é€ä¿¡å·
    // observer:å¯ä»¥ä¼ å…¥nil
    [[redV rac_valuesAndChangesForKeyPath:@"center" options:NSKeyValueObservingOptionNew observer:nil] subscribeNext:^(id x) {

        NSLog(@"%@",x);

    }];

    // 3.ç›‘å¬äº‹ä»¶
    // æŠŠæŒ‰é’®ç‚¹å‡»äº‹ä»¶è½¬æ¢ä¸ºä¿¡å·ï¼Œç‚¹å‡»æŒ‰é’®ï¼Œå°±ä¼šå‘é€ä¿¡å·
    [[self.btn rac_signalForControlEvents:UIControlEventTouchUpInside] subscribeNext:^(id x) {

        NSLog(@"æŒ‰é’®è¢«ç‚¹å‡»äº†");
    }];

    // 4.ä»£æ›¿é€šçŸ¥
    // æŠŠç›‘å¬åˆ°çš„é€šçŸ¥è½¬æ¢ä¿¡å·
    [[[NSNotificationCenter defaultCenter] rac_addObserverForName:UIKeyboardWillShowNotification object:nil] subscribeNext:^(id x) {
        NSLog(@"é”®ç›˜å¼¹å‡º");
    }];

    // 5.ç›‘å¬æ–‡æœ¬æ¡†çš„æ–‡å­—æ”¹å˜
   [_textField.rac_textSignal subscribeNext:^(id x) {

       NSLog(@"æ–‡å­—æ”¹å˜äº†%@",x);
   }];

   // 6.å¤„ç†å¤šä¸ªè¯·æ±‚ï¼Œéƒ½è¿”å›ç»“æœçš„æ—¶å€™ï¼Œç»Ÿä¸€åšå¤„ç†.
    RACSignal *request1 = [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {

        // å‘é€è¯·æ±‚1
        [subscriber sendNext:@"å‘é€è¯·æ±‚1"];
        return nil;
    }];

    RACSignal *request2 = [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
        // å‘é€è¯·æ±‚2
        [subscriber sendNext:@"å‘é€è¯·æ±‚2"];
        return nil;
    }];

    // ä½¿ç”¨æ³¨æ„ï¼šå‡ ä¸ªä¿¡å·ï¼Œå‚æ•°ä¸€çš„æ–¹æ³•å°±å‡ ä¸ªå‚æ•°ï¼Œæ¯ä¸ªå‚æ•°å¯¹åº”ä¿¡å·å‘å‡ºçš„æ•°æ®ã€‚
    [self rac_liftSelector:@selector(updateUIWithR1:r2:) withSignalsFromArray:@[request1,request2]];


}
// æ›´æ–°UI
- (void)updateUIWithR1:(id)data r2:(id)data1
{
    NSLog(@"æ›´æ–°UI%@  %@",data,data1);
}
</racsubscriber></racsubscriber></code></pre>


<h3 id="4-ReactiveCocoaå¸¸è§å®ã€‚"><a href="#4-ReactiveCocoaå¸¸è§å®ã€‚" class="headerlink" title="4.ReactiveCocoaå¸¸è§å®ã€‚"></a>4.ReactiveCocoaå¸¸è§å®ã€‚</h3><p>4.1 <code>RAC(TARGET, [KEYPATH, [NIL_VALUE]])</code>:ç”¨äºç»™æŸä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§ç»‘å®šã€‚     </p>
<pre><code>// åªè¦æ–‡æœ¬æ¡†æ–‡å­—æ”¹å˜ï¼Œå°±ä¼šä¿®æ”¹labelçš„æ–‡å­—
RAC(self.labelView,text) = _textField.rac_textSignal;    
</code></pre><p>4.2 <code>RACObserve(self, name)</code>:ç›‘å¬æŸä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§,è¿”å›çš„æ˜¯ä¿¡å·ã€‚</p>
<pre><code>[RACObserve(self.view, center) subscribeNext:^(id x) {

    NSLog(@&quot;%@&quot;,x);
}];
</code></pre><p>4.3 <code>@weakify(Obj)å’Œ@strongify(Obj)</code>,ä¸€èˆ¬ä¸¤ä¸ªéƒ½æ˜¯é…å¥—ä½¿ç”¨,è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜.<br>4.4 <code>RACTuplePack</code>ï¼šæŠŠæ•°æ®åŒ…è£…æˆRACTupleï¼ˆå…ƒç»„ç±»ï¼‰</p>
<pre><code>// æŠŠå‚æ•°ä¸­çš„æ•°æ®åŒ…è£…æˆå…ƒç»„
RACTuple *tuple = RACTuplePack(@10,@20);
</code></pre><p>4.5 <code>RACTupleUnpack</code>ï¼šæŠŠRACTupleï¼ˆå…ƒç»„ç±»ï¼‰è§£åŒ…æˆå¯¹åº”çš„æ•°æ®ã€‚</p>
<pre><code> // æŠŠå‚æ•°ä¸­çš„æ•°æ®åŒ…è£…æˆå…ƒç»„
RACTuple *tuple = RACTuplePack(@&quot;xmg&quot;,@20);

// è§£åŒ…å…ƒç»„ï¼Œä¼šæŠŠå…ƒç»„çš„å€¼ï¼ŒæŒ‰é¡ºåºç»™å‚æ•°é‡Œé¢çš„å˜é‡èµ‹å€¼
// name = @&quot;xmg&quot; age = @20
RACTupleUnpack(NSString *name,NSNumber *age) = tuple;
</code></pre><!-- more -->
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[å…³äºRACçš„ä¸€äº›èµ„æ–™]]></title>
      <url>http://yoursite.com/2016/04/23/%E5%85%B3%E4%BA%8ERAC%E7%9A%84%E4%B8%80%E4%BA%9B%E8%B5%84%E6%96%99/</url>
      <content type="html"><![CDATA[<p>çœ‹äº†è¿™ä¹ˆå¤šRACèµ„æ–™ï¼Œåœ¨è¿™é‡Œæˆ‘æ•´ç†äº†ä¸€ä¸‹ï¼Œä»¥å¤‡å­¦ä¹ ã€‚</p>
<a id="more"></a>
<h5 id="ä½•ä¸ºå‡½æ•°å¼ç¼–ç¨‹"><a href="#ä½•ä¸ºå‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="ä½•ä¸ºå‡½æ•°å¼ç¼–ç¨‹"></a>ä½•ä¸ºå‡½æ•°å¼ç¼–ç¨‹</h5><ul>
<li><a href="http://valiantcat.com/2016/06/03/%E4%BB%8E%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E5%88%B0%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/" target="_blank" rel="external">ä»å‡½æ•°è°ƒç”¨åˆ°å‡½æ•°å¼ç¼–ç¨‹</a></li>
</ul>
<h5 id="RPå…¥é—¨"><a href="#RPå…¥é—¨" class="headerlink" title="RPå…¥é—¨"></a>RPå…¥é—¨</h5><ul>
<li><a href="https://github.com/benjycui/introrx-chinese-edition" target="_blank" rel="external">RPå…¥é—¨</a></li>
</ul>
<h5 id="RACæ€æƒ³"><a href="#RACæ€æƒ³" class="headerlink" title="RACæ€æƒ³"></a>RACæ€æƒ³</h5><ul>
<li><p><a href="http://www.jianshu.com/p/25922584bc43" target="_blank" rel="external">iOS Reactive Cocoaä½¿ç”¨æµ…æ</a></p>
</li>
<li><p><a href="http://blog.devtang.com/2016/01/03/reactive-cocoa-discussion/index.html" target="_blank" rel="external">ReactiveCocoa è®¨è®ºä¼š</a></p>
</li>
</ul>
<h5 id="RACåŸºç¡€ç¯‡"><a href="#RACåŸºç¡€ç¯‡" class="headerlink" title="RACåŸºç¡€ç¯‡"></a>RACåŸºç¡€ç¯‡</h5><ul>
<li><p><a href="http://www.guiyongdong.com/2016/08/11/%E5%88%9D%E8%AF%86ReactiveCocoa/" target="_blank" rel="external">åˆè¯†ReactiveCocoa</a></p>
</li>
<li><p><a href="http://www.guiyongdong.com/2016/08/12/%E6%B7%B1%E5%85%A5ReactiveCocoa/" target="_blank" rel="external">æ·±å…¥ReactiveCocoa</a></p>
</li>
</ul>
<h5 id="éå¸¸ä¸é”™çš„RACå…¥é—¨æ•™ç¨‹"><a href="#éå¸¸ä¸é”™çš„RACå…¥é—¨æ•™ç¨‹" class="headerlink" title="éå¸¸ä¸é”™çš„RACå…¥é—¨æ•™ç¨‹"></a>éå¸¸ä¸é”™çš„RACå…¥é—¨æ•™ç¨‹</h5><ul>
<li><p><a href="http://benbeng.leanote.com/post/ReactiveCocoaTutorial-part1" target="_blank" rel="external">ReactiveCocoaå…¥é—¨æ•™ç¨‹â€”â€”ç¬¬ä¸€éƒ¨åˆ†å¯¹åº”çš„ä¸­æ–‡ç‰ˆ</a></p>
</li>
<li><p><a href="http://blog.sunnyxx.com/2014/03/06/rac_1_macros/" target="_blank" rel="external">Reactive Cocoa Tutorial [1] = ç¥å¥‡çš„Macros</a></p>
</li>
<li><p><a href="http://blog.sunnyxx.com/2014/03/06/rac_2_racstream/" target="_blank" rel="external">Reactive Cocoa Tutorial [2] = ç™¾å˜RACStream</a></p>
</li>
<li><p><a href="http://blog.sunnyxx.com/2014/03/06/rac_3_racsignal/" target="_blank" rel="external">Reactive Cocoa Tutorial [3] = RACSignalçš„å·§å…‹åŠ›å·¥å‚</a></p>
</li>
<li><p><a href="http://blog.sunnyxx.com/2014/04/19/rac_4_filters/" target="_blank" rel="external">Reactive Cocoa Tutorial [4] = åªå–æ‰€éœ€çš„Filters</a></p>
</li>
<li><p><a href="http://leichunfeng.github.io/blog/2015/12/25/reactivecocoa-v2-dot-5-yuan-ma-jie-xi-zhi-jia-gou-zong-lan" target="_blank" rel="external">ReactiveCocoa v2.5 æºç è§£æä¹‹æ¶æ„æ€»è§ˆ</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/d262f2c55fbe" target="_blank" rel="external">RACæ ¸å¿ƒå…ƒç´ ä¸ä¿¡å·æµ</a></p>
</li>
</ul>
<h5 id="æ¥è‡ªç¾å›¢çš„å¯¹å†·çƒ­ä¿¡å·çš„åˆ†æ"><a href="#æ¥è‡ªç¾å›¢çš„å¯¹å†·çƒ­ä¿¡å·çš„åˆ†æ" class="headerlink" title="æ¥è‡ªç¾å›¢çš„å¯¹å†·çƒ­ä¿¡å·çš„åˆ†æ"></a>æ¥è‡ªç¾å›¢çš„å¯¹å†·çƒ­ä¿¡å·çš„åˆ†æ</h5><ul>
<li><p><a href="http://tech.meituan.com/RACSignalSubscription.html" target="_blank" rel="external">RACSignalçš„Subscriptionæ·±å…¥åˆ†æ - ç¾å›¢ç‚¹è¯„æŠ€æœ¯å›¢é˜Ÿ</a></p>
</li>
<li><p><a href="http://tech.meituan.com/talk-about-reactivecocoas-cold-signal-and-hot-signal-part-1.html" target="_blank" rel="external">ç»†è¯´ReactiveCocoaçš„å†·ä¿¡å·ä¸çƒ­ä¿¡å·ï¼ˆä¸€ï¼‰</a></p>
</li>
<li><p><a href="http://tech.meituan.com/talk-about-reactivecocoas-cold-signal-and-hot-signal-part-2.html" target="_blank" rel="external">ç»†è¯´ReactiveCocoaçš„å†·ä¿¡å·ä¸çƒ­ä¿¡å·ï¼ˆäºŒï¼‰ï¼šä¸ºä»€ä¹ˆè¦åŒºåˆ†å†·çƒ­ä¿¡å·</a></p>
</li>
<li><p><a href="http://tech.meituan.com/talk-about-reactivecocoas-cold-signal-and-hot-signal-part-3.html" target="_blank" rel="external">ç»†è¯´ReactiveCocoaçš„å†·ä¿¡å·ä¸çƒ­ä¿¡å·ï¼ˆä¸‰ï¼‰ï¼šæ€ä¹ˆå¤„ç†å†·ä¿¡å·ä¸çƒ­ä¿¡å·</a></p>
</li>
<li><p><a href="http://tech.meituan.com/potential-memory-leak-in-reactivecocoa.html" target="_blank" rel="external">ReactiveCocoaä¸­æ½œåœ¨çš„å†…å­˜æ³„æ¼åŠè§£å†³æ–¹æ¡ˆ</a></p>
</li>
<li><p><a href="http://tech.meituan.com/RACSignalSubscription.html" target="_blank" rel="external">RACSignalçš„Subscriptionæ·±å…¥åˆ†æ</a></p>
</li>
</ul>
<h5 id="RACæºç è§£æ"><a href="#RACæºç è§£æ" class="headerlink" title="RACæºç è§£æ"></a>RACæºç è§£æ</h5><ul>
<li><p><a href="http://www.jianshu.com/p/d262f2c55fbe" target="_blank" rel="external">RACæ ¸å¿ƒå…ƒç´ ä¸ä¿¡å·æµ</a></p>
</li>
<li><p><a href="http://ios.jobbole.com/85019/" target="_blank" rel="external">å‰–æ@weakify å’Œ @strongify</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/baeebca1f6f4" target="_blank" rel="external">ReactiveCocoaæºç é˜…è¯»ä¹‹å‰åº</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/d5e4dc7e592e" target="_blank" rel="external">ReactiveCocoaæºç é˜…è¯»ä¹‹RACSignal(ä¸€)</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/bcdea71ba824" target="_blank" rel="external">ReactiveCocoaæºç é˜…è¯»ä¹‹RACSignal(äºŒ)</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/7c1ddba2b3a4" target="_blank" rel="external">ReactiveCocoaæºç é˜…è¯»ä¹‹bindå‡½æ•°</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/f939bf6afc93" target="_blank" rel="external">ReactiveCocoaæºç é˜…è¯»ä¹‹æ”»ç•¥flatten</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/f3b00e90035d" target="_blank" rel="external">ReactiveCocoaæºç é˜…è¯»ä¹‹switchToLatest/combineLatestWith</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/a151e5cb0aae" target="_blank" rel="external">ReactiveCocoaæºç é˜…è¯»ä¹‹RACScheduler</a></p>
</li>
</ul>
<h5 id="MVVM-With-ReactiveCocoa"><a href="#MVVM-With-ReactiveCocoa" class="headerlink" title="MVVM With ReactiveCocoa"></a>MVVM With ReactiveCocoa</h5><ul>
<li><p><a href="http://www.jianshu.com/p/b2fe0920e3aa" target="_blank" rel="external">MVVMä¸ReactiveCocoaçš„è¿ç”¨(Part1)</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/b51344f4f3a3" target="_blank" rel="external">MVVMä¸ReactiveCocoaçš„è¿ç”¨(Part2)</a></p>
</li>
<li><p><a href="https://www.raywenderlich.com/74106/mvvm-tutorial-with-reactivecocoa-part-1" target="_blank" rel="external">MVVM Tutorial with ReactiveCocoa: Part 1/2</a></p>
</li>
<li><p><a href="https://www.raywenderlich.com/74131/mvvm-tutorial-with-reactivecocoa-part-2" target="_blank" rel="external">MVVM Tutorial with ReactiveCocoa: Part 2/2</a></p>
</li>
<li><p><a href="http://leichunfeng.github.io/blog/2016/02/27/mvvm-with-reactivecocoa" target="_blank" rel="external">MVVM With ReactiveCocoa</a></p>
</li>
</ul>
<h5 id="RACå…¶å®ƒ"><a href="#RACå…¶å®ƒ" class="headerlink" title="RACå…¶å®ƒ"></a>RACå…¶å®ƒ</h5><ul>
<li><p><a href="http://www.jianshu.com/p/fccba7be1ca1" target="_blank" rel="external">ReactiveCocoa 4 æ–‡æ¡£ç¿»è¯‘ç›®å½•</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/0ea216239efb" target="_blank" rel="external">ReactiveCocoa 4 å›¾è§£ä¹‹ä¸€â€”â€”äº‹ä»¶ï¼ˆEventï¼‰</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/ba5247d713a9" target="_blank" rel="external">ReactiveCocoa 4 å›¾è§£ä¹‹äºŒâ€”â€”ç›‘å¬å™¨ï¼ˆObserverï¼‰</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/7a4a1d005aee" target="_blank" rel="external">ReactiveCocoa 4 å›¾è§£ä¹‹ä¸‰â€”â€”å­˜æ ¹ï¼ˆDisposable)</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/f0c945e5b2fe" target="_blank" rel="external">ReactiveCocoa 4 å›¾è§£ä¹‹äº”â€”â€”ä¿¡å·ï¼ˆSignal)</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/617063a81136" target="_blank" rel="external">ReactiveCocoa 4 å›¾è§£ä¹‹å…­â€”â€”ä¿¡å·å‘ç”Ÿå™¨ï¼ˆSignalProducerï¼‰</a></p>
</li>
</ul>
<!-- more -->
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[èŠä¸€èŠGCDçš„é‚£äº›äº‹]]></title>
      <url>http://yoursite.com/2016/04/15/%E8%81%8A%E4%B8%80%E8%81%8AGCD%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/</url>
      <content type="html"><![CDATA[<p>GCDæ˜¯iOSå¼€å‘ä¸­ç»å¸¸ä½¿ç”¨åˆ°çš„æŠ€æœ¯ï¼Œæœ€è¿‘å·¥ä½œæ¯”è¾ƒæ‚ é—²ï¼Œæœ‰æ—¶é—´å¯¹GCDåšä¸€ä¸ªå…¨é¢çš„å­¦ä¹ ï¼Œè¿™ç¯‡æ–‡ç« å°†å¯¹GCDåšä¸€ä¸ªå…¨é¢çš„è§£æã€‚</p>
<a id="more"></a>
<p><strong>ç›®å½•</strong></p>
<blockquote>
<ol>
<li>æ–‡å­—æè¿°</li>
<li>Dispatch Queue</li>
<li>dispatch_sync&amp;dispatch_async</li>
<li>åˆ›å»ºçš„çº¿ç¨‹ä»»åŠ¡æœ‰å››ç§æ‰§è¡Œæ–¹å¼</li>
<li>Dispatch Group</li>
<li>Dispatch Block</li>
<li>dispatch_after</li>
<li>dispatch_apply</li>
<li>dispatch_once</li>
<li>dispatch_barrier_async</li>
<li>dispatch_set_target_queue</li>
<li>dispatch_semaphore_t(ä¿¡å·é‡)</li>
<li>GCDå®šæ—¶å™¨</li>
</ol>
</blockquote>
<h3 id="1-æ–‡å­—æè¿°"><a href="#1-æ–‡å­—æè¿°" class="headerlink" title="1. æ–‡å­—æè¿°"></a>1. æ–‡å­—æè¿°</h3><blockquote>
<p>GCDè‹±æ–‡å…¨ç§°ï¼šGrand Central Dispatch ç¿»è¯‘å°±æ˜¯ å®å¤§çš„ä¸­å¤®è°ƒåº¦ï¼Œæ˜¯è‹¹æœå¼€å‘çš„ä¸€ç§æ”¯æŒå¹¶è¡Œæ“ä½œçš„æœºåˆ¶,åŸºäºCè¯­è¨€ï¼Œæä¾›äº†éå¸¸å¤šå¼ºå¤§çš„å‡½æ•°</p>
</blockquote>
<p>åœ¨äº†è§£GCDå¹¶ä½¿ç”¨ä¹‹å‰ï¼Œå¿…é¡»è¦æŒæ¡å››ä¸ªåè¯ï¼š<strong>ä¸²è¡Œ</strong>ï¼Œ<strong>å¹¶å‘</strong>ï¼Œ<strong>åŒæ­¥</strong>ï¼Œ<strong>å¼‚æ­¥</strong></p>
<p><strong>ä¸²è¡Œ(Serial)ï¼š</strong><br>ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œ, å†æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡</p>
<p><strong>å¹¶å‘ (Concurrent)ï¼š</strong><br>å¤šä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œ(è‡ªåŠ¨å¼€å¯å¤šä¸ªçº¿ç¨‹),åªæœ‰åœ¨å¼‚æ­¥å‡½æ•°ä¸‹æ‰æœ‰æ•ˆ</p>
<p><strong>åŒæ­¥(Synchronous)ï¼š</strong><br>åœ¨å½“å‰çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼Œä¸å…·å¤‡å¼€å¯æ–°çº¿ç¨‹çš„èƒ½åŠ›<br>æäº¤çš„ä»»åŠ¡åœ¨æ‰§è¡Œå®Œæˆåæ‰ä¼šè¿”å›<br>åŒæ­¥å‡½æ•°: dispatch_sync()</p>
<p><strong>å¼‚æ­¥ (Asynchronous)ï¼š</strong><br>åœ¨æ–°çš„çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡, å…·å¤‡å¼€å¯çº¿ç¨‹çš„èƒ½åŠ›<br>åœ¨æ–°çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼Œå…·å¤‡å¼€å¯æ–°çº¿ç¨‹çš„èƒ½åŠ›<br>æäº¤çš„ä»»åŠ¡ç«‹åˆ»è¿”å›ï¼Œåœ¨åå°é˜Ÿåˆ—ä¸­æ‰§è¡Œ<br>å¼‚æ­¥å‡½æ•°: dispatch_async()</p>
<hr>
<h3 id="2-Dispatch-Queue"><a href="#2-Dispatch-Queue" class="headerlink" title="2.Dispatch Queue"></a>2.Dispatch Queue</h3><p>Dispatch Queueæ˜¯æ‰§è¡Œå¤„ç†çš„ç­‰å¾…é˜Ÿåˆ—, æŒ‰ç…§å…ˆè¿›å…ˆå‡º(FIFO, First-In-First-Out)çš„é¡ºåºè¿›è¡Œä»»åŠ¡å¤„ç†.<br>å¼€å‘è€…å°†éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡æ·»åŠ åˆ°åˆé€‚çš„Dispatch Queueä¸­å³å¯ï¼ŒDispatch Queueä¼šæ ¹æ®ä»»åŠ¡æ·»åŠ çš„é¡ºåºå…ˆåˆ°å…ˆæ‰§è¡Œï¼Œå…¶ä¸­æœ‰ä»¥ä¸‹å‡ ç§é˜Ÿåˆ—ï¼š</p>
<p>å¦å¤–, é˜Ÿåˆ—åˆ†ä¸¤ç§, ä¸€ç§æ˜¯<strong>ä¸²è¡Œé˜Ÿåˆ—(Serial Dispatch Queue)</strong>, ä¸€ç§æ˜¯<strong>å¹¶è¡Œé˜Ÿåˆ—(Concurrent Dispatch Queue)</strong>.</p>
<table>
<thead>
<tr>
<th>Dispatch Queueçš„ç§ç±»</th>
<th style="text-align:center">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>Serial Dispatch Queue</td>
<td style="text-align:center">ç­‰å¾…ç°åœ¨æ‰§è¡Œä¸­å¤„ç†ç»“æŸ</td>
</tr>
<tr>
<td>Concurrent Dispatch Queue</td>
<td style="text-align:center">ä¸ç­‰å¾…ç°åœ¨æ‰§è¡Œä¸­å¤„ç†ç»“æŸ</td>
</tr>
</tbody>
</table>
<pre><code>
//åˆ›å»ºä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—
dispatch_queue_t serialQueue=dispatch_queue_create("com.serial.queue", DISPATCH_QUEUE_SERIAL);

//åˆ›å»ºä¸€ä¸ªå¹¶å‘é˜Ÿåˆ—
dispatch_queue_t concurrentQueue=dispatch_queue_create("com.concurrent.queue", DISPATCH_QUEUE_CONCURRENT);

//ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºé˜Ÿåˆ—åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºé˜Ÿåˆ—ç±»å‹ï¼Œå½“ç„¶ï¼Œç¬¬äºŒä¸ªå‚æ•°äººå¦‚æœå†™NULLï¼Œåˆ›å»ºå‡ºæ¥çš„ä¹Ÿæ˜¯ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—ã€‚ç„¶åæˆ‘ä»¬åœ¨å¼‚æ­¥çº¿ç¨‹æ¥æ‰§è¡Œè¿™ä¸ªé˜Ÿåˆ—ï¼š
</code></pre>

<p>å¦å¤–ç³»ç»Ÿä¸ºæˆ‘ä»¬å‡†å¤‡äº†ä¸¤ä¸ªé˜Ÿåˆ—</p>
<ul>
<li><p><strong>main dispatch queue</strong><br>åŠŸèƒ½è·Ÿä¸»çº¿ç¨‹ä¸€æ ·ï¼Œé€šè¿‡dispatch_get_main_queue()æ¥è·å–ï¼Œæäº¤åˆ°main queueçš„ä»»åŠ¡å®é™…ä¸Šéƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—<br><code>dispatch_queue_t queue = dispatch_get_main_queue();</code></p>
</li>
<li><p><strong>global dispatch queues</strong><br>ç³»ç»Ÿç»™æ¯ä¸ªåº”ç”¨æä¾›å››ä¸ªå…¨å±€çš„å¹¶å‘é˜Ÿåˆ—ï¼Œè¿™å››ä¸ªé˜Ÿåˆ—åˆ†åˆ«æœ‰ä¸åŒçš„ä¼˜å…ˆçº§ï¼šé«˜ã€é»˜è®¤ã€ä½ä»¥åŠåå°ï¼Œç”¨æˆ·ä¸èƒ½å»åˆ›å»ºå…¨å±€é˜Ÿåˆ—ï¼Œåªèƒ½æ ¹æ®ä¼˜å…ˆçº§å»è·å–:</p>
<pre><code>dispatch_queue_t queue  = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);</code></pre>    



</li>
</ul>
<hr>
<h3 id="3-dispatch-sync-amp-dispatch-async"><a href="#3-dispatch-sync-amp-dispatch-async" class="headerlink" title="3.dispatch_sync&amp;dispatch_async"></a>3.dispatch_sync&amp;dispatch_async</h3><p>æ‰§è¡Œé˜Ÿåˆ—ä¸­ä»»åŠ¡çš„ä¸¤ç§æ–¹å¼ï¼Œdispatch_syncæ˜¯åŒæ­¥ä»»åŠ¡ï¼Œdispatch_asyncæ˜¯å¼‚æ­¥ä»»åŠ¡</p>
<p>1.<strong>ç”¨åŒæ­¥çš„æ–¹å¼æ‰§è¡Œä»»åŠ¡(åŒæ­¥ï¼šsynchronization)</strong>ï¼Œ åªèƒ½åœ¨å½“å‰çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼Œä¸å…·å¤‡å¼€å¯æ–°çº¿ç¨‹çš„èƒ½åŠ›</p>
<pre><code>/*
 *  ç¬¬ä¸€ä¸ªå‚æ•°ï¼šè¯¥ä»»åŠ¡æ‰€åœ¨çš„é˜Ÿåˆ—
 *  ç¬¬äºŒä¸ªå‚æ•°ï¼šè¯¥ä»»åŠ¡è¦åšçš„äº‹æƒ…
 */
dispatch_sync(dispatch_queue_t queue, dispatch_block_t block);</code></pre>

<ul>
<li><p>å‡å¦‚æˆ‘æŒ‡å®šçš„é˜Ÿåˆ—Aæ˜¯ä¸²è¡Œé˜Ÿåˆ—ï¼Œåˆ™è¯¥é˜Ÿåˆ—ä¸­åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘æ”¾åœ¨é˜Ÿåˆ—Aä¸­çš„ä»»åŠ¡ï¼Œæ‰€ä»¥å¿…é¡»å¾—ä¸€ä¸ªä¸€ä¸ªçš„æ‰§è¡Œã€‚ä¸ä»…å¦‚æ­¤ï¼Œåœ¨ä¸Šé¢æˆ‘ä»¬è¿˜æ‰‹åŠ¨é€‰æ‹©äº†åœ¨é˜Ÿåˆ—Aä¸­ç”¨åŒæ­¥çš„æ–¹å¼æ‰§è¡Œä»»åŠ¡ï¼Œè¿™ä¹Ÿé™åˆ¶äº†ï¼Œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡åªèƒ½ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œã€‚</p>
</li>
<li><p>å‡å¦‚æˆ‘æŒ‡å®šçš„é˜Ÿåˆ—Aæ˜¯å¹¶è¡Œé˜Ÿåˆ—ï¼Œåˆ™è¯¥é˜Ÿåˆ—ä¸­å¯ä»¥å¼€è¾Ÿå¤šä¸ªçº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼Œè™½ç„¶å¦‚æ­¤ï¼Œä½†ç”±äºæˆ‘ä»¬åœ¨ä¸Šé¢æ‰‹åŠ¨é€‰æ‹©äº†åœ¨é˜Ÿåˆ—Aä¸­ç”¨åŒæ­¥çš„æ–¹å¼æ‰§è¡Œçº¿ç¨‹ï¼Œæ‰€ä»¥é˜Ÿåˆ—Aä¸­çš„ä»»åŠ¡ä¹Ÿåªèƒ½ä¸€ä¸ªä¸€ä¸ªå»æ‰§è¡Œï¼Œ<strong>ä¸èƒ½å¼€è¾Ÿå¤šçº¿ç¨‹åŒæ—¶æ‰§è¡Œ</strong>ã€‚</p>
</li>
</ul>
<p>2.ç”¨å¼‚æ­¥çš„æ–¹å¼æ‰§è¡Œä»»åŠ¡(å¼‚æ­¥ï¼šasynchronous)ï¼Œå¯ä»¥åœ¨æ–°çš„çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼Œå…·å¤‡å¼€å¯æ–°çº¿ç¨‹çš„èƒ½åŠ›ã€‚</p>
<pre><code>dispatch_async(dispatch_queue_t queue, dispatch_block_t block);</code></pre>

<ul>
<li>å‡å¦‚æ­¤æ—¶æˆ‘æŒ‡å®šçš„é˜Ÿåˆ—Bæ˜¯å¹¶è¡Œé˜Ÿåˆ—ï¼Œåˆ™è¡¨æ˜è¯¥é˜Ÿåˆ—ä¸­å¯ä»¥å­˜åœ¨å¤šä¸ªçº¿ç¨‹ï¼Œåˆå› ä¸ºæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯å¼‚æ­¥çš„æ–¹å¼æ‰§è¡Œä»»åŠ¡ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªé˜Ÿåˆ—çš„ä»»åŠ¡å¯ä»¥å®ç°åŒæ—¶è¿è¡Œã€‚</li>
<li>å‡å¦‚æ­¤æ—¶æˆ‘æŒ‡å®šçš„é˜Ÿåˆ—Bæ˜¯ä¸²è¡Œé˜Ÿåˆ—ï¼Œåˆ™è¡¨æ˜è¯¥é˜Ÿåˆ—ä¸­ï¼Œåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥å°½ç®¡æˆ‘é‡‡ç”¨å¼‚æ­¥çš„æ–¹å¼æ‰§è¡Œä»»åŠ¡ï¼Œä½†è¯¥é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡è¿˜æ˜¯åªèƒ½ä¸€ä¸ªä¸€ä¸ªçš„è¿è¡Œã€‚</li>
</ul>
<hr>
<h3 id="4-åˆ›å»ºçš„çº¿ç¨‹ä»»åŠ¡æœ‰å››ç§æ‰§è¡Œæ–¹å¼"><a href="#4-åˆ›å»ºçš„çº¿ç¨‹ä»»åŠ¡æœ‰å››ç§æ‰§è¡Œæ–¹å¼" class="headerlink" title="4.åˆ›å»ºçš„çº¿ç¨‹ä»»åŠ¡æœ‰å››ç§æ‰§è¡Œæ–¹å¼"></a>4.åˆ›å»ºçš„çº¿ç¨‹ä»»åŠ¡æœ‰å››ç§æ‰§è¡Œæ–¹å¼</h3><p><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/GCD1.png?raw=true" alt=""></p>
<h5 id="1-ä¸²è¡Œé˜Ÿåˆ—åŒæ­¥æ‰§è¡Œä»»åŠ¡"><a href="#1-ä¸²è¡Œé˜Ÿåˆ—åŒæ­¥æ‰§è¡Œä»»åŠ¡" class="headerlink" title="1. ä¸²è¡Œé˜Ÿåˆ—åŒæ­¥æ‰§è¡Œä»»åŠ¡"></a>1. ä¸²è¡Œé˜Ÿåˆ—åŒæ­¥æ‰§è¡Œä»»åŠ¡</h5><ul>
<li>åŒæ­¥ä¸å…·æœ‰å¼€è¾Ÿæ–°çº¿ç¨‹çš„èƒ½åŠ›ï¼Œä¸ä¼šå¼€è¾Ÿæ–°çš„çº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼Œä¼šåœ¨å½“å‰ç¨‹åºçš„ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ã€‚</li>
<li>æŒ‰ç…§ä¸²è¡Œçš„æ–¹å¼å»æ‰§è¡Œä»»åŠ¡</li>
</ul>
<pre><code>-(void)syncSERIAL{
    NSLog(@"star");
    //ä¸ä¼šå¼€è¾Ÿæ–°çš„çº¿ç¨‹
    dispatch_queue_t queue=dispatch_queue_create("com.GCD_demo.www", DISPATCH_QUEUE_SERIAL);
    dispatch_sync(queue, ^{
        NSLog(@"SERIAL_work_1 ");
    });
    dispatch_sync(queue, ^{
        NSLog(@"SERIAL_work_2 ");
    });
    dispatch_sync(queue, ^{
        NSLog(@"SERIAL_work_3 ");
    });

    NSLog(@"end");

}</code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-20 20:08:09.695 GCD_Demo[8196:1029563] star
2016-07-20 20:08:09.696 GCD_Demo[8196:1029563] SERIAL_work_1 
2016-07-20 20:08:09.696 GCD_Demo[8196:1029563] SERIAL_work_2 
2016-07-20 20:08:09.696 GCD_Demo[8196:1029563] SERIAL_work_3 
2016-07-20 20:08:09.696 GCD_Demo[8196:1029563] end</code></pre>

<p><strong>ç”±äºæ˜¯åŒæ­¥æ“ä½œï¼Œä¸èƒ½å¼€è¾Ÿçº¿ç¨‹ï¼Œæ‰€ä»¥éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹å¹¶æŒ‰ç…§é¡ºåºæ‰§è¡Œ</strong></p>
<h5 id="2-ä¸²è¡Œé˜Ÿåˆ—å¼‚æ­¥æ‰§è¡Œä»»åŠ¡"><a href="#2-ä¸²è¡Œé˜Ÿåˆ—å¼‚æ­¥æ‰§è¡Œä»»åŠ¡" class="headerlink" title="2. ä¸²è¡Œé˜Ÿåˆ—å¼‚æ­¥æ‰§è¡Œä»»åŠ¡"></a>2. ä¸²è¡Œé˜Ÿåˆ—å¼‚æ­¥æ‰§è¡Œä»»åŠ¡</h5><ul>
<li>å¼‚æ­¥å…·æœ‰åˆ›å»ºæ–°çº¿ç¨‹çš„èƒ½åŠ›ï¼Œä¼šå¼€è¾Ÿæ–°çš„çº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡</li>
<li>æŒ‰ç…§ä¸²è¡Œçš„æ–¹å¼å»æ‰§è¡Œä»»åŠ¡</li>
</ul>
<pre><code>-(void)asyncSERIAL{
    NSLog(@"star");

    //ä¼šå¼€è¾Ÿæ–°çš„çº¿ç¨‹,ä½†æ˜¯æ˜¯ä¸²è¡Œæ‰§è¡Œä»»åŠ¡
    dispatch_queue_t queue=dispatch_queue_create("ki", DISPATCH_QUEUE_SERIAL);
    dispatch_async(queue, ^{
        [NSThread sleepForTimeInterval:3];
        NSLog(@"SERIAL_work_1 ");
    });
    dispatch_async(queue, ^{
        [NSThread sleepForTimeInterval:2];
        NSLog(@"SERIAL_work_2 ");
    });
    dispatch_async(queue, ^{
        NSLog(@"SERIAL_work_3 ");
    });

    NSLog(@"end");

}</code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-20 20:09:58.494 GCD_Demo[8213:1031268] star
2016-07-20 20:09:58.495 GCD_Demo[8213:1031268] end
2016-07-20 20:10:01.496 GCD_Demo[8213:1031315] SERIAL_work_1 
2016-07-20 20:10:03.502 GCD_Demo[8213:1031315] SERIAL_work_2 
2016-07-20 20:10:03.502 GCD_Demo[8213:1031315] SERIAL_work_3</code></pre>

<p><strong>å› ä¸ºæ˜¯å¼‚æ­¥æ“ä½œï¼Œæ‰€ä»¥æœ‰ä¸ªç¼–å·ä¸º2çš„å­çº¿ç¨‹è¢«å¼€è¾Ÿï¼Œä½†æœ‰å› ä¸ºæ˜¯ä¸²è¡Œé˜Ÿåˆ—ï¼Œæ‰€ä»¥åªå¼€è¾Ÿäº†ä¸€ä¸ªçº¿ç¨‹ã€‚æœ€ç»ˆé€ å°±äº†ä¸‰ä¸ªä»»åŠ¡é¡ºåºæ‰§è¡Œã€‚</strong></p>
<h5 id="3-å¹¶è¡Œé˜Ÿåˆ—åŒæ­¥æ‰§è¡Œä»»åŠ¡"><a href="#3-å¹¶è¡Œé˜Ÿåˆ—åŒæ­¥æ‰§è¡Œä»»åŠ¡" class="headerlink" title="3. å¹¶è¡Œé˜Ÿåˆ—åŒæ­¥æ‰§è¡Œä»»åŠ¡"></a>3. å¹¶è¡Œé˜Ÿåˆ—åŒæ­¥æ‰§è¡Œä»»åŠ¡</h5><ul>
<li>åŒæ­¥ä¸å…·æœ‰åˆ›å»ºæ–°çº¿ç¨‹çš„èƒ½åŠ›ï¼Œä¸ä¼šå¼€è¾Ÿæ–°çš„çº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼Œä¼šåœ¨å½“å‰ç¨‹åºçš„ä¸»çº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡</li>
<li>æŒ‰ç…§åŒæ­¥çš„æ–¹å¼å»æ‰§è¡Œä»»åŠ¡</li>
</ul>
<pre><code>-(void)syncCONCURRENT{
  NSLog(@"star");
  //ä¸ä¼šå¼€è¾Ÿæ–°çš„çº¿ç¨‹
  //ä¸²è¡Œæ‰§è¡Œå‘½ä»¤
  dispatch_queue_t queue=dispatch_queue_create("com.GCD_demo.www", DISPATCH_QUEUE_CONCURRENT);
  dispatch_sync(queue, ^{
      [NSThread sleepForTimeInterval:3];
      NSLog(@"CONCURRENT_work_1 ");
  });
  dispatch_sync(queue, ^{
      [NSThread sleepForTimeInterval:2];
      NSLog(@"CONCURRENT_work_2 ");
  });
  dispatch_sync(queue, ^{
      NSLog(@"CONCURRENT_work_3 ");
  });

  NSLog(@"end");
}</code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-20 20:13:03.753 GCD_Demo[8232:1033759] star
2016-07-20 20:13:06.755 GCD_Demo[8232:1033759] CONCURRENT_work_1 
2016-07-20 20:13:08.756 GCD_Demo[8232:1033759] CONCURRENT_work_2 
2016-07-20 20:13:08.756 GCD_Demo[8232:1033759] CONCURRENT_work_3 
2016-07-20 20:13:08.757 GCD_Demo[8232:1033759] end</code></pre>

<p><strong>è™½ç„¶å¹¶è¡Œé˜Ÿåˆ—å†³å®šäº†è¯¥é˜Ÿåˆ—ä¸­å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œä½†ç”±äºæ˜¯åŒæ­¥æ“ä½œï¼Œä¸èƒ½å¼€è¾Ÿçº¿ç¨‹ï¼Œæ‰€ä»¥è¿˜éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æŒ‰é¡ºåºæ‰§è¡Œã€‚</strong></p>
<h5 id="4-å¹¶å‘é˜Ÿåˆ—å¼‚æ­¥æ‰§è¡Œä»»åŠ¡-å¸¸ç”¨"><a href="#4-å¹¶å‘é˜Ÿåˆ—å¼‚æ­¥æ‰§è¡Œä»»åŠ¡-å¸¸ç”¨" class="headerlink" title="4. å¹¶å‘é˜Ÿåˆ—å¼‚æ­¥æ‰§è¡Œä»»åŠ¡(å¸¸ç”¨)"></a>4. å¹¶å‘é˜Ÿåˆ—å¼‚æ­¥æ‰§è¡Œä»»åŠ¡(å¸¸ç”¨)</h5><ul>
<li>å¼‚æ­¥å…·æœ‰åˆ›å»ºæ–°çº¿ç¨‹çš„èƒ½åŠ›ï¼Œä¼šå¼€è¾Ÿæ–°çš„çº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼Œä¸ä¼šåœ¨å½“å‰ç¨‹åºçš„ä¸»çº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡</li>
<li>æŒ‰ç…§å¹¶å‘çš„æ–¹å¼å»æ‰§è¡Œä»»åŠ¡</li>
</ul>
<pre><code>-(void)asyncCONCURRENT{
  NSLog(@"star");

  //ä¸€ä¸ªé˜Ÿåˆ— ä¸º æ¯ä¸ªä»»åŠ¡å¼€è¾Ÿä¸€ä¸ªçº¿ç¨‹
  dispatch_queue_t queue=dispatch_queue_create("com.GCD_demo.www", DISPATCH_QUEUE_CONCURRENT);
  dispatch_async(queue, ^{
      [NSThread sleepForTimeInterval:3];
      NSLog(@"CONCURRENT_work_1 ");
  });
  dispatch_async(queue, ^{
      [NSThread sleepForTimeInterval:2];
      NSLog(@"CONCURRENT_work_2 ");
  });
  dispatch_async(queue, ^{
      NSLog(@"CONCURRENT_work_3 ");
  });

  NSLog(@"end");
}</code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-20 20:18:26.768 GCD_Demo[8256:1038143] star
2016-07-20 20:18:26.768 GCD_Demo[8256:1038143] end
2016-07-20 20:18:26.769 GCD_Demo[8256:1038192] CONCURRENT_work_3 
2016-07-20 20:18:28.771 GCD_Demo[8256:1038179] CONCURRENT_work_2 
2016-07-20 20:18:29.773 GCD_Demo[8256:1038188] CONCURRENT_work_1</code></pre>

<p><strong>å¹¶è¡Œé˜Ÿåˆ—å¯ä»¥é‡Œå¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼ŒåŒæ­¥æ‰§è¡Œçš„æ–¹å¼åˆå¯ä»¥å¼€è¾Ÿå¤šä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥è¿™é‡Œå®ç°äº†å¤šä¸ªçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œã€‚</strong></p>
<hr>
<h3 id="5-Dispatch-Group"><a href="#5-Dispatch-Group" class="headerlink" title="5.Dispatch Group"></a>5.Dispatch Group</h3><p>å½“æˆ‘ä»¬æƒ³åœ¨gcd queueä¸­æ‰€æœ‰çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹ååšäº›ç‰¹å®šäº‹æƒ…çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯é˜Ÿåˆ—çš„åŒæ­¥é—®é¢˜ï¼Œå¦‚æœé˜Ÿåˆ—æ˜¯ä¸²è¡Œçš„è¯ï¼Œé‚£å°†è¯¥æ“ä½œæœ€åæ·»åŠ åˆ°é˜Ÿåˆ—ä¸­å³å¯ï¼Œä½†å¦‚æœé˜Ÿåˆ—æ˜¯å¹¶è¡Œé˜Ÿåˆ—çš„è¯ï¼Œè¿™æ—¶å€™å°±å¯ä»¥åˆ©ç”¨dispatch_groupæ¥å®ç°äº†ï¼Œdispatch_groupèƒ½å¾ˆæ–¹ä¾¿çš„è§£å†³åŒæ­¥çš„é—®é¢˜ã€‚dispatch_group_createå¯ä»¥åˆ›å»ºä¸€ä¸ªgroupå¯¹è±¡ï¼Œç„¶åå¯ä»¥æ·»åŠ blockåˆ°è¯¥ç»„é‡Œé¢ï¼Œä¸‹é¢çœ‹ä¸‹å®ƒçš„ä¸€äº›ç”¨æ³•ï¼š</p>
<ul>
<li><p>dispatch_group_notify<br>  æ˜¯é€šè¿‡å¼‚æ­¥çš„æ–¹å¼é€šçŸ¥ï¼Œæ‰€ä»¥ï¼Œä¸ä¼šé˜»å¡çº¿ç¨‹</p>
<pre><code>-(void)asyncGroupNotify
{
NSLog(@"star");
dispatch_group_t group=dispatch_group_create();
dispatch_queue_t queue=dispatch_queue_create("com.GCD_demo.www", DISPATCH_QUEUE_CONCURRENT);
dispatch_group_async(group, queue, ^{
    [NSThread sleepForTimeInterval:1];
    NSLog(@"group_work_1");
});
dispatch_group_async(group, queue, ^{
    [NSThread sleepForTimeInterval:6];
    NSLog(@"group_work_2");
});
dispatch_group_async(group, queue, ^{
    [NSThread sleepForTimeInterval:2];
    NSLog(@"group_work_3");
});

dispatch_group_notify(group, queue, ^{
    NSLog(@"dispatch_group_Notify ç»“æŸ");
});
}</code></pre>

</li>
</ul>
<p>è¿è¡Œç»“æœ</p>
<pre><code>2016-07-21 13:51:40.600 GCD_Demo[9044:1162213] star
2016-07-21 13:51:41.605 GCD_Demo[9044:1162359] group_work_1
2016-07-21 13:51:42.608 GCD_Demo[9044:1162389] group_work_3
2016-07-21 13:51:46.603 GCD_Demo[9044:1162349] group_work_2
2016-07-21 13:51:46.605 GCD_Demo[9044:1162349] dispatch_group_Notify ç»“æŸ</code></pre>

<ul>
<li>dispatch_group_wait<br>  ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼ŒçŸ¥é“ä»»åŠ¡éƒ½å®Œæˆæ—¶æ‰ä¼šç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç </li>
</ul>
<pre><code>-(void)asyncGroupWait
{
    NSLog(@"star");
    dispatch_group_t group=dispatch_group_create();
    dispatch_queue_t queue=dispatch_queue_create("com.GCD_demo.www", DISPATCH_QUEUE_CONCURRENT);
    dispatch_group_async(group, queue, ^{
        [NSThread sleepForTimeInterval:1];
        NSLog(@"group_work_1");
    });
    dispatch_group_async(group, queue, ^{
        [NSThread sleepForTimeInterval:6];
        NSLog(@"group_work_2");
    });
    dispatch_group_async(group, queue, ^{
        [NSThread sleepForTimeInterval:2];
        NSLog(@"group_work_3");
    });

    //åœ¨æ­¤è®¾ç½®äº†ä¸€ä¸ª12ç§’çš„ç­‰å¾…æ—¶é—´ï¼Œå¦‚æœgroupçš„æ‰§è¡Œç»“æŸæ²¡æœ‰åˆ°12ç§’é‚£ä¹ˆå°±è¿”å›0
    //å¦‚æœæ‰§è¡Œgroupçš„æ‰§è¡Œæ—¶é—´è¶…è¿‡äº†12ç§’ï¼Œé‚£ä¹ˆè¿”å›é0 æ•°å€¼ï¼Œ
    //åœ¨ä½¿ç”¨dispatch_group_waitå‡½æ•°çš„æ—¶å€™ï¼Œä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œé˜»å¡çš„æ—¶é—´ åœ¨waitå‡½æ•°æ—¶é—´å€¼å’Œå½“å‰groupæ‰§è¡Œæ—¶é—´å€¼å–æœ€å°çš„ã€‚
    long kk=dispatch_group_wait(group, dispatch_time(DISPATCH_TIME_NOW, 12 * NSEC_PER_SEC));
    if(kk==0)
    {
         NSLog(@"dispatch_group_wait ç»“æœ1");
    }
    else
    {
         NSLog(@"dispatch_group_wait ç»“æœ2");
    }

}</code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-21 13:56:47.471 GCD_Demo[9065:1165380] star
2016-07-21 13:56:48.472 GCD_Demo[9065:1165494] group_work_1
2016-07-21 13:56:49.476 GCD_Demo[9065:1165502] group_work_3
2016-07-21 13:56:53.475 GCD_Demo[9065:1165485] group_work_2
2016-07-21 13:56:53.475 GCD_Demo[9065:1165380] dispatch_group_wait ç»“æœ1</code></pre>

<ul>
<li>dispatch_group_enter&amp;dispatch_group_leave<br>  å‡å¦‚æˆ‘ä»¬ä¸æƒ³ä½¿ç”¨dispatch_group_asyncå¼‚æ­¥çš„å°†ä»»åŠ¡ä¸¢åˆ°groupä¸­å»æ‰§è¡Œï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°dispatch_group_enterè·Ÿdispatch_group_leaveæ–¹æ³•ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•è¦é…å¯¹å‡ºç°ï¼Œä»¥ä¸‹è¿™ä¸¤ç§æ–¹æ³•æ˜¯ç­‰ä»·çš„ï¼š</li>
</ul>
<pre><code>-(void)asyncGroupEnter
{
  // ç¾¤ç»„ï¼ç»Ÿä¸€ç›‘æ§ä¸€ç»„ä»»åŠ¡
  dispatch_group_t group = dispatch_group_create();

  dispatch_queue_t queue = dispatch_get_global_queue(0, 0);

  // 1> å…¥ç»„ -> ä¹‹åçš„ block ä¼šè¢« group ç›‘å¬
  // dispatch_group_enter ä¸€å®šå’Œ dispatch_group_leave è¦é…å¯¹å‡ºç°
  dispatch_group_enter(group);
  dispatch_async(queue, ^{
      NSLog(@"dispatch_async_work1");

      // block çš„æœ«å°¾ï¼Œæ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œæ·»åŠ ä¸€ä¸ªå‡ºç»„
      dispatch_group_leave(group);
  });

  //  å†æ¬¡å…¥ç»„
  dispatch_group_enter(group);
  dispatch_async(queue, ^{
      [NSThread sleepForTimeInterval:6];

      NSLog(@"dispatch_async_work1");

      // block çš„æœ«å°¾ï¼Œæ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œæ·»åŠ ä¸€ä¸ªå‡ºç»„
      dispatch_group_leave(group);
  });

  // ç¾¤ç»„ç»“æŸ
  dispatch_group_notify(group, dispatch_get_main_queue(), ^{
      NSLog(@"OVER");
  });  
  NSLog(@"come here");
}</code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-21 15:21:40.707 GCD_Demo[9256:1205427] come here
2016-07-21 15:21:40.707 GCD_Demo[9256:1205465] dispatch_async_work1
2016-07-21 15:21:46.709 GCD_Demo[9256:1205460] dispatch_async_work1
2016-07-21 15:21:46.710 GCD_Demo[9256:1205427] OVER</code></pre>



<hr>
<h3 id="6-Dispatch-Block"><a href="#6-Dispatch-Block" class="headerlink" title="6. Dispatch Block"></a>6. Dispatch Block</h3><p>æ·»åŠ åˆ°gcdé˜Ÿåˆ—ä¸­æ‰§è¡Œçš„ä»»åŠ¡æ˜¯ä»¥blockçš„å½¢å¼æ·»åŠ çš„ï¼Œblockå°è£…äº†éœ€è¦æ‰§è¡ŒåŠŸèƒ½ï¼Œblockå¸¦æ¥çš„å¼€å‘æ•ˆç‡æå‡å°±ä¸è¯´äº†ï¼Œgcdè·Ÿblockå¯ä»¥è¯´æ˜¯ä¸€å¯¹å¥½åŸºå‹ï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„é…åˆä½¿ç”¨ã€‚</p>
<pre><code>-(void)dispatchBlock
{
    dispatch_queue_t queue = dispatch_queue_create("com.GCD_demo.www", DISPATCH_QUEUE_SERIAL);
    dispatch_block_t block=dispatch_block_create(0, ^{
        NSLog(@"dispatchBlock_work");
    });

    dispatch_sync(queue, block);
}</code></pre>

<h5 id="1-dispatch-block-wait"><a href="#1-dispatch-block-wait" class="headerlink" title="1.dispatch_block_wait"></a>1.dispatch_block_wait</h5><p>å½“éœ€è¦ç­‰å¾…å‰é¢çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨dispatch_block_waitè¿™ä¸ªæ¥å£ï¼Œè®¾ç½®ç­‰å¾…æ—¶é—´DISPATCH_TIME_FOREVERä¼šä¸€ç›´ç­‰å¾…ç›´åˆ°å‰é¢çš„ä»»åŠ¡å®Œæˆ.ç”¨æ³•è·Ÿdispatch_group_waitç±»ä¼¼</p>
<pre><code>-(void)dispatchBlockWait
{
    dispatch_queue_t queue = dispatch_queue_create("com.GCD_demo.www", DISPATCH_QUEUE_SERIAL);
    dispatch_block_t block = dispatch_block_create(0, ^{
        NSLog(@"before sleep");
        [NSThread sleepForTimeInterval:6];
        NSLog(@"after sleep");
    });
    dispatch_async(queue, block);
    //ç­‰å¾…å‰é¢çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•
    long kk=dispatch_block_wait(block, dispatch_time(DISPATCH_TIME_NOW, 3 * NSEC_PER_SEC));
    if(kk==0)
    {
        NSLog(@"coutinue");
    }
    else
    {
        NSLog(@"timeOutï¼ï¼ï¼");
    }
}</code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-21 16:28:38.313 GCD_Demo[9533:1251011] before sleep
2016-07-21 16:28:41.314 GCD_Demo[9533:1250971] timeOutï¼ï¼ï¼
2016-07-21 16:28:44.318 GCD_Demo[9533:1251011] after sleep</code></pre>

<h5 id="2-dispatch-block-notify"><a href="#2-dispatch-block-notify" class="headerlink" title="2.dispatch_block_notify"></a>2.dispatch_block_notify</h5><p>dispatch_block_notifyå½“è§‚å¯Ÿçš„æŸä¸ªblockæ‰§è¡Œç»“æŸä¹‹åç«‹åˆ»é€šçŸ¥æäº¤å¦ä¸€ç‰¹å®šçš„blockåˆ°æŒ‡å®šçš„queueä¸­æ‰§è¡Œï¼Œè¯¥å‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€å‚æ•°æ˜¯éœ€è¦è§‚å¯Ÿçš„blockï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¢«é€šçŸ¥blockæäº¤æ‰§è¡Œçš„queueï¼Œç¬¬ä¸‰å‚æ•°æ˜¯å½“éœ€è¦è¢«é€šçŸ¥æ‰§è¡Œçš„block</p>
<pre><code>-(void)dispatchBlockNotify
{
    dispatch_queue_t queue = dispatch_queue_create("com.GCD_demo.www", DISPATCH_QUEUE_SERIAL);
    dispatch_block_t previousBlock = dispatch_block_create(0, ^{
        NSLog(@"previousBlock begin");
        [NSThread sleepForTimeInterval:2];
        NSLog(@"previousBlock done");
    });
    dispatch_async(queue, previousBlock);
    dispatch_block_t notifyBlock = dispatch_block_create(0, ^{
        NSLog(@"notifyBlock");
    });
    //å½“previousBlockæ‰§è¡Œå®Œæ¯•åï¼Œæäº¤notifyBlockåˆ°global queueä¸­æ‰§è¡Œ
    dispatch_block_notify(previousBlock, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), notifyBlock);
}</code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-21 16:38:19.756 GCD_Demo[9664:1261328] previousBlock begin
2016-07-21 16:38:21.762 GCD_Demo[9664:1261328] previousBlock done
2016-07-21 16:38:21.762 GCD_Demo[9664:1261329] notifyBlock</code></pre>

<h5 id="3-dispatch-block-cancel"><a href="#3-dispatch-block-cancel" class="headerlink" title="3. dispatch_block_cancel"></a>3. dispatch_block_cancel</h5><p>å¯ä»¥å–æ¶ˆæäº¤åˆ°é˜Ÿåˆ—çš„block</p>
<pre><code>-(void)dispatchBlockCancel
{
    dispatch_queue_t queue = dispatch_queue_create("com.GCD_demo.www", DISPATCH_QUEUE_CONCURRENT);
    dispatch_block_t block1 = dispatch_block_create(0, ^{
        NSLog(@"block1 begin");
        [NSThread sleepForTimeInterval:1];
        NSLog(@"block1 done");
    });
    dispatch_block_t block2 = dispatch_block_create(0, ^{
        NSLog(@"block2 ");
    });
    dispatch_async(queue, block1);
    dispatch_async(queue, block2);
    dispatch_block_cancel(block2);
}</code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-21 16:50:28.140 GCD_Demo[9723:1272259] block1 begin
2016-07-21 16:50:29.144 GCD_Demo[9723:1272259] block1 done</code></pre>


<hr>
<h3 id="7-dispatch-after"><a href="#7-dispatch-after" class="headerlink" title="7.dispatch_after"></a>7.dispatch_after</h3><p>æ¥å»¶è¿Ÿæ‰§è¡Œçš„GCDæ–¹æ³•ï¼Œå› ä¸ºåœ¨ä¸»çº¿ç¨‹ä¸­æˆ‘ä»¬ä¸èƒ½ç”¨sleepæ¥å»¶è¿Ÿæ–¹æ³•çš„è°ƒç”¨ï¼Œæ‰€ä»¥ç”¨å®ƒæ˜¯æœ€åˆé€‚çš„ï¼Œæˆ‘ä»¬åšä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<pre><code>-(void)dispatchAfter
{
    NSLog(@"dispatchAfter_star");
    int64_t time=2*NSEC_PER_SEC;

    dispatch_queue_t mainQueue=dispatch_get_main_queue();

        for (int i=0; i<5; i++)="" {="" dispatch_time_t="" distime="dispatch_time(DISPATCH_TIME_NOW," time*i);="" dispatch_after(distime,="" mainqueue,="" ^{="" nslog(@"dispatchafter_work");="" });="" }="" }<="" code=""></5;></code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-21 16:12:07.204 GCD_Demo[9439:1237251] dispatchAfter_star
2016-07-21 16:12:07.211 GCD_Demo[9439:1237251] dispatchAfter_work
2016-07-21 16:12:09.398 GCD_Demo[9439:1237251] dispatchAfter_work
2016-07-21 16:12:11.205 GCD_Demo[9439:1237251] dispatchAfter_work
2016-07-21 16:12:13.205 GCD_Demo[9439:1237251] dispatchAfter_work
2016-07-21 16:12:15.205 GCD_Demo[9439:1237251] dispatchAfter_work</code></pre>


<hr>
<h3 id="8-dispatch-apply"><a href="#8-dispatch-apply" class="headerlink" title="8.dispatch_apply"></a>8.dispatch_apply</h3><p>dispatch_applyç±»ä¼¼ä¸€ä¸ªforå¾ªç¯ï¼Œä¼šåœ¨æŒ‡å®šçš„dispatch queueä¸­è¿è¡Œblockä»»åŠ¡næ¬¡ï¼Œå¦‚æœé˜Ÿåˆ—æ˜¯å¹¶å‘é˜Ÿåˆ—ï¼Œåˆ™ä¼šå¹¶å‘æ‰§è¡Œblockä»»åŠ¡ï¼Œdispatch_applyæ˜¯ä¸€ä¸ªåŒæ­¥è°ƒç”¨ï¼Œblockä»»åŠ¡æ‰§è¡Œnæ¬¡åæ‰è¿”å›ã€‚</p>
<pre><code>-(void)dispatchApply
{
    dispatch_queue_t queue = dispatch_queue_create("com.GCD_demo.www", DISPATCH_QUEUE_CONCURRENT);


    dispatch_apply(6, queue, ^(size_t i) {
        NSLog(@"do a job %zu times",i);

    });
    NSLog(@"go on");
}</code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-21 17:04:54.558 GCD_Demo[9831:1284549] do a job 0 times
2016-07-21 17:04:54.564 GCD_Demo[9831:1284583] do a job 1 times
2016-07-21 17:04:54.564 GCD_Demo[9831:1284589] do a job 2 times
2016-07-21 17:04:54.564 GCD_Demo[9831:1284593] do a job 3 times
2016-07-21 17:04:54.564 GCD_Demo[9831:1284549] do a job 4 times
2016-07-21 17:04:54.564 GCD_Demo[9831:1284583] do a job 5 times
2016-07-21 17:04:54.566 GCD_Demo[9831:1284549] go on</code></pre>


<hr>
<h3 id="9-dispatch-once"><a href="#9-dispatch-once" class="headerlink" title="9.dispatch_once"></a>9.dispatch_once</h3><p>æ•´ä¸ªç¨‹åºè¿è¡Œä¸­åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œä½¿ç”¨dispatch_onceå¯ä»¥ç®€åŒ–ä»£ç å¹¶ä¸”å½»åº•ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå¼€å‘è€…æ ¹æœ¬æ— é¡»æ‹…å¿ƒåŠ é”æˆ–è€…åŒæ­¥ã€‚æ‰€æœ‰é—®é¢˜éƒ½ç”±GCDåœ¨åº•å±‚å¤„ç†ã€‚ç”±äºæ¯æ¬¡è°ƒç”¨æ—¶éƒ½å¿…é¡»ä½¿ç”¨å®Œå…¨ç›¸åŒçš„æ ‡è®°ï¼Œæ‰€ä»¥æ ‡è®°è¦å£°æ˜æˆstaticã€‚æ‰€ä»¥ç”¨åœ¨å•ä¾‹æ¨¡å¼ä¸Šæ˜¯æœ€å¥½çš„</p>
<pre><code>static SingletonTimer * instance;
static dispatch_once_t onceToken;
dispatch_once(&onceToken, ^{
    instance = [[SingletonTimer alloc] init];
});

return instance;</code></pre>


<hr>
<h3 id="10-dispatch-barrier-async"><a href="#10-dispatch-barrier-async" class="headerlink" title="10. dispatch_barrier_async"></a>10. dispatch_barrier_async</h3><p>dispatch_barrier_asyncç”¨äºç­‰å¾…å‰é¢çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åè‡ªå·±æ‰æ‰§è¡Œï¼Œè€Œå®ƒåé¢çš„ä»»åŠ¡éœ€ç­‰å¾…å®ƒå®Œæˆä¹‹åæ‰æ‰§è¡Œã€‚ä¸€ä¸ªå…¸å‹çš„ä¾‹å­å°±æ˜¯æ•°æ®çš„è¯»å†™ï¼Œé€šå¸¸ä¸ºäº†é˜²æ­¢æ–‡ä»¶è¯»å†™å¯¼è‡´å†²çªï¼Œæˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªä¸²è¡Œçš„é˜Ÿåˆ—ï¼Œæ‰€æœ‰çš„æ–‡ä»¶æ“ä½œéƒ½æ˜¯é€šè¿‡è¿™ä¸ªé˜Ÿåˆ—æ¥æ‰§è¡Œï¼Œæ¯”å¦‚FMDBï¼Œè¿™æ ·å°±å¯ä»¥é¿å…è¯»å†™å†²çªã€‚ä¸è¿‡å…¶å®è¿™æ ·æ•ˆç‡æ˜¯æœ‰æå‡çš„ç©ºé—´çš„ï¼Œå½“æ²¡æœ‰æ›´æ–°æ•°æ®æ—¶ï¼Œè¯»æ“ä½œå…¶å®æ˜¯å¯ä»¥å¹¶è¡Œè¿›è¡Œçš„ï¼Œè€Œå†™æ“ä½œéœ€è¦ä¸²è¡Œçš„æ‰§è¡Œ</p>
<pre><code>-(void)diapatchBarrier
{
    dispatch_queue_t queue = dispatch_queue_create("com.GCD_demo.www", DISPATCH_QUEUE_CONCURRENT);

    dispatch_async(queue, ^{
        [NSThread sleepForTimeInterval:6];
        NSLog(@"dispatch_async_work1");
    });
    dispatch_async(queue, ^{
        [NSThread sleepForTimeInterval:2];
        NSLog(@"dispatch_async_work2");
    });
    dispatch_barrier_async(queue, ^{
        NSLog(@"dispatch_async_work3");
        [NSThread sleepForTimeInterval:1];

    });
    dispatch_async(queue, ^{
        [NSThread sleepForTimeInterval:1];
        NSLog(@"dispatch_async_work4");
    });
}</code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-21 15:54:24.402 GCD_Demo[9354:1225160] dispatch_async_work2
2016-07-21 15:54:28.403 GCD_Demo[9354:1225152] dispatch_async_work1
2016-07-21 15:54:28.403 GCD_Demo[9354:1225152] dispatch_async_work3
2016-07-21 15:54:30.412 GCD_Demo[9354:1225152] dispatch_async_work4</code></pre>


<hr>
<h3 id="11-dispatch-set-target-queue"><a href="#11-dispatch-set-target-queue" class="headerlink" title="11.dispatch_set_target_queue"></a>11.dispatch_set_target_queue</h3><p>1.ç³»ç»Ÿçš„Global Queueæ˜¯å¯ä»¥æŒ‡å®šä¼˜å…ˆçº§çš„ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ç”¨åˆ°dispatch_set_target_queueè¿™ä¸ªæ–¹æ³•æ¥æŒ‡å®šè‡ªå·±åˆ›å»ºé˜Ÿåˆ—çš„ä¼˜å…ˆçº§</p>
<pre><code>-(void)DispatchSet
{
    dispatch_queue_t serialDiapatchQueue=dispatch_queue_create("com.GCD_demo.www", DISPATCH_QUEUE_SERIAL);
    dispatch_queue_t dispatchgetglobalqueue=dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0);
    dispatch_set_target_queue(serialDiapatchQueue, dispatchgetglobalqueue);
    dispatch_async(serialDiapatchQueue, ^{
        NSLog(@"æˆ‘ä¼˜å…ˆçº§ä½ï¼Œå…ˆè®©è®©");
    });
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        NSLog(@"æˆ‘ä¼˜å…ˆçº§é«˜,æˆ‘å…ˆblock");
    });
}</code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-21 17:22:02.512 GCD_Demo[9902:1297023] æˆ‘ä¼˜å…ˆçº§é«˜,æˆ‘å…ˆblock
2016-07-21 17:22:02.512 GCD_Demo[9902:1297035] æˆ‘ä¼˜å…ˆçº§ä½ï¼Œå…ˆè®©è®©</code></pre>

<p>2.dispatch_set_target_queueé™¤äº†èƒ½ç”¨æ¥è®¾ç½®é˜Ÿåˆ—çš„ä¼˜å…ˆçº§ä¹‹å¤–ï¼Œè¿˜èƒ½å¤Ÿåˆ›å»ºé˜Ÿåˆ—çš„å±‚æ¬¡ä½“ç³»ï¼Œå½“æˆ‘ä»¬æƒ³è®©ä¸åŒé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡åŒæ­¥çš„æ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—ï¼Œç„¶åå°†è¿™äº›é˜Ÿåˆ—çš„targetæŒ‡å‘æ–°åˆ›å»ºçš„é˜Ÿåˆ—å³å¯</p>
<pre><code>-(void)dispatchSet2
{
    dispatch_queue_t targetQueue = dispatch_queue_create("target_queue", DISPATCH_QUEUE_SERIAL);
    dispatch_queue_t queue1 = dispatch_queue_create("queue1", DISPATCH_QUEUE_SERIAL);
    dispatch_queue_t queue2 = dispatch_queue_create("queue2", DISPATCH_QUEUE_CONCURRENT);


    dispatch_set_target_queue(queue1, targetQueue);
    dispatch_set_target_queue(queue2, targetQueue);

    dispatch_async(queue1, ^{
        [NSThread sleepForTimeInterval:3.f];
        NSLog(@"do job1");

    });
    dispatch_async(queue2, ^{
        [NSThread sleepForTimeInterval:2.f];
        NSLog(@"do job2");

    });
    dispatch_async(queue2, ^{
        [NSThread sleepForTimeInterval:1.f];
        NSLog(@"do job3");

    });
}</code></pre>

<p>æ‰§è¡Œç»“æœ</p>
<pre><code>2016-07-21 17:28:54.327 GCD_Demo[10043:1303853] do job1
2016-07-21 17:28:56.331 GCD_Demo[10043:1303853] do job2
2016-07-21 17:28:57.335 GCD_Demo[10043:1303853] do job3</code></pre>


<hr>
<h3 id="12-dispatch-semaphore-t"><a href="#12-dispatch-semaphore-t" class="headerlink" title="12.dispatch_semaphore_t"></a>12.dispatch_semaphore_t</h3><p>ä¿¡å·é‡æ˜¯ä¸€ç§è€å¼çš„çº¿ç¨‹æ¦‚å¿µï¼Œç”±éå¸¸è°¦å‘çš„ Edsger W. Dijkstra ä»‹ç»ç»™ä¸–ç•Œã€‚ä¿¡å·é‡ä¹‹æ‰€ä»¥æ¯”è¾ƒå¤æ‚æ˜¯å› ä¸ºå®ƒå»ºç«‹åœ¨æ“ä½œç³»ç»Ÿçš„å¤æ‚æ€§ä¹‹ä¸Šã€‚</p>
<pre><code>- (void)downloadImageURLWithString:(NSString *)URLString
{
    // 1
    dispatch_semaphore_t semaphore = dispatch_semaphore_create(0);

    NSURL *url = [NSURL URLWithString:URLString];
    __unused Photo *photo = [[Photo alloc]
                             initwithURL:url
                             withCompletionBlock:^(UIImage *image, NSError *error) {
                                 if (error) {
                                     XCTFail(@"%@ failed. %@", URLString, error);
                                 }

                                 // 2
                                 dispatch_semaphore_signal(semaphore);
                             }];

    // 3
    dispatch_time_t timeoutTime = dispatch_time(DISPATCH_TIME_NOW, kDefaultTimeoutLengthInNanoSeconds);
    if (dispatch_semaphore_wait(semaphore, timeoutTime)) {
        XCTFail(@"%@ timed out", URLString);
    }
}</code></pre>

<p>ä¸‹é¢æ¥è¯´æ˜ä½ ä»£ç ä¸­çš„ä¿¡å·é‡æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªä¿¡å·é‡ã€‚å‚æ•°æŒ‡å®šä¿¡å·é‡çš„èµ·å§‹å€¼ã€‚è¿™ä¸ªæ•°å­—æ˜¯ä½ å¯ä»¥è®¿é—®çš„ä¿¡å·é‡ï¼Œä¸éœ€è¦æœ‰äººå…ˆå»å¢åŠ å®ƒçš„æ•°é‡ã€‚ï¼ˆæ³¨æ„åˆ°å¢åŠ ä¿¡å·é‡ä¹Ÿè¢«å«åšå‘å°„ä¿¡å·é‡ï¼‰ã€‚è¯‘è€…æ³¨ï¼šè¿™é‡Œåˆå§‹åŒ–ä¸º0ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰äººæƒ³ä½¿ç”¨ä¿¡å·é‡å¿…ç„¶ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°æœ‰äººå¢åŠ ä¿¡å·é‡ã€‚</li>
<li>åœ¨ Completion Block é‡Œä½ å‘Šè¯‰ä¿¡å·é‡ä½ ä¸å†éœ€è¦èµ„æºäº†ã€‚è¿™å°±ä¼šå¢åŠ ä¿¡å·é‡çš„è®¡æ•°å¹¶å‘ŠçŸ¥å…¶ä»–æƒ³ä½¿ç”¨æ­¤èµ„æºçš„çº¿ç¨‹ã€‚</li>
<li>è¿™ä¼šåœ¨è¶…æ—¶ä¹‹å‰ç­‰å¾…ä¿¡å·é‡ã€‚è¿™ä¸ªè°ƒç”¨é˜»å¡äº†å½“å‰çº¿ç¨‹ç›´åˆ°ä¿¡å·é‡è¢«å‘å°„ã€‚è¿™ä¸ªå‡½æ•°çš„ä¸€ä¸ªéé›¶è¿”å›å€¼è¡¨ç¤ºåˆ°è¾¾è¶…æ—¶äº†ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæµ‹è¯•å°†ä¼šå¤±è´¥å› ä¸ºå®ƒä»¥ä¸ºç½‘ç»œè¯·æ±‚ä¸ä¼šè¶…è¿‡ 10 ç§’é’Ÿå°±ä¼šè¿”å›â€”â€”ä¸€ä¸ªå¹³è¡¡ç‚¹ï¼</li>
</ol>
<hr>
<h3 id="13-GCDå®šæ—¶å™¨"><a href="#13-GCDå®šæ—¶å™¨" class="headerlink" title="13.GCDå®šæ—¶å™¨"></a>13.GCDå®šæ—¶å™¨</h3><p>åŸºäºä»¥å‰è®²çš„runloopä¸­çš„CFRunLoopTimerRef :</p>
<ul>
<li>CFRunLoopTimerRefæ˜¯åŸºäºæ—¶é—´çš„è§¦å‘å™¨</li>
<li>CFRunLoopTimerRefåŸºæœ¬ä¸Šè¯´çš„å°±æ˜¯NSTimer,å®ƒå—RunLoopçš„Modeçš„å½±å“(Tracking,Defalult)</li>
<li>GCDçš„å®šæ—¶å™¨ä¸å—RunLoopä¸­Modeçš„å½±å“(RunLoopå†…éƒ¨ä¹Ÿæ˜¯åŸºäºGCDå®ç°çš„,å¯ä»¥æ ¹æ®æºç çœ‹åˆ°), æ¯”å¦‚æ»šåŠ¨TableViewçš„æ—¶å€™,GCDçš„å®šæ—¶å™¨ä¸å—å½±å“</li>
<li>ä¸€èˆ¬NSTimerä¸æ˜¯ç‰¹åˆ«å‡†, NSTimeræ˜¯åœ¨RunLoopä¸­, RunLoopè¦å¤„ç†å„ç§ä¸œè¥¿(source,timer,observe),æœ‰æ—¶å¯¼è‡´NSTimerä¸æ˜¯ç‰¹åˆ«å‡†</li>
</ul>
<p>GCDå®šæ—¶å™¨ç®—æ˜¯ä¸€ä¸ªæº(source),ç±»å‹æ˜¯Timer</p>
<pre><code>-(void)startTime{
    __block int timeout=30; //å€’è®¡æ—¶æ—¶é—´
    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
    dispatch_source_t _timer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, 0, 0,queue);

    dispatch_source_set_timer(_timer,dispatch_walltime(NULL, 0),1.0*NSEC_PER_SEC, 0); //æ¯ç§’æ‰§è¡Œ
    dispatch_source_set_event_handler(_timer, ^{
        if(timeout=0){ //å€’è®¡æ—¶ç»“æŸï¼Œå…³é—­
            dispatch_source_cancel(_timer);
            dispatch_async(dispatch_get_main_queue(), ^{
                //å€’è®¡æ—¶æ—¶é—´ç»“æŸï¼Œå›åˆ°ä¸»çº¿ç¨‹ æ ¹æ®è‡ªå·±éœ€æ±‚è®¾ç½®

            });
        }else{
            //            int minutes = timeout / 60;
            int seconds = timeout % 60;
            NSString *strTime = [NSString stringWithFormat:@"%.2d", seconds];
            dispatch_async(dispatch_get_main_queue(), ^{
                //è®¾ç½®ç•Œé¢çš„æŒ‰é’®æ˜¾ç¤º æ ¹æ®è‡ªå·±éœ€æ±‚è®¾ç½®
                NSLog(@"____%@",strTime);
                [l_timeButton setTitle:[NSString stringWithFormat:@"%@ç§’åé‡æ–°å‘é€",strTime] forState:UIControlStateNormal];
                l_timeButton.userInteractionEnabled = NO;

            });
            timeout--;

        }
    });
    dispatch_resume(_timer);

}</code></pre>






<!-- more -->]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[èŠä¸€èŠNSOperationçš„é‚£äº›äº‹]]></title>
      <url>http://yoursite.com/2016/04/11/%E8%81%8A%E4%B8%80%E8%81%8ANSOperation%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/</url>
      <content type="html"><![CDATA[<p>åœ¨iOSå¼€å‘ä¸­ï¼Œå¤šçº¿ç¨‹æŠ€æœ¯ç”¨åˆ°æœ€å¤šçš„å°±æ˜¯GCDå’ŒNSOperationï¼Œä¸Šä¸€ç¯‡æ–‡ç« å·²ç»å¯¹GCDæœ‰äº†å…¨é¢çš„äº†è§£ï¼Œè¿™ç¯‡æ–‡ç« ç®€å•çš„èŠä¸€èŠNSOperationã€‚<br><a id="more"></a></p>
<h3 id="ä¸€ã€ç®€ä»‹"><a href="#ä¸€ã€ç®€ä»‹" class="headerlink" title="ä¸€ã€ç®€ä»‹"></a>ä¸€ã€ç®€ä»‹</h3><ul>
<li>é™¤äº†ï¼ŒNSThreadå’ŒGCDå®ç°å¤šçº¿ç¨‹ï¼Œé…åˆä½¿ç”¨NSOperationå’ŒNSOperationQueueä¹Ÿèƒ½å®ç°å¤šçº¿ç¨‹ç¼–ç¨‹</li>
</ul>
<blockquote>
<p>NSOperationå’ŒNSOperationQueue<code>å®ç°å¤šçº¿ç¨‹çš„å…·ä½“æ­¥éª¤</code></p>
</blockquote>
<ul>
<li>1ã€å…ˆå°†éœ€è¦æ‰§è¡Œçš„æ“ä½œå°è£…åˆ°ä¸€ä¸ªNSOperationçš„å­ç±»å¯¹è±¡ä¸­<ul>
<li>å®é™…ä¸Šï¼ŒNSOperationæ˜¯ä¸ªæŠ½è±¡ç±»,å¹¶ä¸å…·å¤‡å°è£…æ“ä½œçš„èƒ½åŠ›ï¼Œå¿…é¡»ä½¿ç”¨å®ƒçš„å­ç±»</li>
</ul>
</li>
<li>2ã€ç„¶åå°†NSOperationå¯¹è±¡æ·»åŠ åˆ°NSOperationQueueä¸­</li>
<li>3ã€ç³»ç»Ÿä¼šè‡ªåŠ¨å°†NSOperationQueueä¸­çš„NSOperationå–å‡ºæ¥</li>
<li>4ã€å°†å–å‡ºçš„NSOperationå°è£…çš„æ“ä½œæ”¾åˆ°ä¸€æ¡æ–°çº¿ç¨‹ä¸­æ‰§è¡Œ</li>
</ul>
<h3 id="äºŒã€NSOperation"><a href="#äºŒã€NSOperation" class="headerlink" title="äºŒã€NSOperation"></a>äºŒã€NSOperation</h3><ul>
<li>å¦‚ä¸Šæ‰€ç¤ºï¼šè¦å®ç°å¤šçº¿ç¨‹ï¼Œå¿…é¡»è¦å°†æ‰§è¡Œçš„æ“ä½œå°è£…åˆ°NSOperationçš„å­ç±»å¯¹è±¡ä¸­ï¼Œé‚£ä¹ˆNSOperationçš„å­ç±»æœ‰å“ªäº›ï¼Ÿ</li>
</ul>
<p><strong>1ã€ä½¿ç”¨NSOperationå­ç±»çš„æ–¹å¼æœ‰3ç§</strong></p>
<ul>
<li>NSInvocationOperation</li>
<li>NSBlockOperation</li>
<li>è‡ªå®šä¹‰å­ç±»ç»§æ‰¿NSOperationï¼Œå®ç°å†…éƒ¨ç›¸åº”mainçš„æ–¹æ³•å°è£…æ“ä½œ</li>
</ul>
<blockquote>
<p>1.1 NSInvocationOperation</p>
</blockquote>
<ul>
<li><p>åˆ›å»ºNSInvocationOperationå¯¹è±¡<br><code>-(id)initWithTarget:(id)target selector:(SEL)selector object:(id)arg;</code></p>
</li>
<li><p>è°ƒç”¨startæ–¹æ³•å¼€å§‹æ‰§è¡Œæ“ä½œ</p>
<ul>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œè°ƒç”¨äº†startæ–¹æ³•åå¹¶ä¸ä¼šå¼€ä¸€æ¡æ–°çº¿ç¨‹å»æ‰§è¡Œæ“ä½œï¼Œè€Œæ˜¯åœ¨å½“å‰çº¿ç¨‹åŒæ­¥æ‰§è¡Œæ“ä½œ<pre><code>// ä¸€æ—¦æ‰§è¡Œæ“ä½œï¼Œå°±ä¼šè°ƒç”¨targetçš„selectoræ–¹æ³•
-(void)start;
</code></pre></li>
<li>åªæœ‰å°†NSOperationæ“ä½œä»»åŠ¡æ”¾åˆ°ä¸€ä¸ªNSOperationQueueä¸­ï¼Œæ‰ä¼šå¼‚æ­¥æ‰§è¡Œæ“ä½œ</li>
</ul>
</li>
<li><p>ä½¿ç”¨</p>
<pre><code>- (void)invocation
{    
  // 1.å°†æ“ä½œå°è£…åˆ°Operationä¸­
  NSInvocationOperation *op1 = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(demo) object:nil];
  // 2.æ‰§è¡Œå°è£…çš„æ“ä½œ
  // å¦‚æœç›´æ¥æ‰§è¡ŒNSInvocationOperationä¸­çš„æ“ä½œ, é‚£ä¹ˆé»˜è®¤ä¼šåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œ
  [op1 start];

  NSInvocationOperation *op2 = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(test) object:nil];
  [op2 start];
}
</code></pre>

</li>
</ul>
<blockquote>
<p>1.2 NSBlockOperation</p>
</blockquote>
<ul>
<li>æ³¨æ„ç‚¹ï¼š<code>åªè¦NSBlockOperationå°è£…çš„æ“ä½œæ•° &gt;1ï¼Œå°±ä¼šå¼‚æ­¥æ‰§è¡Œæ“ä½œ</code></li>
<li>åˆ›å»ºNSBlockOperationå¯¹è±¡<pre><code>+(id)blockOperationWithBlock:(void(^)(void))block;</code></pre></li>
<li>é€šè¿‡addExecutionBlock:æ–¹æ³•æ·»åŠ æ›´å¤šçš„æ“ä½œ<pre><code>-(void)addExecutionBlock:(void(^)(void))block;</code></pre></li>
<li><p>ä½¿ç”¨</p>
<pre><code>- (void)blockOperation
{
  // 1.å°è£…æ“ä½œ
  NSBlockOperation *op1 = [NSBlockOperation blockOperationWithBlock:^{
      NSLog(@"1- %@", [NSThread currentThread]);
  }];

  // 2.æ·»åŠ æ“ä½œ
  [op1 addExecutionBlock:^{
      NSLog(@"2- %@", [NSThread currentThread]);
  }];
  [op1 addExecutionBlock:^{
      NSLog(@"3- %@", [NSThread currentThread]);
  }];

  // 2.æ‰§è¡Œæ“ä½œ
  // å¦‚æœåªå°è£…äº†ä¸€ä¸ªæ“ä½œ, é‚£ä¹ˆé»˜è®¤ä¼šåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œ
  // å¦‚æœå°è£…äº†å¤šä¸ªæ“ä½œ, é‚£ä¹ˆé™¤äº†ç¬¬ä¸€ä¸ªæ“ä½œä»¥å¤–, å…¶å®ƒçš„æ“ä½œä¼šåœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œ
  [op1 start];
}</code></pre>

</li>
</ul>
<blockquote>
<p>1.3 è‡ªå®šä¹‰ NSOperationï¼Œç»§æ‰¿NSOperation</p>
</blockquote>
<ul>
<li>å¦‚æœæ˜¯è‡ªå®šä¹‰ç±»ç»§æ‰¿äºNSOperation, é‚£ä¹ˆéœ€è¦å°†æ“ä½œå†™åˆ°è‡ªå®šä¹‰ç±»çš„mainæ–¹æ³•ä¸­ï¼Œé‡å†™mainæ–¹æ³•<ul>
<li>é‡å†™-(void)mainæ–¹æ³•çš„æ³¨æ„ç‚¹<ul>
<li>è‡ªå·±åˆ›å»ºè‡ªåŠ¨é‡Šæ”¾æ± ï¼ˆå› ä¸ºå¦‚æœæ˜¯å¼‚æ­¥æ“ä½œï¼Œæ— æ³•è®¿é—®ä¸»çº¿ç¨‹çš„è‡ªåŠ¨é‡Šæ”¾æ± ï¼‰</li>
<li>ç»å¸¸é€šè¿‡-(BOOL)isCancelledæ–¹æ³•æ£€æµ‹æ“ä½œæ˜¯å¦è¢«å–æ¶ˆï¼Œå¯¹å–æ¶ˆåšå‡ºå“åº”</li>
</ul>
</li>
</ul>
</li>
<li>è¿™ç§å®ç°æ–¹å¼å°è£…æ“ä½œ, å¯ä»¥æé«˜ä»£ç çš„å¤ç”¨æ€§</li>
<li>1.åˆ›å»ºç±»JPOperationï¼Œç»§æ‰¿NSOperation</li>
</ul>
<pre><code>#import <foundation foundation.h="">
@interface JPOperation : NSOperation

@end

#import "JPOperation.h"

@implementation JPOperation

// æˆ‘ä»¬è¦é‡å†™mainæ–¹æ³•ï¼Œå°è£…æ“ä½œ
- (void)main
{
    NSLog(@"%s, %@", __func__,[NSThread currentThread]);
}
@end
</foundation></code></pre>

<ul>
<li>2.ä½¿ç”¨è‡ªå®šä¹‰çš„NSOperation</li>
</ul>
<pre><code>// 1.å°è£…æ“ä½œ
JPOperation *op1 = [[JPOperation alloc] init];
// 2.æ‰§è¡Œæ“ä½œ
[op1 start];

JPOperation *op2 = [[JPOperation alloc] init];
[op2 start];
</code></pre>


<h3 id="ä¸‰ã€NSOperationQueue"><a href="#ä¸‰ã€NSOperationQueue" class="headerlink" title="ä¸‰ã€NSOperationQueue"></a>ä¸‰ã€NSOperationQueue</h3><ul>
<li><code>NSOperationQueueçš„ä½œç”¨:</code><ul>
<li>å¦‚ä¸Šæ‰€è¿°ï¼šNSOperationå¯ä»¥è°ƒç”¨startæ–¹æ³•æ¥æ‰§è¡Œä»»åŠ¡ï¼Œä½†é»˜è®¤æ˜¯åŒæ­¥æ‰§è¡Œçš„</li>
<li>å¦‚æœå°†NSOperation<code>æ·»åŠ åˆ°NSOperationQueue</code>ï¼ˆæ“ä½œé˜Ÿåˆ—ï¼‰ä¸­ï¼Œ<code>ç³»ç»Ÿä¼šè‡ªåŠ¨å¼‚æ­¥æ‰§è¡ŒNSOperationä¸­çš„æ“ä½œ</code></li>
</ul>
</li>
<li>æ·»åŠ æ“ä½œåˆ°NSOperationQueueï¼šä¸¤ä¸ªæ–¹æ³•<ul>
<li>åªè¦å°†ä¸€ä¸ªä»»åŠ¡æ·»åŠ åˆ°alloc/initçš„é˜Ÿåˆ—(é»˜è®¤å¹¶å‘ï¼Œå¯ä»¥è®¾ç½®å…¶ä¸ºä¸²è¡Œ)ä¸­, é‚£ä¹ˆé˜Ÿåˆ—å†…éƒ¨ä¼šè‡ªåŠ¨è°ƒç”¨start</li>
<li>å¦‚æœæƒ³å®ç°ä¸²è¡Œ, é‚£ä¹ˆå°±è®¾ç½®é˜Ÿåˆ—çš„maxConcurrentOperationCount = 1</li>
</ul>
</li>
</ul>
<pre><code>-(void)addOperation:(NSOperation*)op;
-(void)addOperationWithBlock:(void(^)(void))block;
</code></pre>

<blockquote>
<p>åŸºæœ¬ä½¿ç”¨</p>
</blockquote>
<ul>
<li>GCDé˜Ÿåˆ—:<ul>
<li>ä¸²è¡Œ: è‡ªå·±åˆ›å»º, ä¸»é˜Ÿåˆ—</li>
<li>å¹¶å‘: è‡ªå·±åˆ›å»º, å…¨å±€</li>
</ul>
</li>
<li>NSOperationQueue:<ul>
<li>è‡ªå·±åˆ›å»º: alloc/init â€“&gt; é»˜è®¤æ˜¯å¹¶å‘ â€“&gt; ä¹Ÿå¯ä»¥è®©å®ƒä¸²è¡Œ</li>
<li>ä¸»é˜Ÿåˆ— : mainQueue</li>
</ul>
</li>
</ul>
<pre><code>#import "ViewController.h"
#import "JPOperation.h"

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    // 1.åˆ›å»ºé˜Ÿåˆ—
    NSOperationQueue *queue = [[NSOperationQueue alloc] init];
    // 2.å°è£…ä»»åŠ¡
    JPOperation *op1 = [[JPOperation alloc] init];
    JPOperation *op2 = [[JPOperation alloc] init];

    // 3.å°†ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­
    [queue addOperation:op1];
    [queue addOperation:op2];
}

- (void)block
{
    // 1.åˆ›å»ºé˜Ÿåˆ—
    NSOperationQueue *queue = [[NSOperationQueue alloc] init];

    // 2.å°†ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­
    // addOperationWithBlockæ–¹æ³•ä¼šåšä¸¤ä»¶äº‹æƒ…
    // 1.æ ¹æ®ä¼ å…¥çš„block, åˆ›å»ºä¸€ä¸ªNSBlockOperationå¯¹è±¡
    // 2.å°†å†…éƒ¨åˆ›å»ºå¥½çš„NSBlockOperationå¯¹è±¡, æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­
    [queue addOperationWithBlock:^{
        NSLog(@"1 = %@", [NSThread currentThread]);
    }];
    [queue addOperationWithBlock:^{
        NSLog(@"2 = %@", [NSThread currentThread]);
    }];
}

- (void)invation
{
    /*
     GCDé˜Ÿåˆ—:
     ä¸²è¡Œ: è‡ªå·±åˆ›å»º, ä¸»é˜Ÿåˆ—
     å¹¶å‘: è‡ªå·±åˆ›å»º, å…¨å±€

     NSOperationQueue:
     è‡ªå·±åˆ›å»º: alloc/init --> é»˜è®¤æ˜¯å¹¶å‘ --> ä¹Ÿå¯ä»¥è®©å®ƒä¸²è¡Œ
     ä¸»é˜Ÿåˆ—  : mainQueue
     */
    // 1.åˆ›å»ºé˜Ÿåˆ—
    NSOperationQueue *queue = [[NSOperationQueue alloc] init];
    //    NSOperationQueue *queue = [NSOperationQueue mainQueue];

    // 2.å°è£…ä»»åŠ¡
    NSInvocationOperation *op1 = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(demo) object:nil];
    NSInvocationOperation *op2 = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(test) object:nil];

    // 3.å°†ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­
    // åªè¦å°†ä¸€ä¸ªä»»åŠ¡æ·»åŠ åˆ°alloc/initçš„é˜Ÿåˆ—ä¸­, é‚£ä¹ˆé˜Ÿåˆ—å†…éƒ¨ä¼šè‡ªåŠ¨è°ƒç”¨start
    // åªè¦å°†ä¸€ä¸ªä»»åŠ¡æ·»åŠ åˆ°alloc/initçš„é˜Ÿåˆ—ä¸­, å°±ä¼šå¼€å¯ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ‰§è¡Œé˜Ÿåˆ—
    [queue addOperation:op1];
    [queue addOperation:op2];
}

- (void)demo
{
    NSLog(@"demo = %@", [NSThread currentThread]);
}
- (void)test
{
    NSLog(@"test = %@", [NSThread currentThread]);
}
@end
</code></pre>


<h3 id="å››ã€NSOperatinoQueueçš„ä¸²è¡Œå’Œå¹¶å‘-ï¼š-æœ€å¤§å¹¶å‘æ•°"><a href="#å››ã€NSOperatinoQueueçš„ä¸²è¡Œå’Œå¹¶å‘-ï¼š-æœ€å¤§å¹¶å‘æ•°" class="headerlink" title="å››ã€NSOperatinoQueueçš„ä¸²è¡Œå’Œå¹¶å‘ ï¼š æœ€å¤§å¹¶å‘æ•°"></a>å››ã€NSOperatinoQueueçš„ä¸²è¡Œå’Œå¹¶å‘ ï¼š æœ€å¤§å¹¶å‘æ•°</h3><ul>
<li>é˜Ÿåˆ—çš„maxConcurrentOperationCountæœ€å¤§å¹¶å‘æ•°</li>
<li>maxConcurrentOperationCount é»˜è®¤ç­‰äº -1, ä»£è¡¨ä¸é™åˆ¶, å¯ä»¥åˆ›å»ºNå¤šçº¿ç¨‹</li>
<li>alloc/initçš„NSOperatinoQueueé˜Ÿåˆ—é»˜è®¤å°±æ˜¯å¹¶å‘ï¼Œ å¦‚æœæƒ³å®ç°ä¸²è¡Œ, é‚£ä¹ˆå°±è®¾ç½®maxConcurrentOperationCount = 1</li>
<li>æ³¨æ„: æœ€å¤§å¹¶å‘æ•°, ä¸èƒ½è®¾ç½®ä¸º0, å¦åˆ™ä»»åŠ¡ä¸ä¼šè¢«æ‰§è¡Œ </li>
</ul>
<pre><code>#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    // 1.åˆ›å»ºé˜Ÿåˆ—
    NSOperationQueue *queue = [[NSOperationQueue alloc] init
                               ];
    // maxConcurrentOperationCount é»˜è®¤ç­‰äº -1, ä»£è¡¨ä¸é™åˆ¶, å¯ä»¥åˆ›å»ºNå¤šçº¿ç¨‹
    // é»˜è®¤å°±æ˜¯å¹¶å‘
    // å¦‚æœæƒ³å®ç°ä¸²è¡Œ, é‚£ä¹ˆå°±è®¾ç½®maxConcurrentOperationCount = 1
    // æ³¨æ„: æœ€å¤§å¹¶å‘æ•°, ä¸èƒ½è®¾ç½®ä¸º0, å¦åˆ™ä»»åŠ¡ä¸ä¼šè¢«æ‰§è¡Œ \
    å¦‚æœæƒ³å†ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡, é‚£ä¹ˆç›´æ¥åˆ›å»ºmainQueuå³å¯
//    queue.maxConcurrentOperationCount = 1;

    // 2.åˆ›å»ºä»»åŠ¡
    NSBlockOperation *op1 = [NSBlockOperation blockOperationWithBlock:^{
        [NSThread sleepForTimeInterval:1];
        NSLog(@"1 = %@", [NSThread currentThread]);
    }];
    NSBlockOperation *op2 = [NSBlockOperation blockOperationWithBlock:^{
        [NSThread sleepForTimeInterval:1];
        NSLog(@"2 = %@", [NSThread currentThread]);
    }];
    NSBlockOperation *op3 = [NSBlockOperation blockOperationWithBlock:^{
        [NSThread sleepForTimeInterval:1];
        NSLog(@"3 = %@", [NSThread currentThread]);
    }];

    // 3.å°†ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­
    [queue addOperation:op1];
    [queue addOperation:op2];
    [queue addOperation:op3];   
}
@end
</code></pre>

<h3 id="äº”ã€NSOperationQueueçš„æš‚åœ-æ¢å¤-å–æ¶ˆ"><a href="#äº”ã€NSOperationQueueçš„æš‚åœ-æ¢å¤-å–æ¶ˆ" class="headerlink" title="äº”ã€NSOperationQueueçš„æš‚åœ-æ¢å¤-å–æ¶ˆ"></a>äº”ã€NSOperationQueueçš„æš‚åœ-æ¢å¤-å–æ¶ˆ</h3><blockquote>
<p>1ã€å–æ¶ˆé˜Ÿåˆ—çš„æ‰€æœ‰æ“ä½œ</p>
</blockquote>
<ul>
<li>ä¹Ÿå¯ä»¥è°ƒç”¨NSOperationçš„-(void)cancelæ–¹æ³•å–æ¶ˆå•ä¸ªæ“ä½œ</li>
<li>æ³¨æ„ç‚¹ï¼š<ul>
<li>ä»»åŠ¡åªè¦è¢«å–æ¶ˆ, å°±ä¸ä¼šå†æ¢å¤äº†</li>
<li>å–æ¶ˆä»»åŠ¡å’Œæš‚åœä»»åŠ¡ä¸€æ ·, ä¸ä¼šå–æ¶ˆå½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡, åªèƒ½å–æ¶ˆè¿˜æœªæ‰§è¡Œçš„ä»»åŠ¡<pre><code>-(void)cancelAllOperations;
</code></pre>

</li>
</ul>
</li>
</ul>
<blockquote>
<p>2ã€æš‚åœå’Œæ¢å¤é˜Ÿåˆ—</p>
</blockquote>
<ul>
<li>æ³¨æ„:<ul>
<li>1.å¦‚æœåœ¨ä»»åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­æš‚åœé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡, é‚£ä¹ˆå½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡å¹¶ä¸ä¼šè¢«æš‚åœ, è€Œæ˜¯ä¼šæš‚åœé˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªä»»åŠ¡</li>
<li>2.æ¢å¤ä»»åŠ¡, æ˜¯ä»é˜Ÿåˆ—ç¬¬ä¸€ä¸ªæ²¡æœ‰è¢«æ‰§è¡Œè¿‡çš„ä»»åŠ¡å¼€å§‹æ¢å¤<pre><code>-(void)setSuspended:(BOOL)b;//å¦‚æœæ˜¯YES, ä»£è¡¨éœ€è¦æš‚åœï¼ŒNOä»£è¡¨ä»£è¡¨ä¸éœ€è¦æš‚åœ ==  æ¢å¤æ‰§è¡Œ
-(BOOL)isSuspended;
</code></pre>

</li>
</ul>
</li>
</ul>
<h3 id="å…­ã€NSOperationQueueçº¿ç¨‹é—´é€šä¿¡"><a href="#å…­ã€NSOperationQueueçº¿ç¨‹é—´é€šä¿¡" class="headerlink" title="å…­ã€NSOperationQueueçº¿ç¨‹é—´é€šä¿¡"></a>å…­ã€NSOperationQueueçº¿ç¨‹é—´é€šä¿¡</h3><blockquote>
<p>å®ä¾‹ç¨‹åºï¼šå¼€å¯å­çº¿ç¨‹ä¸‹è½½å›¾ç‰‡ï¼Œä¸‹è½½å¥½å›¾ç‰‡åï¼Œå›åˆ°ä¸»çº¿ç¨‹è¿›è¡Œæ›´æ–°UI</p>
</blockquote>
<pre><code>#import "ViewController.h"

@interface ViewController ()
@property (weak, nonatomic) IBOutlet UIImageView *imageView;

@end

@implementation ViewController

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    // 1.å¼€å¯å­çº¿ç¨‹ä¸‹è½½å›¾ç‰‡
    NSOperationQueue *queue = [[NSOperationQueue alloc] init];
    [queue addOperationWithBlock:^{
     // å­çº¿ç¨‹
        NSString *urlStr = @"https://www.baidu.com/img/bd_logo1.png";
    // urlä¸­æ–‡ç¼–ç ï¼Œé˜²æ­¢ä¹±ç 
    // urlStr = [urlStr stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
        NSURL *url = [NSURL URLWithString:urlStr];
        NSData *data = [NSData dataWithContentsOfURL:url];
        // 2.ç”Ÿæˆä¸‹è½½å¥½çš„å›¾ç‰‡
        UIImage *image = [UIImage imageWithData:data];

        // 3.å›åˆ°ä¸»çº¿ç¨‹æ›´æ–°UI
        [[NSOperationQueue mainQueue] addOperationWithBlock:^{
            NSLog(@"æ›´æ–°UI");
           // ä¸»çº¿ç¨‹
            self.imageView.image = image;
        }];
    }];
}
@end
</code></pre>

<h3 id="ä¸ƒã€æ“ä½œä¾èµ–"><a href="#ä¸ƒã€æ“ä½œä¾èµ–" class="headerlink" title="ä¸ƒã€æ“ä½œä¾èµ–"></a>ä¸ƒã€æ“ä½œä¾èµ–</h3><ul>
<li>1ã€ç›®çš„ -&gt; NSOperationä¹‹é—´å¯ä»¥è®¾ç½®ä¾èµ–æ¥ä¿è¯æ‰§è¡Œé¡ºåº<ul>
<li>ä¾‹å¦‚ï¼šä¸€å®šè¦è®©æ“ä½œAæ‰§è¡Œå®Œåï¼Œæ‰èƒ½æ‰§è¡Œæ“ä½œBï¼Œå¯ä»¥è¿™ä¹ˆå†™</li>
</ul>
</li>
<li>åªè¦æ·»åŠ äº†ä¾èµ–, é‚£ä¹ˆå°±ä¼šç­‰ä¾èµ–çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•, æ‰ä¼šæ‰§è¡Œå½“å‰ä»»åŠ¡  <pre><code>[operationB addDependency:operationA];// æ“ä½œBä¾èµ–äºæ“ä½œA , Aæ“ä½œæ‰§è¡Œå®Œæ‰ä¼šæ‰§è¡Œæ“ä½œB</code></pre></li>
<li>2ã€é™¤äº†åŒä¸€quereæ“ä½œé—´å»ºç«‹ä¾èµ–å…³ç³»ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨ä¸åŒqueueçš„NSOperationä¹‹é—´åˆ›å»ºä¾èµ–å…³ç³»</li>
<li>æ³¨æ„ç‚¹ï¼š<ul>
<li>ä¸èƒ½ç›¸äº’ä¾èµ– -&gt; æ¯”å¦‚Aä¾èµ–Bï¼ŒBä¾èµ–A</li>
</ul>
</li>
</ul>
<blockquote>
<p>ç»å…¸å®ä¾‹ï¼šåˆæˆå›¾ç‰‡</p>
</blockquote>
<pre><code>#import "ViewController.h"

@interface ViewController ()
@property (weak, nonatomic) IBOutlet UIImageView *imageView;

@end

@implementation ViewController
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    NSOperationQueue *queue = [[NSOperationQueue alloc] init];
    NSOperationQueue *queue2 = [[NSOperationQueue alloc] init];

    __block UIImage *image1 = nil;
    __block UIImage *image2 = nil;
    // 1.å¼€å¯ä¸€ä¸ªçº¿ç¨‹ä¸‹è½½ç¬¬ä¸€å¼ å›¾ç‰‡
    NSOperation *op1 = [NSBlockOperation blockOperationWithBlock:^{
        NSURL *url = [NSURL URLWithString:@"http://cdn.cocimg.com/assets/images/logo.png?v=201510272"];
        NSData *data = [NSData dataWithContentsOfURL:url];
        // 2.ç”Ÿæˆä¸‹è½½å¥½çš„å›¾ç‰‡
        UIImage *image = [UIImage imageWithData:data];
        image1 = image;
    }];

    // 2.å¼€å¯ä¸€ä¸ªçº¿ç¨‹ä¸‹è½½ç¬¬äºŒé•¿å›¾ç‰‡
    NSOperation *op2 = [NSBlockOperation blockOperationWithBlock:^{
        NSURL *url = [NSURL URLWithString:@"https://www.baidu.com/img/bd_logo1.png"];
        NSData *data = [NSData dataWithContentsOfURL:url];
        // 2.ç”Ÿæˆä¸‹è½½å¥½çš„å›¾ç‰‡
        UIImage *image = [UIImage imageWithData:data];
        image2 = image;

    }];
    // 3.å¼€å¯ä¸€ä¸ªçº¿ç¨‹åˆæˆå›¾ç‰‡
    NSOperation *op3 = [NSBlockOperation blockOperationWithBlock:^{
        UIGraphicsBeginImageContext(CGSizeMake(200, 200));
        [image1 drawInRect:CGRectMake(0, 0, 100, 200)];
        [image2 drawInRect:CGRectMake(100, 0, 100, 200)];
        UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();

        // 4.å›åˆ°ä¸»çº¿ç¨‹æ›´æ–°UI
        [[NSOperationQueue mainQueue] addOperationWithBlock:^{
            NSLog(@"å›åˆ°ä¸»çº¿ç¨‹æ›´æ–°UI");
            self.imageView.image = newImage;
        }];
    }];


    // ç›‘å¬ä»»åŠ¡æ˜¯å¦æ‰§è¡Œå®Œæ¯•
    op1.completionBlock = ^{
        NSLog(@"ç¬¬ä¸€å¼ å›¾ç‰‡ä¸‹è½½å®Œæ¯•");
    };
    op2.completionBlock = ^{
        NSLog(@"ç¬¬äºŒå¼ å›¾ç‰‡ä¸‹è½½å®Œæ¯•");
    };

    // æ·»åŠ ä¾èµ–
    // åªè¦æ·»åŠ äº†ä¾èµ–, é‚£ä¹ˆå°±ä¼šç­‰ä¾èµ–çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•, æ‰ä¼šæ‰§è¡Œå½“å‰ä»»åŠ¡
    // æ³¨æ„:
    // 1.æ·»åŠ ä¾èµ–, ä¸èƒ½æ·»åŠ å¾ªç¯ä¾èµ–
    // 2.NSOperationå¯ä»¥è·¨é˜Ÿåˆ—æ·»åŠ ä¾èµ–
    [op3 addDependency:op1];
    [op3 addDependency:op2];

    // å°†ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­
    [queue addOperation:op1];
    [queue addOperation:op2];
    [queue2 addOperation:op3];
}
@end</code></pre>

]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[æ·±å…¥ReactiveCocoa]]></title>
      <url>http://yoursite.com/2016/03/12/%E6%B7%B1%E5%85%A5ReactiveCocoa/</url>
      <content type="html"><![CDATA[<p><a href="https://github.com/ReactiveCocoa/ReactiveCocoa" target="_blank" rel="external">ReactiveCocoa</a>(ç®€ç§°ä¸ºRAC),ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ç®€å•çš„å¯¹RACæœ‰ä¸ªåˆæ­¥çš„äº†è§£ï¼Œåœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å®é™…ç”¨åˆ°çš„åŸºæœ¬éƒ½æ˜¯ä¸Šä¸€ç¯‡æ‰€ä»‹ç»çš„çŸ¥è¯†ï¼Œè¿™ç¯‡æ–‡ç« æˆ‘ä»¬å¯¹RACæœ‰ä¸ªæ·±å…¥çš„äº†è§£ã€‚</p>
<a id="more"></a>
<h3 id="1-ReactiveCocoaå¸¸è§æ“ä½œæ–¹æ³•ä»‹ç»"><a href="#1-ReactiveCocoaå¸¸è§æ“ä½œæ–¹æ³•ä»‹ç»" class="headerlink" title="1.ReactiveCocoaå¸¸è§æ“ä½œæ–¹æ³•ä»‹ç»"></a>1.ReactiveCocoaå¸¸è§æ“ä½œæ–¹æ³•ä»‹ç»</h3><ul>
<li>1.1 ReactiveCocoaæ“ä½œé¡»çŸ¥<ul>
<li>æ‰€æœ‰çš„ä¿¡å·ï¼ˆRACSignalï¼‰éƒ½å¯ä»¥è¿›è¡Œæ“ä½œå¤„ç†ï¼Œå› ä¸ºæ‰€æœ‰æ“ä½œæ–¹æ³•éƒ½å®šä¹‰åœ¨RACStream.hä¸­ï¼Œè€ŒRACSignalç»§æ‰¿RACStreamã€‚</li>
</ul>
</li>
<li>1.2  ReactiveCocoaæ“ä½œæ€æƒ³<ul>
<li>è¿ç”¨çš„æ˜¯Hookï¼ˆé’©å­ï¼‰æ€æƒ³ï¼ŒHookæ˜¯ä¸€ç§ç”¨äºæ”¹å˜API(åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼šæ–¹æ³•)æ‰§è¡Œç»“æœçš„æŠ€æœ¯.</li>
<li>Hookç”¨å¤„ï¼šæˆªè·APIè°ƒç”¨çš„æŠ€æœ¯ã€‚</li>
<li>HookåŸç†ï¼šåœ¨æ¯æ¬¡è°ƒç”¨ä¸€ä¸ªAPIè¿”å›ç»“æœä¹‹å‰ï¼Œå…ˆæ‰§è¡Œä½ è‡ªå·±çš„æ–¹æ³•ï¼Œæ”¹å˜ç»“æœçš„è¾“å‡ºã€‚</li>
<li>RACå¼€å‘æ–¹å¼ï¼šRACä¸­æ ¸å¿ƒå¼€å‘æ–¹å¼ï¼Œä¹Ÿæ˜¯ç»‘å®šï¼Œä¹‹å‰çš„å¼€å‘æ–¹å¼æ˜¯èµ‹å€¼ï¼Œè€Œç”¨RACå¼€å‘ï¼Œåº”è¯¥æŠŠé‡å¿ƒæ”¾åœ¨ç»‘å®šï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åœ¨åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå°±ç»‘å®šå¥½ä»¥åæƒ³è¦åšçš„äº‹æƒ…ï¼Œè€Œä¸æ˜¯ç­‰èµ‹å€¼ä¹‹ååœ¨å»åšäº‹æƒ…ã€‚</li>
<li>åˆ—å¦‚ï¼šæŠŠæ•°æ®å±•ç¤ºåˆ°æ§ä»¶ä¸Šï¼Œä¹‹å‰éƒ½æ˜¯é‡å†™æ§ä»¶çš„setModelæ–¹æ³•ï¼Œç”¨RACå°±å¯ä»¥åœ¨ä¸€å¼€å§‹åˆ›å»ºæ§ä»¶çš„æ—¶å€™ï¼Œå°±ç»‘å®šå¥½æ•°æ®ã€‚</li>
</ul>
</li>
<li>1.3  ReactiveCocoaæ ¸å¿ƒæ–¹æ³•bind<ul>
<li>eactiveCocoaæ“ä½œçš„æ ¸å¿ƒæ–¹æ³•æ˜¯bindï¼ˆç»‘å®šï¼‰,ç»™RACä¸­çš„ä¿¡å·è¿›è¡Œç»‘å®šï¼Œåªè¦ä¿¡å·ä¸€å‘é€æ•°æ®ï¼Œå°±èƒ½ç›‘å¬åˆ°ï¼Œä»è€ŒæŠŠå‘é€æ•°æ®æ”¹æˆè‡ªå·±æƒ³è¦çš„æ•°æ®ã€‚</li>
<li>åœ¨å¼€å‘ä¸­å¾ˆå°‘ä½¿ç”¨bindæ–¹æ³•ï¼Œbindå±äºRACä¸­çš„åº•å±‚æ–¹æ³•ï¼ŒRACå·²ç»å°è£…äº†å¾ˆå¤šå¥½ç”¨çš„å…¶ä»–æ–¹æ³•ï¼Œåº•å±‚éƒ½æ˜¯è°ƒç”¨bindï¼Œç”¨æ³•æ¯”bindç®€å•.</li>
<li><code>bind</code>æ–¹æ³•ç®€å•ä»‹ç»å’Œä½¿ç”¨ã€‚</li>
</ul>
</li>
</ul>
<pre><code>
    // å‡è®¾æƒ³ç›‘å¬æ–‡æœ¬æ¡†çš„å†…å®¹ï¼Œå¹¶ä¸”åœ¨æ¯æ¬¡è¾“å‡ºç»“æœçš„æ—¶å€™ï¼Œéƒ½åœ¨æ–‡æœ¬æ¡†çš„å†…å®¹æ‹¼æ¥ä¸€æ®µæ–‡å­—â€œè¾“å‡ºï¼šâ€            
    // æ–¹å¼ä¸€:åœ¨è¿”å›ç»“æœåï¼Œæ‹¼æ¥ã€‚
        [_textField.rac_textSignal subscribeNext:^(id x) {
            NSLog(@"è¾“å‡º:%@",x);
        }];

    // æ–¹å¼äºŒ:åœ¨è¿”å›ç»“æœå‰ï¼Œæ‹¼æ¥ï¼Œä½¿ç”¨RACä¸­bindæ–¹æ³•åšå¤„ç†ã€‚
    // bindæ–¹æ³•å‚æ•°:éœ€è¦ä¼ å…¥ä¸€ä¸ªè¿”å›å€¼æ˜¯RACStreamBindBlockçš„blockå‚æ•°
    // RACStreamBindBlockæ˜¯ä¸€ä¸ªblockçš„ç±»å‹ï¼Œè¿”å›å€¼æ˜¯ä¿¡å·ï¼Œå‚æ•°ï¼ˆvalue,stopï¼‰ï¼Œå› æ­¤å‚æ•°çš„blockè¿”å›å€¼ä¹Ÿæ˜¯ä¸€ä¸ªblockã€‚

    // RACStreamBindBlock:
    // å‚æ•°ä¸€(value):è¡¨ç¤ºæ¥æ”¶åˆ°ä¿¡å·çš„åŸå§‹å€¼ï¼Œè¿˜æ²¡åšå¤„ç†
    // å‚æ•°äºŒ(*stop):ç”¨æ¥æ§åˆ¶ç»‘å®šBlockï¼Œå¦‚æœ*stop = yes,é‚£ä¹ˆå°±ä¼šç»“æŸç»‘å®šã€‚
    // è¿”å›å€¼ï¼šä¿¡å·ï¼Œåšå¥½å¤„ç†ï¼Œåœ¨é€šè¿‡è¿™ä¸ªä¿¡å·è¿”å›å‡ºå»ï¼Œä¸€èˆ¬ä½¿ç”¨RACReturnSignal,éœ€è¦æ‰‹åŠ¨å¯¼å…¥å¤´æ–‡ä»¶RACReturnSignal.hã€‚

    // bindæ–¹æ³•ä½¿ç”¨æ­¥éª¤:
    // 1.ä¼ å…¥ä¸€ä¸ªè¿”å›å€¼RACStreamBindBlockçš„blockã€‚
    // 2.æè¿°ä¸€ä¸ªRACStreamBindBlockç±»å‹çš„bindBlockä½œä¸ºblockçš„è¿”å›å€¼ã€‚
    // 3.æè¿°ä¸€ä¸ªè¿”å›ç»“æœçš„ä¿¡å·ï¼Œä½œä¸ºbindBlockçš„è¿”å›å€¼ã€‚
    // æ³¨æ„ï¼šåœ¨bindBlockä¸­åšä¿¡å·ç»“æœçš„å¤„ç†ã€‚

    // åº•å±‚å®ç°:
    // 1.æºä¿¡å·è°ƒç”¨bind,ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªç»‘å®šä¿¡å·ã€‚
    // 2.å½“ç»‘å®šä¿¡å·è¢«è®¢é˜…ï¼Œå°±ä¼šè°ƒç”¨ç»‘å®šä¿¡å·ä¸­çš„didSubscribeï¼Œç”Ÿæˆä¸€ä¸ªbindingBlockã€‚
    // 3.å½“æºä¿¡å·æœ‰å†…å®¹å‘å‡ºï¼Œå°±ä¼šæŠŠå†…å®¹ä¼ é€’åˆ°bindingBlockå¤„ç†ï¼Œè°ƒç”¨bindingBlock(value,stop)
    // 4.è°ƒç”¨bindingBlock(value,stop)ï¼Œä¼šè¿”å›ä¸€ä¸ªå†…å®¹å¤„ç†å®Œæˆçš„ä¿¡å·ï¼ˆRACReturnSignalï¼‰ã€‚
    // 5.è®¢é˜…RACReturnSignalï¼Œå°±ä¼šæ‹¿åˆ°ç»‘å®šä¿¡å·çš„è®¢é˜…è€…ï¼ŒæŠŠå¤„ç†å®Œæˆçš„ä¿¡å·å†…å®¹å‘é€å‡ºæ¥ã€‚

    // æ³¨æ„:ä¸åŒè®¢é˜…è€…ï¼Œä¿å­˜ä¸åŒçš„nextBlockï¼Œçœ‹æºç çš„æ—¶å€™ï¼Œä¸€å®šè¦çœ‹æ¸…æ¥šè®¢é˜…è€…æ˜¯å“ªä¸ªã€‚
    // è¿™é‡Œéœ€è¦æ‰‹åŠ¨å¯¼å…¥#import <reactivecocoa racreturnsignal.h="">ï¼Œæ‰èƒ½ä½¿ç”¨RACReturnSignalã€‚

    [[_textField.rac_textSignal bind:^RACStreamBindBlock{

        // ä»€ä¹ˆæ—¶å€™è°ƒç”¨:
        // blockä½œç”¨:è¡¨ç¤ºç»‘å®šäº†ä¸€ä¸ªä¿¡å·.

        return ^RACStream *(id value, BOOL *stop){

            // ä»€ä¹ˆæ—¶å€™è°ƒç”¨block:å½“ä¿¡å·æœ‰æ–°çš„å€¼å‘å‡ºï¼Œå°±ä¼šæ¥åˆ°è¿™ä¸ªblockã€‚

            // blockä½œç”¨:åšè¿”å›å€¼çš„å¤„ç†

            // åšå¥½å¤„ç†ï¼Œé€šè¿‡ä¿¡å·è¿”å›å‡ºå».
            return [RACReturnSignal return:[NSString stringWithFormat:@"è¾“å‡º:%@",value]];
        };

    }] subscribeNext:^(id x) {

        NSLog(@"%@",x);

    }];
</reactivecocoa></code></pre>

<ul>
<li>1.4 ReactiveCocoaæ“ä½œæ–¹æ³•ä¹‹æ˜ å°„(flattenMap,Map)<ul>
<li><code>flattenMap</code>ï¼Œ<code>Map</code> ç”¨äºæŠŠæºä¿¡å·å†…å®¹æ˜ å°„æˆæ–°çš„å†…å®¹ã€‚</li>
</ul>
</li>
</ul>
<p><code>flattenMap</code> ç®€å•ä½¿ç”¨</p>
<pre><code>
    // ç›‘å¬æ–‡æœ¬æ¡†çš„å†…å®¹æ”¹å˜ï¼ŒæŠŠç»“æ„é‡æ–°æ˜ å°„æˆä¸€ä¸ªæ–°å€¼.

    // flattenMapä½œç”¨:æŠŠæºä¿¡å·çš„å†…å®¹æ˜ å°„æˆä¸€ä¸ªæ–°çš„ä¿¡å·ï¼Œä¿¡å·å¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚

    // flattenMapä½¿ç”¨æ­¥éª¤:
    // 1.ä¼ å…¥ä¸€ä¸ªblockï¼Œblockç±»å‹æ˜¯è¿”å›å€¼RACStreamï¼Œå‚æ•°value
    // 2.å‚æ•°valueå°±æ˜¯æºä¿¡å·çš„å†…å®¹ï¼Œæ‹¿åˆ°æºä¿¡å·çš„å†…å®¹åšå¤„ç†
    // 3.åŒ…è£…æˆRACReturnSignalä¿¡å·ï¼Œè¿”å›å‡ºå»ã€‚

    // flattenMapåº•å±‚å®ç°:
    // 0.flattenMapå†…éƒ¨è°ƒç”¨bindæ–¹æ³•å®ç°çš„,flattenMapä¸­blockçš„è¿”å›å€¼ï¼Œä¼šä½œä¸ºbindä¸­bindBlockçš„è¿”å›å€¼ã€‚
    // 1.å½“è®¢é˜…ç»‘å®šä¿¡å·ï¼Œå°±ä¼šç”ŸæˆbindBlockã€‚
    // 2.å½“æºä¿¡å·å‘é€å†…å®¹ï¼Œå°±ä¼šè°ƒç”¨bindBlock(value, *stop)
    // 3.è°ƒç”¨bindBlockï¼Œå†…éƒ¨å°±ä¼šè°ƒç”¨flattenMapçš„blockï¼ŒflattenMapçš„blockä½œç”¨ï¼šå°±æ˜¯æŠŠå¤„ç†å¥½çš„æ•°æ®åŒ…è£…æˆä¿¡å·ã€‚
    // 4.è¿”å›çš„ä¿¡å·æœ€ç»ˆä¼šä½œä¸ºbindBlockä¸­çš„è¿”å›ä¿¡å·ï¼Œå½“åšbindBlockçš„è¿”å›ä¿¡å·ã€‚
    // 5.è®¢é˜…bindBlockçš„è¿”å›ä¿¡å·ï¼Œå°±ä¼šæ‹¿åˆ°ç»‘å®šä¿¡å·çš„è®¢é˜…è€…ï¼ŒæŠŠå¤„ç†å®Œæˆçš„ä¿¡å·å†…å®¹å‘é€å‡ºæ¥ã€‚



    [[_textField.rac_textSignal flattenMap:^RACStream *(id value) {

    // blockä»€ä¹ˆæ—¶å€™ : æºä¿¡å·å‘å‡ºçš„æ—¶å€™ï¼Œå°±ä¼šè°ƒç”¨è¿™ä¸ªblockã€‚

    // blockä½œç”¨ : æ”¹å˜æºä¿¡å·çš„å†…å®¹ã€‚

    // è¿”å›å€¼ï¼šç»‘å®šä¿¡å·çš„å†…å®¹.
    return [RACReturnSignal return:[NSString stringWithFormat:@"è¾“å‡º:%@",value]];

    }] subscribeNext:^(id x) {

    // è®¢é˜…ç»‘å®šä¿¡å·ï¼Œæ¯å½“æºä¿¡å·å‘é€å†…å®¹ï¼Œåšå®Œå¤„ç†ï¼Œå°±ä¼šè°ƒç”¨è¿™ä¸ªblockã€‚

    NSLog(@"%@",x);

    }];
</code></pre>

<p><code>Map</code> ç®€å•ä½¿ç”¨:</p>
<pre><code>
    // ç›‘å¬æ–‡æœ¬æ¡†çš„å†…å®¹æ”¹å˜ï¼ŒæŠŠç»“æ„é‡æ–°æ˜ å°„æˆä¸€ä¸ªæ–°å€¼.

    // Mapä½œç”¨:æŠŠæºä¿¡å·çš„å€¼æ˜ å°„æˆä¸€ä¸ªæ–°çš„å€¼

    // Mapä½¿ç”¨æ­¥éª¤:
    // 1.ä¼ å…¥ä¸€ä¸ªblock,ç±»å‹æ˜¯è¿”å›å¯¹è±¡ï¼Œå‚æ•°æ˜¯value
    // 2.valueå°±æ˜¯æºä¿¡å·çš„å†…å®¹ï¼Œç›´æ¥æ‹¿åˆ°æºä¿¡å·çš„å†…å®¹åšå¤„ç†
    // 3.æŠŠå¤„ç†å¥½çš„å†…å®¹ï¼Œç›´æ¥è¿”å›å°±å¥½äº†ï¼Œä¸ç”¨åŒ…è£…æˆä¿¡å·ï¼Œè¿”å›çš„å€¼ï¼Œå°±æ˜¯æ˜ å°„çš„å€¼ã€‚

    // Mapåº•å±‚å®ç°:
    // 0.Mapåº•å±‚å…¶å®æ˜¯è°ƒç”¨flatternMap,Mapä¸­blockä¸­çš„è¿”å›çš„å€¼ä¼šä½œä¸ºflatternMapä¸­blockä¸­çš„å€¼ã€‚
    // 1.å½“è®¢é˜…ç»‘å®šä¿¡å·ï¼Œå°±ä¼šç”ŸæˆbindBlockã€‚
    // 3.å½“æºä¿¡å·å‘é€å†…å®¹ï¼Œå°±ä¼šè°ƒç”¨bindBlock(value, *stop)
    // 4.è°ƒç”¨bindBlockï¼Œå†…éƒ¨å°±ä¼šè°ƒç”¨flattenMapçš„block
    // 5.flattenMapçš„blockå†…éƒ¨ä¼šè°ƒç”¨Mapä¸­çš„blockï¼ŒæŠŠMapä¸­çš„blockè¿”å›çš„å†…å®¹åŒ…è£…æˆè¿”å›çš„ä¿¡å·ã€‚
    // 5.è¿”å›çš„ä¿¡å·æœ€ç»ˆä¼šä½œä¸ºbindBlockä¸­çš„è¿”å›ä¿¡å·ï¼Œå½“åšbindBlockçš„è¿”å›ä¿¡å·ã€‚
    // 6.è®¢é˜…bindBlockçš„è¿”å›ä¿¡å·ï¼Œå°±ä¼šæ‹¿åˆ°ç»‘å®šä¿¡å·çš„è®¢é˜…è€…ï¼ŒæŠŠå¤„ç†å®Œæˆçš„ä¿¡å·å†…å®¹å‘é€å‡ºæ¥ã€‚

    [[_textField.rac_textSignal map:^id(id value) {
        // å½“æºä¿¡å·å‘å‡ºï¼Œå°±ä¼šè°ƒç”¨è¿™ä¸ªblockï¼Œä¿®æ”¹æºä¿¡å·çš„å†…å®¹
        // è¿”å›å€¼ï¼šå°±æ˜¯å¤„ç†å®Œæºä¿¡å·çš„å†…å®¹ã€‚
        return [NSString stringWithFormat:@"è¾“å‡º:%@",value];
    }] subscribeNext:^(id x) {

        NSLog(@"%@",x);
    }];
</code></pre>


<ul>
<li><p><code>FlatternMap</code>å’Œ<code>Map</code>çš„åŒºåˆ«</p>
<ul>
<li>1.FlatternMapä¸­çš„Blockè¿”å›ä¿¡å·ã€‚</li>
<li>2.Mapä¸­çš„Blockè¿”å›å¯¹è±¡ã€‚</li>
<li>3.å¼€å‘ä¸­ï¼Œå¦‚æœä¿¡å·å‘å‡ºçš„å€¼ä¸æ˜¯ä¿¡å·ï¼Œæ˜ å°„ä¸€èˆ¬ä½¿ç”¨Map</li>
<li>4.å¼€å‘ä¸­ï¼Œå¦‚æœä¿¡å·å‘å‡ºçš„å€¼æ˜¯ä¿¡å·ï¼Œæ˜ å°„ä¸€èˆ¬ä½¿ç”¨FlatternMapã€‚</li>
</ul>
</li>
<li><p><code>æ€»ç»“</code>ï¼šsignalOfsignalsç”¨FlatternMapã€‚</p>
</li>
</ul>
<pre><code>
    // åˆ›å»ºä¿¡å·ä¸­çš„ä¿¡å·
    RACSubject *signalOfsignals = [RACSubject subject];
    RACSubject *signal = [RACSubject subject];

    [[signalOfsignals flattenMap:^RACStream *(id value) {

     // å½“signalOfsignalsçš„signalså‘å‡ºä¿¡å·æ‰ä¼šè°ƒç”¨

        return value;

    }] subscribeNext:^(id x) {

        // åªæœ‰signalOfsignalsçš„signalå‘å‡ºä¿¡å·æ‰ä¼šè°ƒç”¨ï¼Œå› ä¸ºå†…éƒ¨è®¢é˜…äº†bindBlockä¸­è¿”å›çš„ä¿¡å·ï¼Œä¹Ÿå°±æ˜¯flattenMapè¿”å›çš„ä¿¡å·ã€‚
        // ä¹Ÿå°±æ˜¯flattenMapè¿”å›çš„ä¿¡å·å‘å‡ºå†…å®¹ï¼Œæ‰ä¼šè°ƒç”¨ã€‚

        NSLog(@"%@aaa",x);
    }];

    // ä¿¡å·çš„ä¿¡å·å‘é€ä¿¡å·
    [signalOfsignals sendNext:signal];

    // ä¿¡å·å‘é€å†…å®¹
    [signal sendNext:@1];
</code></pre>

<ul>
<li><p>1.5 ReactiveCocoaæ“ä½œæ–¹æ³•ä¹‹ç»„åˆã€‚</p>
<ul>
<li><p><code>concat</code>:æŒ‰ä¸€å®šé¡ºåºæ‹¼æ¥ä¿¡å·ï¼Œå½“å¤šä¸ªä¿¡å·å‘å‡ºçš„æ—¶å€™ï¼Œæœ‰é¡ºåºçš„æ¥æ”¶ä¿¡å·ã€‚</p>
<pre><code>
RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
  [subscriber sendNext:@1];
  [subscriber sendCompleted];
  return nil;
}];
RACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
  [subscriber sendNext:@2];
  return nil;
}];
// æŠŠsignalAæ‹¼æ¥åˆ°signalBåï¼ŒsignalAå‘é€å®Œæˆï¼ŒsignalBæ‰ä¼šè¢«æ¿€æ´»ã€‚
RACSignal *concatSignal = [signalA concat:signalB];
// ä»¥ååªéœ€è¦é¢å¯¹æ‹¼æ¥ä¿¡å·å¼€å‘ã€‚
// è®¢é˜…æ‹¼æ¥çš„ä¿¡å·ï¼Œä¸éœ€è¦å•ç‹¬è®¢é˜…signalAï¼ŒsignalB
// å†…éƒ¨ä¼šè‡ªåŠ¨è®¢é˜…ã€‚
// æ³¨æ„ï¼šç¬¬ä¸€ä¸ªä¿¡å·å¿…é¡»å‘é€å®Œæˆï¼Œç¬¬äºŒä¸ªä¿¡å·æ‰ä¼šè¢«æ¿€æ´»
[concatSignal subscribeNext:^(id x) {
  NSLog(@"%@",x);
}];
// concatåº•å±‚å®ç°:
// 1.å½“æ‹¼æ¥ä¿¡å·è¢«è®¢é˜…ï¼Œå°±ä¼šè°ƒç”¨æ‹¼æ¥ä¿¡å·çš„didSubscribe
// 2.didSubscribeä¸­ï¼Œä¼šå…ˆè®¢é˜…ç¬¬ä¸€ä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰
// 3.ä¼šæ‰§è¡Œç¬¬ä¸€ä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰çš„didSubscribe
// 4.ç¬¬ä¸€ä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰didSubscribeä¸­å‘é€å€¼ï¼Œå°±ä¼šè°ƒç”¨ç¬¬ä¸€ä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰è®¢é˜…è€…çš„nextBlock,é€šè¿‡æ‹¼æ¥ä¿¡å·çš„è®¢é˜…è€…æŠŠå€¼å‘é€å‡ºæ¥.
// 5.ç¬¬ä¸€ä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰didSubscribeä¸­å‘é€å®Œæˆï¼Œå°±ä¼šè°ƒç”¨ç¬¬ä¸€ä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰è®¢é˜…è€…çš„completedBlock,è®¢é˜…ç¬¬äºŒä¸ªæºä¿¡å·ï¼ˆsignalBï¼‰è¿™æ—¶å€™æ‰æ¿€æ´»ï¼ˆsignalBï¼‰ã€‚
// 6.è®¢é˜…ç¬¬äºŒä¸ªæºä¿¡å·ï¼ˆsignalBï¼‰,æ‰§è¡Œç¬¬äºŒä¸ªæºä¿¡å·ï¼ˆsignalBï¼‰çš„didSubscribe
// 7.ç¬¬äºŒä¸ªæºä¿¡å·ï¼ˆsignalAï¼‰didSubscribeä¸­å‘é€å€¼,å°±ä¼šé€šè¿‡æ‹¼æ¥ä¿¡å·çš„è®¢é˜…è€…æŠŠå€¼å‘é€å‡ºæ¥.
</racsubscriber></racsubscriber></code></pre>
</li>
<li><p><code>then</code>:ç”¨äºè¿æ¥ä¸¤ä¸ªä¿¡å·ï¼Œå½“ç¬¬ä¸€ä¸ªä¿¡å·å®Œæˆï¼Œæ‰ä¼šè¿æ¥thenè¿”å›çš„ä¿¡å·ã€‚</p>
<pre><code>
// then:ç”¨äºè¿æ¥ä¸¤ä¸ªä¿¡å·ï¼Œå½“ç¬¬ä¸€ä¸ªä¿¡å·å®Œæˆï¼Œæ‰ä¼šè¿æ¥thenè¿”å›çš„ä¿¡å·
// æ³¨æ„ä½¿ç”¨thenï¼Œä¹‹å‰ä¿¡å·çš„å€¼ä¼šè¢«å¿½ç•¥æ‰.
// åº•å±‚å®ç°ï¼š1ã€å…ˆè¿‡æ»¤æ‰ä¹‹å‰çš„ä¿¡å·å‘å‡ºçš„å€¼ã€‚2.ä½¿ç”¨concatè¿æ¥thenè¿”å›çš„ä¿¡å·
[[[RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
  [subscriber sendNext:@1];
  [subscriber sendCompleted];
  return nil;
}] then:^RACSignal *{
  return [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
      [subscriber sendNext:@2];
      return nil;
  }];
}] subscribeNext:^(id x) {
  // åªèƒ½æ¥æ”¶åˆ°ç¬¬äºŒä¸ªä¿¡å·çš„å€¼ï¼Œä¹Ÿå°±æ˜¯thenè¿”å›ä¿¡å·çš„å€¼
  NSLog(@"%@",x);
}];
</racsubscriber></racsubscriber></code></pre>
</li>
<li><p><code>merge</code>:æŠŠå¤šä¸ªä¿¡å·åˆå¹¶ä¸ºä¸€ä¸ªä¿¡å·ï¼Œä»»ä½•ä¸€ä¸ªä¿¡å·æœ‰æ–°å€¼çš„æ—¶å€™å°±ä¼šè°ƒç”¨.</p>
<pre><code>
// merge:æŠŠå¤šä¸ªä¿¡å·åˆå¹¶æˆä¸€ä¸ªä¿¡å·
//åˆ›å»ºå¤šä¸ªä¿¡å·
RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
  [subscriber sendNext:@1];
  return nil;
}];
RACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
  [subscriber sendNext:@2];
  return nil;
}];
// åˆå¹¶ä¿¡å·,ä»»ä½•ä¸€ä¸ªä¿¡å·å‘é€æ•°æ®ï¼Œéƒ½èƒ½ç›‘å¬åˆ°.
RACSignal *mergeSignal = [signalA merge:signalB];
[mergeSignal subscribeNext:^(id x) {
  NSLog(@"%@",x);
}];
// åº•å±‚å®ç°ï¼š
// 1.åˆå¹¶ä¿¡å·è¢«è®¢é˜…çš„æ—¶å€™ï¼Œå°±ä¼šéå†æ‰€æœ‰ä¿¡å·ï¼Œå¹¶ä¸”å‘å‡ºè¿™äº›ä¿¡å·ã€‚
// 2.æ¯å‘å‡ºä¸€ä¸ªä¿¡å·ï¼Œè¿™ä¸ªä¿¡å·å°±ä¼šè¢«è®¢é˜…
// 3.ä¹Ÿå°±æ˜¯åˆå¹¶ä¿¡å·ä¸€è¢«è®¢é˜…ï¼Œå°±ä¼šè®¢é˜…é‡Œé¢æ‰€æœ‰çš„ä¿¡å·ã€‚
// 4.åªè¦æœ‰ä¸€ä¸ªä¿¡å·è¢«å‘å‡ºå°±ä¼šè¢«ç›‘å¬ã€‚
</racsubscriber></racsubscriber></code></pre>
</li>
<li><p><code>zipWith</code>:æŠŠä¸¤ä¸ªä¿¡å·å‹ç¼©æˆä¸€ä¸ªä¿¡å·ï¼Œåªæœ‰å½“ä¸¤ä¸ªä¿¡å·åŒæ—¶å‘å‡ºä¿¡å·å†…å®¹æ—¶ï¼Œå¹¶ä¸”æŠŠä¸¤ä¸ªä¿¡å·çš„å†…å®¹åˆå¹¶æˆä¸€ä¸ªå…ƒç»„ï¼Œæ‰ä¼šè§¦å‘å‹ç¼©æµçš„nextäº‹ä»¶ã€‚</p>
<pre><code>
RACSignal *signalA = [RACSignal createSignal:^RACDisposable*(id<racsubscriber> subscriber) {
  [subscriber sendNext:@1];
  return nil;
}];
RACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
  [subscriber sendNext:@2];
  return nil;
}];
// å‹ç¼©ä¿¡å·Aï¼Œä¿¡å·B
RACSignal *zipSignal = [signalA zipWith:signalB];
[zipSignal subscribeNext:^(id x) {
  NSLog(@"%@",x);
}];
// åº•å±‚å®ç°:
// 1.å®šä¹‰å‹ç¼©ä¿¡å·ï¼Œå†…éƒ¨å°±ä¼šè‡ªåŠ¨è®¢é˜…signalAï¼ŒsignalB
// 2.æ¯å½“signalAæˆ–è€…signalBå‘å‡ºä¿¡å·ï¼Œå°±ä¼šåˆ¤æ–­signalAï¼ŒsignalBæœ‰æ²¡æœ‰å‘å‡ºä¸ªä¿¡å·ï¼Œæœ‰å°±ä¼šæŠŠæœ€è¿‘å‘å‡ºçš„ä¿¡å·éƒ½åŒ…è£…æˆå…ƒç»„å‘å‡ºã€‚
</racsubscriber></racsubscriber></code></pre>
</li>
<li><p><code>combineLatest</code>:å°†å¤šä¸ªä¿¡å·åˆå¹¶èµ·æ¥ï¼Œå¹¶ä¸”æ‹¿åˆ°å„ä¸ªä¿¡å·çš„æœ€æ–°çš„å€¼,å¿…é¡»æ¯ä¸ªåˆå¹¶çš„signalè‡³å°‘éƒ½æœ‰è¿‡ä¸€æ¬¡sendNextï¼Œæ‰ä¼šè§¦å‘åˆå¹¶çš„ä¿¡å·ã€‚</p>
<pre><code>
RACSignal *signalA = [RACSignal createSignal:^RACDisposable*(id<racsubscriber> subscriber) {
  [subscriber sendNext:@1];
  return nil;
}];
RACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
  [subscriber sendNext:@2];
  return nil;
}];
// æŠŠä¸¤ä¸ªä¿¡å·ç»„åˆæˆä¸€ä¸ªä¿¡å·,è·Ÿzipä¸€æ ·ï¼Œæ²¡ä»€ä¹ˆåŒºåˆ«
RACSignal *combineSignal = [signalA combineLatestWith:signalB];
[combineSignal subscribeNext:^(id x) {
  NSLog(@"%@",x);
}];
// åº•å±‚å®ç°ï¼š
// 1.å½“ç»„åˆä¿¡å·è¢«è®¢é˜…ï¼Œå†…éƒ¨ä¼šè‡ªåŠ¨è®¢é˜…signalAï¼ŒsignalB,å¿…é¡»ä¸¤ä¸ªä¿¡å·éƒ½å‘å‡ºå†…å®¹ï¼Œæ‰ä¼šè¢«è§¦å‘ã€‚
// 2.å¹¶ä¸”æŠŠä¸¤ä¸ªä¿¡å·ç»„åˆæˆå…ƒç»„å‘å‡ºã€‚
</racsubscriber></racsubscriber></code></pre>
</li>
<li><p><code>reduce</code>èšåˆ:ç”¨äºä¿¡å·å‘å‡ºçš„å†…å®¹æ˜¯å…ƒç»„ï¼ŒæŠŠä¿¡å·å‘å‡ºå…ƒç»„çš„å€¼èšåˆæˆä¸€ä¸ªå€¼</p>
<pre><code>
RACSignal *signalA = [RACSignal createSignal:^RACDisposable*(id<racsubscriber> subscriber) {
  [subscriber sendNext:@1];
  return nil;
}];
RACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
  [subscriber sendNext:@2];
  return nil;
}];
// èšåˆ
// å¸¸è§çš„ç”¨æ³•ï¼Œï¼ˆå…ˆç»„åˆåœ¨èšåˆï¼‰ã€‚combineLatest:(id<nsfastenumeration>)signals reduce:(id (^)())reduceBlock
// reduceä¸­çš„blockç®€ä»‹:
// reduceblcokä¸­çš„å‚æ•°ï¼Œæœ‰å¤šå°‘ä¿¡å·ç»„åˆï¼Œreduceblcokå°±æœ‰å¤šå°‘å‚æ•°ï¼Œæ¯ä¸ªå‚æ•°å°±æ˜¯ä¹‹å‰ä¿¡å·å‘å‡ºçš„å†…å®¹
// reduceblcokçš„è¿”å›å€¼ï¼šèšåˆä¿¡å·ä¹‹åçš„å†…å®¹ã€‚
RACSignal *reduceSignal = [RACSignal combineLatest:@[signalA,signalB] reduce:^id(NSNumber *num1 ,NSNumber *num2){
 return [NSString stringWithFormat:@"%@ %@",num1,num2];
}];
[reduceSignal subscribeNext:^(id x) {

  NSLog(@"%@",x);
}];
// åº•å±‚å®ç°:
// 1.è®¢é˜…èšåˆä¿¡å·ï¼Œæ¯æ¬¡æœ‰å†…å®¹å‘å‡ºï¼Œå°±ä¼šæ‰§è¡Œreduceblcokï¼ŒæŠŠä¿¡å·å†…å®¹è½¬æ¢æˆreduceblcokè¿”å›çš„å€¼ã€‚
</nsfastenumeration></racsubscriber></racsubscriber></code></pre>
</li>
</ul>
</li>
<li><p>1.6 ReactiveCocoaæ“ä½œæ–¹æ³•ä¹‹è¿‡æ»¤ã€‚    </p>
<ul>
<li><p><code>filter</code>:è¿‡æ»¤ä¿¡å·ï¼Œä½¿ç”¨å®ƒå¯ä»¥è·å–æ»¡è¶³æ¡ä»¶çš„ä¿¡å·.</p>
<pre><code>
// è¿‡æ»¤:
// æ¯æ¬¡ä¿¡å·å‘å‡ºï¼Œä¼šå…ˆæ‰§è¡Œè¿‡æ»¤æ¡ä»¶åˆ¤æ–­.
[_textField.rac_textSignal filter:^BOOL(NSString *value) {
    return value.length > 3;
}];
</code></pre>
</li>
<li><p><code>ignore</code>:å¿½ç•¥å®ŒæŸäº›å€¼çš„ä¿¡å·. </p>
<pre><code>
// å†…éƒ¨è°ƒç”¨filterè¿‡æ»¤ï¼Œå¿½ç•¥æ‰ignoreçš„å€¼
[[_textField.rac_textSignal ignore:@"1"] subscribeNext:^(id x) {
NSLog(@"%@",x);
}];
</code></pre>
</li>
<li><p><code>distinctUntilChanged</code>:å½“ä¸Šä¸€æ¬¡çš„å€¼å’Œå½“å‰çš„å€¼æœ‰æ˜æ˜¾çš„å˜åŒ–å°±ä¼šå‘å‡ºä¿¡å·ï¼Œå¦åˆ™ä¼šè¢«å¿½ç•¥æ‰ã€‚</p>
<pre><code>
// è¿‡æ»¤ï¼Œå½“ä¸Šä¸€æ¬¡å’Œå½“å‰çš„å€¼ä¸ä¸€æ ·ï¼Œå°±ä¼šå‘å‡ºå†…å®¹ã€‚
// åœ¨å¼€å‘ä¸­ï¼Œåˆ·æ–°UIç»å¸¸ä½¿ç”¨ï¼Œåªæœ‰ä¸¤æ¬¡æ•°æ®ä¸ä¸€æ ·æ‰éœ€è¦åˆ·æ–°
[[_textField.rac_textSignal distinctUntilChanged] subscribeNext:^(id x) {
NSLog(@"%@",x);
}];
</code></pre>
</li>
<li><p><code>take</code>:ä»å¼€å§‹ä¸€å…±å–Næ¬¡çš„ä¿¡å·</p>
<pre><code>
   // 1ã€åˆ›å»ºä¿¡å·
  RACSubject *signal = [RACSubject subject];
  // 2ã€å¤„ç†ä¿¡å·ï¼Œè®¢é˜…ä¿¡å·
  [[signal takeLast:1] subscribeNext:^(id x) {
    NSLog(@"%@",x);
  }];
  // 3.å‘é€ä¿¡å·
  [signal sendNext:@1];
  [signal sendNext:@2];
  [signal sendCompleted];
</code></pre>
</li>
<li><p><code>skip</code>:(NSUInteger):è·³è¿‡å‡ ä¸ªä¿¡å·,ä¸æ¥å—ã€‚</p>
<pre><code>
   // è¡¨ç¤ºè¾“å…¥ç¬¬ä¸€æ¬¡ï¼Œä¸ä¼šè¢«ç›‘å¬åˆ°ï¼Œè·³è¿‡ç¬¬ä¸€æ¬¡å‘å‡ºçš„ä¿¡å·
    [[_textField.rac_textSignal skip:1] subscribeNext:^(id x) {
        NSLog(@"%@",x);
    }];
</code></pre>
</li>
<li><p><code>switchToLatest</code>:ç”¨äºsignalOfSignalsï¼ˆä¿¡å·çš„ä¿¡å·ï¼‰ï¼Œæœ‰æ—¶å€™ä¿¡å·ä¹Ÿä¼šå‘å‡ºä¿¡å·ï¼Œä¼šåœ¨signalOfSignalsä¸­ï¼Œè·å–signalOfSignalså‘é€çš„æœ€æ–°ä¿¡å·ã€‚</p>
<pre><code>
   RACSubject *signalOfSignals = [RACSubject subject];
  RACSubject *signal = [RACSubject subject];
  [signalOfSignals sendNext:signal];
  [signal sendNext:@1];
  // è·å–ä¿¡å·ä¸­ä¿¡å·æœ€è¿‘å‘å‡ºä¿¡å·ï¼Œè®¢é˜…æœ€è¿‘å‘å‡ºçš„ä¿¡å·ã€‚
  // æ³¨æ„switchToLatestï¼šåªèƒ½ç”¨äºä¿¡å·ä¸­çš„ä¿¡å·
  [signalOfSignals.switchToLatest subscribeNext:^(id x) {
   NSLog(@"%@",x);
  }];
</code></pre>
</li>
</ul>
</li>
<li><p>1.7 ReactiveCocoaæ“ä½œæ–¹æ³•ä¹‹ç§©åº.</p>
<ul>
<li><code>doNext</code>: æ‰§è¡ŒNextä¹‹å‰ï¼Œä¼šå…ˆæ‰§è¡Œè¿™ä¸ªBlock</li>
<li><code>doCompleted</code>: æ‰§è¡ŒsendCompletedä¹‹å‰ï¼Œä¼šå…ˆæ‰§è¡Œè¿™ä¸ªBlock<pre><code>
[[[[RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
[subscriber sendNext:@1];
[subscriber sendCompleted];
return nil;
}] doNext:^(id x) {
// æ‰§è¡Œ[subscriber sendNext:@1];ä¹‹å‰ä¼šè°ƒç”¨è¿™ä¸ªBlock
NSLog(@"doNext");;
}] doCompleted:^{
 // æ‰§è¡Œ[subscriber sendCompleted];ä¹‹å‰ä¼šè°ƒç”¨è¿™ä¸ªBlock
NSLog(@"doCompleted");;
}] subscribeNext:^(id x) {
NSLog(@"%@",x);
}];
</racsubscriber></code></pre>
</li>
</ul>
</li>
<li><p>1.8 ReactiveCocoaæ“ä½œæ–¹æ³•ä¹‹çº¿ç¨‹ã€‚    </p>
<ul>
<li><code>deliverOn</code>: å†…å®¹ä¼ é€’åˆ‡æ¢åˆ°åˆ¶å®šçº¿ç¨‹ä¸­ï¼Œå‰¯ä½œç”¨åœ¨åŸæ¥çº¿ç¨‹ä¸­,æŠŠåœ¨åˆ›å»ºä¿¡å·æ—¶blockä¸­çš„ä»£ç ç§°ä¹‹ä¸ºå‰¯ä½œç”¨ã€‚</li>
<li><code>subscribeOn</code>: å†…å®¹ä¼ é€’å’Œå‰¯ä½œç”¨éƒ½ä¼šåˆ‡æ¢åˆ°åˆ¶å®šçº¿ç¨‹ä¸­ã€‚</li>
</ul>
</li>
<li><p>1.9 ReactiveCocoaæ“ä½œæ–¹æ³•ä¹‹æ—¶é—´ã€‚</p>
<ul>
<li><p><code>timeout</code>ï¼šè¶…æ—¶ï¼Œå¯ä»¥è®©ä¸€ä¸ªä¿¡å·åœ¨ä¸€å®šçš„æ—¶é—´åï¼Œè‡ªåŠ¨æŠ¥é”™ã€‚</p>
<pre><code>
RACSignal *signal = [[RACSignal createSignal:^RACDisposable*(id<racsubscriber> subscriber) {
return nil;
}] timeout:1 onScheduler:[RACScheduler currentScheduler]];
[signal subscribeNext:^(id x) {
NSLog(@"%@",x);
} error:^(NSError *error) {
// 1ç§’åä¼šè‡ªåŠ¨è°ƒç”¨
NSLog(@"%@",error);
}];
</racsubscriber></code></pre>
</li>
<li><p><code>interval</code> å®šæ—¶ï¼šæ¯éš”ä¸€æ®µæ—¶é—´å‘å‡ºä¿¡å·</p>
<pre><code>
[[RACSignal interval:1 onScheduler:[RACScheduler currentScheduler]] subscribeNext:^(id x) {
   NSLog(@"%@",x);
}];
</code></pre>
</li>
<li><p><code>delay</code> å»¶è¿Ÿå‘é€nextã€‚</p>
<pre><code>
RACSignal *signal = [[[RACSignal createSignal:^RACDisposable*(id<racsubscriber> subscriber) {
[subscriber sendNext:@1];
   return nil;
}] delay:2] subscribeNext:^(id x) {
   NSLog(@"%@",x);
}];
</racsubscriber></code></pre>
</li>
</ul>
</li>
<li><p>1.9 ReactiveCocoaæ“ä½œæ–¹æ³•ä¹‹é‡å¤ã€‚</p>
<ul>
<li><p><code>retry</code>é‡è¯• ï¼šåªè¦å¤±è´¥ï¼Œå°±ä¼šé‡æ–°æ‰§è¡Œåˆ›å»ºä¿¡å·ä¸­çš„block,ç›´åˆ°æˆåŠŸ.</p>
<pre><code>
__block int i = 0;
[[[RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
  if (i == 10) {
      [subscriber sendNext:@1];
  }else{
      NSLog(@"æ¥æ”¶åˆ°é”™è¯¯");
      [subscriber sendError:nil];
  }
  i++;
  return nil;
}] retry] subscribeNext:^(id x) {
  NSLog(@"%@",x);
} error:^(NSError *error) {
}];
</racsubscriber></code></pre>
</li>
<li><p><code>replay</code>é‡æ”¾ï¼šå½“ä¸€ä¸ªä¿¡å·è¢«å¤šæ¬¡è®¢é˜…,åå¤æ’­æ”¾å†…å®¹</p>
<pre><code>
RACSignal *signal = [[RACSignal createSignal:^RACDisposable*(id<racsubscriber> subscriber) {
     [subscriber sendNext:@1];
     [subscriber sendNext:@2];
     return nil;
}] replay];
[signal subscribeNext:^(id x) {
     NSLog(@"ç¬¬ä¸€ä¸ªè®¢é˜…è€…%@",x);
}];
[signal subscribeNext:^(id x) {
     NSLog(@"ç¬¬äºŒä¸ªè®¢é˜…è€…%@",x);
}];
</racsubscriber></code></pre>
</li>
<li><p><code>throttle</code>èŠ‚æµ:å½“æŸä¸ªä¿¡å·å‘é€æ¯”è¾ƒé¢‘ç¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨èŠ‚æµï¼Œåœ¨æŸä¸€æ®µæ—¶é—´ä¸å‘é€ä¿¡å·å†…å®¹ï¼Œè¿‡äº†ä¸€æ®µæ—¶é—´è·å–ä¿¡å·çš„æœ€æ–°å†…å®¹å‘å‡ºã€‚</p>
<pre><code>
RACSubject *signal = [RACSubject subject];
_signal = signal;
// èŠ‚æµï¼Œåœ¨ä¸€å®šæ—¶é—´ï¼ˆ1ç§’ï¼‰å†…ï¼Œä¸æ¥æ”¶ä»»ä½•ä¿¡å·å†…å®¹ï¼Œè¿‡äº†è¿™ä¸ªæ—¶é—´ï¼ˆ1ç§’ï¼‰è·å–æœ€åå‘é€çš„ä¿¡å·å†…å®¹å‘å‡ºã€‚
[[signal throttle:1] subscribeNext:^(id x) {
  NSLog(@"%@",x);
}];
</code></pre>




</li>
</ul>
</li>
</ul>
<h3 id="2-ä»‹ç»MVVMæ¶æ„æ€æƒ³ã€‚"><a href="#2-ä»‹ç»MVVMæ¶æ„æ€æƒ³ã€‚" class="headerlink" title="2.ä»‹ç»MVVMæ¶æ„æ€æƒ³ã€‚"></a>2.ä»‹ç»MVVMæ¶æ„æ€æƒ³ã€‚</h3><ul>
<li>2.1 ç¨‹åºä¸ºä»€ä¹ˆè¦æ¶æ„ï¼šä¾¿äºç¨‹åºå‘˜å¼€å‘å’Œç»´æŠ¤ä»£ç </li>
<li>2.2 å¸¸è§çš„æ¶æ„æ€æƒ³:<ul>
<li><code>MVC</code> M:æ¨¡å‹ V:è§†å›¾ C:æ§åˆ¶å™¨</li>
<li><code>MVVM</code> M:æ¨¡å‹ V:è§†å›¾+æ§åˆ¶å™¨ VM:è§†å›¾æ¨¡å‹</li>
<li><code>MVCS</code> M:æ¨¡å‹ V:è§†å›¾ C:æ§åˆ¶å™¨ C:æœåŠ¡ç±»</li>
<li><code>VIPER</code> V:è§†å›¾ I:äº¤äº’å™¨ P:å±•ç¤ºå™¨ E:å®ä½“ R:è·¯ç”± (<a href="http://www.cocoachina.com/ios/20140703/9016.html" target="_blank" rel="external">http://www.cocoachina.com/ios/20140703/9016.html</a>)</li>
</ul>
</li>
<li>2.3 MVVMä»‹ç»<ul>
<li><code>æ¨¡å‹</code>(M):ä¿å­˜è§†å›¾æ•°æ®ã€‚</li>
<li><code>è§†å›¾+æ§åˆ¶å™¨</code>(V):å±•ç¤ºå†…å®¹ + å¦‚ä½•å±•ç¤º</li>
<li><code>è§†å›¾æ¨¡å‹</code>(VM):å¤„ç†å±•ç¤ºçš„ä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬æŒ‰é’®çš„ç‚¹å‡»ï¼Œæ•°æ®çš„è¯·æ±‚å’Œè§£æç­‰ç­‰ã€‚</li>
</ul>
</li>
</ul>
<h3 id="3-ReactiveCocoa-MVVM-å®æˆ˜ä¸€ï¼šç™»å½•ç•Œé¢"><a href="#3-ReactiveCocoa-MVVM-å®æˆ˜ä¸€ï¼šç™»å½•ç•Œé¢" class="headerlink" title="3.ReactiveCocoa + MVVM å®æˆ˜ä¸€ï¼šç™»å½•ç•Œé¢"></a>3.ReactiveCocoa + MVVM å®æˆ˜ä¸€ï¼šç™»å½•ç•Œé¢</h3><ul>
<li><p>3.1 éœ€æ±‚+åˆ†æ+æ­¥éª¤</p>
<pre><code>
  /* éœ€æ±‚ï¼š1.ç›‘å¬ä¸¤ä¸ªæ–‡æœ¬æ¡†çš„å†…å®¹ï¼Œæœ‰å†…å®¹æ‰å…è®¸æŒ‰é’®ç‚¹å‡»
      2.é»˜è®¤ç™»å½•è¯·æ±‚.

 ç”¨MVVMï¼šå®ç°ï¼Œä¹‹å‰ç•Œé¢çš„æ‰€æœ‰ä¸šåŠ¡é€»è¾‘
 åˆ†æï¼š1.ä¹‹å‰ç•Œé¢çš„æ‰€æœ‰ä¸šåŠ¡é€»è¾‘éƒ½äº¤ç»™æ§åˆ¶å™¨åšå¤„ç†
      2.åœ¨MVVMæ¶æ„ä¸­æŠŠæ§åˆ¶å™¨çš„ä¸šåŠ¡å…¨éƒ¨æ¬å»VMæ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªæ§åˆ¶å™¨å¯¹åº”ä¸€ä¸ªVMæ¨¡å‹.

 æ­¥éª¤ï¼š1.åˆ›å»ºLoginViewModelç±»ï¼Œå¤„ç†ç™»å½•ç•Œé¢ä¸šåŠ¡é€»è¾‘.
      2.è¿™ä¸ªç±»é‡Œé¢åº”è¯¥ä¿å­˜ç€è´¦å·çš„ä¿¡æ¯ï¼Œåˆ›å»ºä¸€ä¸ªè´¦å·Accountæ¨¡å‹
      3.LoginViewModelåº”è¯¥ä¿å­˜ç€è´¦å·ä¿¡æ¯Accountæ¨¡å‹ã€‚
      4.éœ€è¦æ—¶åˆ»ç›‘å¬Accountæ¨¡å‹ä¸­çš„è´¦å·å’Œå¯†ç çš„æ”¹å˜ï¼Œæ€ä¹ˆç›‘å¬ï¼Ÿ
      5.åœ¨éRACå¼€å‘ä¸­ï¼Œéƒ½æ˜¯ä¹ æƒ¯èµ‹å€¼ï¼Œåœ¨RACå¼€å‘ä¸­ï¼Œéœ€è¦æ”¹å˜å¼€å‘æ€ç»´ï¼Œç”±èµ‹å€¼è½¬å˜ä¸ºç»‘å®šï¼Œå¯ä»¥åœ¨ä¸€å¼€å§‹åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå°±ç»™Accountæ¨¡å‹ä¸­çš„å±æ€§ç»‘å®šï¼Œå¹¶ä¸éœ€è¦é‡å†™setæ–¹æ³•ã€‚
      6.æ¯æ¬¡Accountæ¨¡å‹çš„å€¼æ”¹å˜ï¼Œå°±éœ€è¦åˆ¤æ–­æŒ‰é’®èƒ½å¦ç‚¹å‡»ï¼Œåœ¨VMæ¨¡å‹ä¸­åšå¤„ç†ï¼Œç»™å¤–ç•Œæä¾›ä¸€ä¸ªèƒ½å¦ç‚¹å‡»æŒ‰é’®çš„ä¿¡å·.
      7.è¿™ä¸ªç™»å½•ä¿¡å·éœ€è¦åˆ¤æ–­Accountä¸­è´¦å·å’Œå¯†ç æ˜¯å¦æœ‰å€¼ï¼Œç”¨KVOç›‘å¬è¿™ä¸¤ä¸ªå€¼çš„æ”¹å˜ï¼ŒæŠŠä»–ä»¬èšåˆæˆç™»å½•ä¿¡å·.
      8.ç›‘å¬æŒ‰é’®çš„ç‚¹å‡»ï¼Œç”±VMå¤„ç†ï¼Œåº”è¯¥ç»™VMå£°æ˜ä¸€ä¸ªRACCommandï¼Œä¸“é—¨å¤„ç†ç™»å½•ä¸šåŠ¡é€»è¾‘.
      9.æ‰§è¡Œå‘½ä»¤ï¼ŒæŠŠæ•°æ®åŒ…è£…æˆä¿¡å·ä¼ é€’å‡ºå»
      10.ç›‘å¬å‘½ä»¤ä¸­ä¿¡å·çš„æ•°æ®ä¼ é€’
      11.ç›‘å¬å‘½ä»¤çš„æ‰§è¡Œæ—¶åˆ»
*/
</code></pre>
</li>
<li><p>3.2 æ§åˆ¶å™¨çš„ä»£ç </p>
<pre><code>
  @interface ViewController ()
  @property (nonatomic, strong) LoginViewModel *loginViewModel;
  @property (weak, nonatomic) IBOutlet UITextField *accountField;
  @property (weak, nonatomic) IBOutlet UITextField *pwdField;
  @property (weak, nonatomic) IBOutlet UIButton *loginBtn;
  @end
  - (LoginViewModel *)loginViewModel
  {
      if (_loginViewModel == nil) {
          _loginViewModel = [[LoginViewModel alloc] init];
      }
      return _loginViewModel;
  }
  // è§†å›¾æ¨¡å‹ç»‘å®š
  - (void)bindModel
  {
      // ç»™æ¨¡å‹çš„å±æ€§ç»‘å®šä¿¡å·
      // åªè¦è´¦å·æ–‡æœ¬æ¡†ä¸€æ”¹å˜ï¼Œå°±ä¼šç»™accountèµ‹å€¼
      RAC(self.loginViewModel.account, account) = _accountField.rac_textSignal;
      RAC(self.loginViewModel.account, pwd) = _pwdField.rac_textSignal;
      // ç»‘å®šç™»å½•æŒ‰é’®
      RAC(self.loginBtn,enabled) = self.loginViewModel.enableLoginSignal;
     // ç›‘å¬ç™»å½•æŒ‰é’®ç‚¹å‡»
      [[_loginBtn rac_signalForControlEvents:UIControlEventTouchUpInside] subscribeNext:^(id x) {
          // æ‰§è¡Œç™»å½•äº‹ä»¶
          [self.loginViewModel.LoginCommand execute:nil];
      }];
  }
</code></pre>
</li>
<li><p>3.3 VMçš„ä»£ç </p>
<pre><code>
  @interface LoginViewModel : NSObject
  @property (nonatomic, strong) Account *account;
  // æ˜¯å¦å…è®¸ç™»å½•çš„ä¿¡å·
  @property (nonatomic, strong, readonly) RACSignal *enableLoginSignal;
  @property (nonatomic, strong, readonly) RACCommand *LoginCommand;
  @end
  @implementation LoginViewModel
  - (Account *)account
  {
      if (_account == nil) {
          _account = [[Account alloc] init];
      }
      return _account;
  }
  - (instancetype)init
  {
      if (self = [super init]) {
          [self initialBind];
      }
      return self;
  }
  // åˆå§‹åŒ–ç»‘å®š
  - (void)initialBind
  {
      // ç›‘å¬è´¦å·çš„å±æ€§å€¼æ”¹å˜ï¼ŒæŠŠä»–ä»¬èšåˆæˆä¸€ä¸ªä¿¡å·ã€‚
      _enableLoginSignal = [RACSignal combineLatest:@[RACObserve(self.account, account),RACObserve(self.account, pwd)] reduce:^id(NSString *account,NSString *pwd){
          return @(account.length && pwd.length);
      }];
      // å¤„ç†ç™»å½•ä¸šåŠ¡é€»è¾‘
      _LoginCommand = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(id input) {
          NSLog(@"ç‚¹å‡»äº†ç™»å½•");
          return [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
              // æ¨¡ä»¿ç½‘ç»œå»¶è¿Ÿ
              dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.5 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
                  [subscriber sendNext:@"ç™»å½•æˆåŠŸ"];
                  // æ•°æ®ä¼ é€å®Œæ¯•ï¼Œå¿…é¡»è°ƒç”¨å®Œæˆï¼Œå¦åˆ™å‘½ä»¤æ°¸è¿œå¤„äºæ‰§è¡ŒçŠ¶æ€
                  [subscriber sendCompleted];
              });
              return nil;
          }];
      }];
      // ç›‘å¬ç™»å½•äº§ç”Ÿçš„æ•°æ®
      [_LoginCommand.executionSignals.switchToLatest subscribeNext:^(id x) {
          if ([x isEqualToString:@"ç™»å½•æˆåŠŸ"]) {
              NSLog(@"ç™»å½•æˆåŠŸ");
          }
      }];
      // ç›‘å¬ç™»å½•çŠ¶æ€
      [[_LoginCommand.executing skip:1] subscribeNext:^(id x) {
          if ([x isEqualToNumber:@(YES)]) {
              // æ­£åœ¨ç™»å½•ing...
              // ç”¨è’™ç‰ˆæç¤º
              [MBProgressHUD showMessage:@"æ­£åœ¨ç™»å½•..."];
          }else
          {
              // ç™»å½•æˆåŠŸ
              // éšè—è’™ç‰ˆ
              [MBProgressHUD hideHUD];
          }
      }];
  }
</racsubscriber></code></pre>


</li>
</ul>
<h3 id="4-ReactiveCocoa-MVVM-å®æˆ˜äºŒï¼šç½‘ç»œè¯·æ±‚æ•°æ®"><a href="#4-ReactiveCocoa-MVVM-å®æˆ˜äºŒï¼šç½‘ç»œè¯·æ±‚æ•°æ®" class="headerlink" title="4.ReactiveCocoa + MVVM å®æˆ˜äºŒï¼šç½‘ç»œè¯·æ±‚æ•°æ®"></a>4.ReactiveCocoa + MVVM å®æˆ˜äºŒï¼šç½‘ç»œè¯·æ±‚æ•°æ®</h3><ul>
<li>4.1 æ¥å£ï¼šè¿™é‡Œå…ˆç»™æœ‹å‹ä»‹ç»ä¸€ä¸ªå…è´¹çš„ç½‘ç»œæ•°æ®æ¥å£ï¼Œè±†ç“£ã€‚å¯ä»¥ç»å¸¸ç”¨æ¥ç»ƒä¹ ä¸€äº›ç½‘ç»œè¯·æ±‚çš„å°Demo.</li>
<li><p>4.2 éœ€æ±‚+åˆ†æ+æ­¥éª¤</p>
<pre><code>
/*
  éœ€æ±‚ï¼šè¯·æ±‚è±†ç“£å›¾ä¹¦ä¿¡æ¯ï¼Œurl:https://api.douban.com/v2/book/search?q=åŸºç¡€

  åˆ†æï¼šè¯·æ±‚ä¸€æ ·ï¼Œäº¤ç»™VMæ¨¡å‹ç®¡ç†

  æ­¥éª¤:
      1.æ§åˆ¶å™¨æä¾›ä¸€ä¸ªè§†å›¾æ¨¡å‹ï¼ˆrequesViewModelï¼‰ï¼Œå¤„ç†ç•Œé¢çš„ä¸šåŠ¡é€»è¾‘
      2.VMæä¾›ä¸€ä¸ªå‘½ä»¤ï¼Œå¤„ç†è¯·æ±‚ä¸šåŠ¡é€»è¾‘
      3.åœ¨åˆ›å»ºå‘½ä»¤çš„blockä¸­ï¼Œä¼šæŠŠè¯·æ±‚åŒ…è£…æˆä¸€ä¸ªä¿¡å·ï¼Œç­‰è¯·æ±‚æˆåŠŸçš„æ—¶å€™ï¼Œå°±ä¼šæŠŠæ•°æ®ä¼ é€’å‡ºå»ã€‚
      4.è¯·æ±‚æ•°æ®æˆåŠŸï¼Œåº”è¯¥æŠŠå­—å…¸è½¬æ¢æˆæ¨¡å‹ï¼Œä¿å­˜åˆ°è§†å›¾æ¨¡å‹ä¸­ï¼Œæ§åˆ¶å™¨æƒ³ç”¨å°±ç›´æ¥ä»è§†å›¾æ¨¡å‹ä¸­è·å–ã€‚
      5.å‡è®¾æ§åˆ¶å™¨æƒ³å±•ç¤ºå†…å®¹åˆ°tableViewï¼Œç›´æ¥è®©è§†å›¾æ¨¡å‹æˆä¸ºtableViewçš„æ•°æ®æºï¼ŒæŠŠæ‰€æœ‰çš„ä¸šåŠ¡é€»è¾‘äº¤ç»™è§†å›¾æ¨¡å‹å»åšï¼Œè¿™æ ·æ§åˆ¶å™¨çš„ä»£ç å°±éå¸¸å°‘äº†ã€‚
*/
</code></pre>
</li>
<li><p>4.3 æ§åˆ¶å™¨ä»£ç </p>
<pre><code>
  @interface ViewController ()
  @property (nonatomic, weak) UITableView *tableView;
  @property (nonatomic, strong) RequestViewModel *requesViewModel;
  @end
  @implementation ViewController
  - (RequestViewModel *)requesViewModel
  {
      if (_requesViewModel == nil) {
          _requesViewModel = [[RequestViewModel alloc] init];
      }
      return _requesViewModel;
  }
  - (void)viewDidLoad {
      [super viewDidLoad];
      // Do any additional setup after loading the view, typically from a nib.
      // åˆ›å»ºtableView
      UITableView *tableView = [[UITableView alloc] initWithFrame:self.view.bounds];
      tableView.dataSource = self.requesViewModel;
      self.requesViewModel.tableView = tableView;
      [self.view addSubview:tableView];
      // æ‰§è¡Œè¯·æ±‚
      [self.requesViewModel.reuqesCommand execute:nil];

  }
  @end
</code></pre>
</li>
<li><p>4.4 è§†å›¾æ¨¡å‹(VM)ä»£ç </p>
<pre><code>
  @interface RequestViewModel : NSObject<uitableviewdatasource>
  // è¯·æ±‚å‘½ä»¤
  @property (nonatomic, strong, readonly) RACCommand *reuqesCommand;
  //æ¨¡å‹æ•°ç»„
  @property (nonatomic, strong, readonly) NSArray *models;
  // æ§åˆ¶å™¨ä¸­çš„view
  @property (nonatomic, weak) UITableView *tableView;
  @end
  @implementation RequestViewModel
  - (instancetype)init
  {
      if (self = [super init]) {
          [self initialBind];
      }
      return self;
  }
  - (void)initialBind
  {
      _reuqesCommand = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(id input) {
          RACSignal *requestSignal = [RACSignal createSignal:^RACDisposable *(id<racsubscriber> subscriber) {
              NSMutableDictionary *parameters = [NSMutableDictionary dictionary];
              parameters[@"q"] = @"åŸºç¡€";
              // å‘é€è¯·æ±‚
              [[AFHTTPRequestOperationManager manager] GET:@"https://api.douban.com/v2/book/search" parameters:parameters success:^(AFHTTPRequestOperation * _Nonnull operation, id  _Nonnull responseObject) {
                  NSLog(@"%@",responseObject);
                  // è¯·æ±‚æˆåŠŸè°ƒç”¨
                  // æŠŠæ•°æ®ç”¨ä¿¡å·ä¼ é€’å‡ºå»
                  [subscriber sendNext:responseObject];
                  [subscriber sendCompleted];
              } failure:^(AFHTTPRequestOperation * _Nonnull operation, NSError * _Nonnull error) {
                  // è¯·æ±‚å¤±è´¥è°ƒç”¨
              }];
              return nil;
          }];
          // åœ¨è¿”å›æ•°æ®ä¿¡å·æ—¶ï¼ŒæŠŠæ•°æ®ä¸­çš„å­—å…¸æ˜ å°„æˆæ¨¡å‹ä¿¡å·ï¼Œä¼ é€’å‡ºå»
          return [requestSignal map:^id(NSDictionary *value) {
              NSMutableArray *dictArr = value[@"books"];
              // å­—å…¸è½¬æ¨¡å‹ï¼Œéå†å­—å…¸ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå…¨éƒ¨æ˜ å°„æˆæ¨¡å‹ï¼Œå¹¶ä¸”ç”Ÿæˆæ•°ç»„
              NSArray *modelArr = [[dictArr.rac_sequence map:^id(id value) {
                  return [Book bookWithDict:value];
              }] array];
              return modelArr;
          }];
      }];
      // è·å–è¯·æ±‚çš„æ•°æ®
      [_reuqesCommand.executionSignals.switchToLatest subscribeNext:^(NSArray *x) {
          // æœ‰äº†æ–°æ•°æ®ï¼Œåˆ·æ–°è¡¨æ ¼
          _models = x;
          // åˆ·æ–°è¡¨æ ¼
          [self.tableView reloadData];
      }];
  }
  #pragma mark - UITableViewDataSource
  - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
  {
      return self.models.count;
  }
  - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
  {
      static NSString *ID = @"cell";
      UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:ID];
      if (cell == nil) {

          cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:ID];
      }
      Book *book = self.models[indexPath.row];
      cell.detailTextLabel.text = book.subtitle;
      cell.textLabel.text = book.title;
      return cell;
  }
  @end
</racsubscriber></uitableviewdatasource></code></pre>    


</li>
</ul>
<!-- more -->]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[iOSåŠ¨ç”»ç¯‡ä¹‹UIViewåŠ¨ç”»]]></title>
      <url>http://yoursite.com/2016/03/04/iOS%E5%8A%A8%E7%94%BB%E7%AF%87-transfrom/</url>
      <content type="html"><![CDATA[<p>UIKitç›´æ¥å°†åŠ¨ç”»é›†æˆåˆ°UIViewç±»ä¸­ï¼Œå½“å†…éƒ¨çš„ä¸€äº›å±æ€§å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒUIViewå°†ä¸ºè¿™äº›æ”¹å˜æä¾›åŠ¨ç”»æ”¯æŒã€‚<br><a id="more"></a></p>
<h4 id="UIViewAnimationOptionså‚è€ƒ"><a href="#UIViewAnimationOptionså‚è€ƒ" class="headerlink" title="UIViewAnimationOptionså‚è€ƒ"></a>UIViewAnimationOptionså‚è€ƒ</h4><pre><code>
1.åŸºæœ¬ç±»å‹
UIViewAnimationOptionLayoutSubviewsï¼šåŠ¨ç”»è¿‡ç¨‹ä¸­ä¿è¯å­è§†å›¾è·Ÿéšè¿åŠ¨ã€‚
UIViewAnimationOptionAllowUserInteractionï¼šåŠ¨ç”»è¿‡ç¨‹ä¸­å…è®¸ç”¨æˆ·äº¤äº’ã€‚
UIViewAnimationOptionBeginFromCurrentStateï¼šæ‰€æœ‰è§†å›¾ä»å½“å‰çŠ¶æ€å¼€å§‹è¿è¡Œã€‚
UIViewAnimationOptionRepeatï¼šé‡å¤è¿è¡ŒåŠ¨ç”»ã€‚
UIViewAnimationOptionAutoreverse ï¼šåŠ¨ç”»è¿è¡Œåˆ°ç»“æŸç‚¹åä»ç„¶ä»¥åŠ¨ç”»æ–¹å¼å›åˆ°åˆå§‹ç‚¹ã€‚
UIViewAnimationOptionOverrideInheritedDurationï¼šå¿½ç•¥åµŒå¥—åŠ¨ç”»æ—¶é—´è®¾ç½®ã€‚
UIViewAnimationOptionOverrideInheritedCurveï¼šå¿½ç•¥åµŒå¥—åŠ¨ç”»é€Ÿåº¦è®¾ç½®ã€‚
UIViewAnimationOptionAllowAnimatedContentï¼šåŠ¨ç”»è¿‡ç¨‹ä¸­é‡ç»˜è§†å›¾ï¼ˆæ³¨æ„ä»…ä»…é€‚ç”¨äºè½¬åœºåŠ¨ç”»ï¼‰ã€‚  
UIViewAnimationOptionShowHideTransitionViewsï¼šè§†å›¾åˆ‡æ¢æ—¶ç›´æ¥éšè—æ—§è§†å›¾ã€æ˜¾ç¤ºæ–°è§†å›¾ï¼Œè€Œä¸æ˜¯å°†æ—§è§†å›¾ä»çˆ¶è§†å›¾ç§»é™¤ï¼ˆä»…ä»…é€‚ç”¨äºè½¬åœºåŠ¨ç”»ï¼‰
UIViewAnimationOptionOverrideInheritedOptions ï¼šä¸ç»§æ‰¿çˆ¶åŠ¨ç”»è®¾ç½®æˆ–åŠ¨ç”»ç±»å‹ã€‚

2.åŠ¨ç”»é€Ÿåº¦æ§åˆ¶ï¼ˆå¯ä»å…¶ä¸­é€‰æ‹©ä¸€ä¸ªè®¾ç½®ï¼‰
UIViewAnimationOptionCurveEaseInOutï¼šåŠ¨ç”»å…ˆç¼“æ…¢ï¼Œç„¶åé€æ¸åŠ é€Ÿã€‚
UIViewAnimationOptionCurveEaseIn ï¼šåŠ¨ç”»é€æ¸å˜æ…¢ã€‚
UIViewAnimationOptionCurveEaseOutï¼šåŠ¨ç”»é€æ¸åŠ é€Ÿã€‚
UIViewAnimationOptionCurveLinear ï¼šåŠ¨ç”»åŒ€é€Ÿæ‰§è¡Œï¼Œé»˜è®¤å€¼ã€‚

3.è½¬åœºç±»å‹ï¼ˆä»…é€‚ç”¨äºè½¬åœºåŠ¨ç”»è®¾ç½®ï¼Œå¯ä»¥ä»ä¸­é€‰æ‹©ä¸€ä¸ªè¿›è¡Œè®¾ç½®ï¼ŒåŸºæœ¬åŠ¨ç”»ã€å…³é”®å¸§åŠ¨ç”»ä¸éœ€è¦è®¾ç½®ï¼‰
UIViewAnimationOptionTransitionNoneï¼šæ²¡æœ‰è½¬åœºåŠ¨ç”»æ•ˆæœã€‚
UIViewAnimationOptionTransitionFlipFromLeft ï¼šä»å·¦ä¾§ç¿»è½¬æ•ˆæœã€‚
UIViewAnimationOptionTransitionFlipFromRightï¼šä»å³ä¾§ç¿»è½¬æ•ˆæœã€‚
UIViewAnimationOptionTransitionCurlUpï¼šå‘åç¿»é¡µçš„åŠ¨ç”»è¿‡æ¸¡æ•ˆæœã€‚    
UIViewAnimationOptionTransitionCurlDown ï¼šå‘å‰ç¿»é¡µçš„åŠ¨ç”»è¿‡æ¸¡æ•ˆæœã€‚    
UIViewAnimationOptionTransitionCrossDissolveï¼šæ—§è§†å›¾æº¶è§£æ¶ˆå¤±æ˜¾ç¤ºä¸‹ä¸€ä¸ªæ–°è§†å›¾çš„æ•ˆæœã€‚    
UIViewAnimationOptionTransitionFlipFromTop ï¼šä»ä¸Šæ–¹ç¿»è½¬æ•ˆæœã€‚    
UIViewAnimationOptionTransitionFlipFromBottomï¼šä»åº•éƒ¨ç¿»è½¬æ•ˆæœã€‚
</code></pre>


<h3 id="1-åŸºæœ¬åŠ¨ç”»"><a href="#1-åŸºæœ¬åŠ¨ç”»" class="headerlink" title="1. åŸºæœ¬åŠ¨ç”»"></a>1. åŸºæœ¬åŠ¨ç”»</h3><p><code>+ (void)animateWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay options:(UIViewAnimationOptions)options animations:(void (^)(void))animations completion:(void (^ __nullable)(BOOL finished))completion</code></p>
<ul>
<li><strong>å‚æ•°è¯¦æƒ…:</strong></li>
</ul>
<pre><code>
duration   :   æŒç»­æ—¶é—´  
delay      :   å»¶è¿Ÿæ‰§è¡Œ  
options    :   åŠ¨ç”»é€‰é¡¹(å¾€å¤ã€å¾ªç¯ç­‰)  
animations :   åŠ¨ç”»block  
completion :   å®Œæˆåçš„block 
</code></pre>

<ul>
<li><strong>å¯å®ç°åŠ¨ç”»çš„å±æ€§</strong></li>
</ul>
<pre><code>
åæ ‡å°ºå¯¸ç±»: boundsã€frameã€center  
è§†å›¾æ˜¾ç¤ºç±»: backgroundColorã€alphaã€hidden  
å½¢æ€å˜åŒ–ç±»: transform
</code></pre>

<h3 id="2-å¼¹ç°§åŠ¨ç”»"><a href="#2-å¼¹ç°§åŠ¨ç”»" class="headerlink" title="2.å¼¹ç°§åŠ¨ç”»"></a>2.å¼¹ç°§åŠ¨ç”»</h3><p><code>+ (void)animateWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay usingSpringWithDamping:(CGFloat)dampingRatio initialSpringVelocity:(CGFloat)velocity options:(UIViewAnimationOptions)options animations:(void (^)(void))animations completion:(void (^ __nullable)(BOOL finished))completion</code></p>
<ul>
<li><strong>å‚æ•°è¯¦æƒ…:</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">usingSpringWithDamping   :   0.0 ~ 1.0 é˜»å°¼æ¯”ä¾‹ï¼Œæ•°å€¼è¶Šå°ã€Œå¼¹ç°§ã€çš„æŒ¯åŠ¨æ•ˆæœè¶Šæ˜æ˜¾</div><div class="line">initialSpringVelocity    :   åˆå§‹çš„é€Ÿåº¦ï¼Œæ•°å€¼è¶Šå¤§ä¸€å¼€å§‹ç§»åŠ¨è¶Šå¿«</div></pre></td></tr></table></figure>
<h3 id="3-è¿‡æ¸¡åŠ¨ç”»"><a href="#3-è¿‡æ¸¡åŠ¨ç”»" class="headerlink" title="3.è¿‡æ¸¡åŠ¨ç”»"></a>3.è¿‡æ¸¡åŠ¨ç”»</h3><p><code>+ (void)transitionWithView:(UIView *)view duration:(NSTimeInterval)duration options:(UIViewAnimationOptions)options animations:(void (^ __nullable)(void))animations completion:(void (^ __nullable)(BOOL finished))completion</code></p>
<ul>
<li><strong>å‚æ•°è¯¦æƒ…:</strong></li>
</ul>
<pre><code>
view       :   éœ€è¦è¿›è¡Œè½¬åœºåŠ¨ç”»çš„è§†å›¾
options    :   è½¬åœºåŠ¨ç”»çš„ç±»å‹
</code></pre>

<p><code>+ (void)transitionFromView:(UIView *)fromView toView:(UIView *)toView duration:(NSTimeInterval)duration options:(UIViewAnimationOptions)options completion:(void (^ __nullable)(BOOL finished))completion</code></p>
<ul>
<li><strong>å‚æ•°è¯¦æƒ…:</strong></li>
</ul>
<pre><code>
æ–¹æ³•è°ƒç”¨å®Œæ¯•åï¼Œç›¸å½“äºæ‰§è¡Œäº†ä¸‹é¢ä¸¤å¥ä»£ç ï¼š
// æ·»åŠ toViewåˆ°çˆ¶è§†å›¾
[fromView.superview addSubview:toView];
// æŠŠfromViewä»çˆ¶è§†å›¾ä¸­ç§»é™¤
[fromView removeFromSuperview];
</code></pre>

<h3 id="4-keyframeåŠ¨ç”»"><a href="#4-keyframeåŠ¨ç”»" class="headerlink" title="4. keyframeåŠ¨ç”»"></a>4. keyframeåŠ¨ç”»</h3><p><code>+ (void)animateKeyframesWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay options:(UIViewKeyframeAnimationOptions)options animations:(void (^)(void))animations completion:(void (^ __nullable)(BOOL finished))completion</code></p>
<p><code>+ (void)addKeyframeWithRelativeStartTime:(double)frameStartTime relativeDuration:(double)frameDuration animations:(void (^)(void))animations</code></p>
<ul>
<li><strong>å‚æ•°è¯¦æƒ…:</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">RelativeStartTime : å…³é”®å¸§åŠ¨ç”»å¼€å§‹æ—¶é—´çš„æ¯”ä¾‹å€¼</div><div class="line">RelativeDuration  : å…³é”®å¸§åŠ¨ç”»æŒç»­å®è·µçš„æ¯”ä¾‹å€¼</div></pre></td></tr></table></figure>
<ul>
<li><strong>ç”¨æ³•ç¤ºä¾‹:</strong></li>
</ul>
<pre><code>
[UIView animateKeyframesWithDuration:8 delay:0 options:UIViewKeyframeAnimationOptionCalculationModeLinear animations:^{
        [UIView addKeyframeWithRelativeStartTime:0 relativeDuration:0.25 animations:^{
            self.imgV.center = (CGPoint){center.x + 200 ,center.y + 150};
        }];
        [UIView addKeyframeWithRelativeStartTime:0.25 relativeDuration:0.25 animations:^{
            self.imgV.center = (CGPoint){center.x ,center.y + 300};
        }];
        [UIView addKeyframeWithRelativeStartTime:0.5 relativeDuration:0.25 animations:^{
            self.imgV.center = (CGPoint){center.x + 200,center.y + 450};
        }];
        [UIView addKeyframeWithRelativeStartTime:0.75 relativeDuration:0.25 animations:^{
            self.imgV.center = (CGPoint){center.x + 0,center.y + 600 };
        }];
    } completion:nil];
</code></pre>

<h3 id="5-transformå˜æ¢"><a href="#5-transformå˜æ¢" class="headerlink" title="5. transformå˜æ¢"></a>5. transformå˜æ¢</h3><p><code>CGAffineTransform</code></p>
<ul>
<li><strong>å˜æ¢åŸç†</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">struct CGAffineTransform &#123;</div><div class="line">   CGFloat a;</div><div class="line">   CGFloat b;</div><div class="line">   CGFloat c;</div><div class="line">   CGFloat d;</div><div class="line">   CGFloat tx;</div><div class="line">   CGFloat ty;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ç»“æ„ä½“çŸ©é˜µå›¾ä¸ºï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_26.gif?raw=true" alt="çŸ©é˜µå›¾"><br></div>

<p>å› ä¸ºæœ€åä¸€åˆ—æ€»æ˜¯æ˜¯(0,0,1)ï¼Œæ‰€ä»¥æœ‰ç”¨çš„ä¿¡æ¯å°±æ˜¯å‰é¢ä¸¤åˆ—<br>å¯¹ä¸€ä¸ªviewè¿›è¡Œä»¿å°„å˜åŒ–å°±ç›¸å½“äºå¯¹viewä¸Šçš„æ¯ä¸ªç‚¹åšä¸€ä¸ªä¹˜æ³•<br>ç»“æœå°±æ˜¯ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_27.gif?raw=true" alt="æ˜ å°„å˜æ¢"><br></div>

<p><strong>ç›¸å½“äºï¼š</strong><br>(x, y, 1 ) â€“&gt; (ax + cy + tx, bx + dy + ty, 1) </p>
<p>å¦‚æœä¸çœ‹cå’Œbçš„è¯<br>aè¡¨ç¤ºxæ°´å¹³æ–¹å‘çš„ç¼©æ”¾ï¼Œtxè¡¨ç¤ºxæ°´å¹³æ–¹å‘çš„åç§»<br>dè¡¨ç¤ºyå‚ç›´æ–¹å‘çš„ç¼©æ”¾ï¼Œtyè¡¨ç¤ºyå‚ç›´æ–¹å‘çš„åç§»<br>å¦‚æœbå’Œcä¸ä¸ºé›¶çš„è¯ï¼Œé‚£ä¹ˆè§†å›¾è‚¯å®šå‘ç”Ÿäº†æ—‹è½¬</p>
<p><strong>å¸¸é‡</strong><br>CGAffineTransformIdentity<br>CGAffineTransform<br>CGAffineTransformIdentity;<br>è¿™ä¸ªå°±æ˜¯æ²¡æœ‰å˜åŒ–çš„æœ€åˆçš„æ ·å­ </p>
<ul>
<li><strong>å¸¸ç”¨å‡½æ•°</strong></li>
</ul>
<pre><code>
/// ç”¨æ¥è¿æ¥ä¸¤ä¸ªå˜æ¢æ•ˆæœå¹¶è¿”å›ã€‚è¿”å›çš„t = t1 * t2
CGAffineTransformConcat(CGAffineTransform t1, CGAffineTransform t2)

/// çŸ©é˜µåˆå§‹å€¼ã€‚[ 1 0 0 1 0 0 ]
CGAffineTransformIdentity

/// è‡ªå®šä¹‰çŸ©é˜µå˜æ¢ï¼Œéœ€è¦æŒæ¡çŸ©é˜µå˜æ¢çš„çŸ¥è¯†æ‰çŸ¥é“æ€ä¹ˆç”¨ã€‚å‚ç…§(x, y, 1 ) --> (ax + cy + tx, bx + dy + ty, 1)  
CGAffineTransformMake(CGFloat a, CGFloat b, CGFloat c, CGFloat d, CGFloat tx, CGFloat ty)

/// æ—‹è½¬è§†å›¾ã€‚ä¼ å…¥å‚æ•°ä¸º è§’åº¦ * (M_PI / 180)ã€‚ç­‰åŒäº CGAffineTransformRotate(self.transform, angle)
CGAffineTransformMakeRotation(CGFloat angle)
CGAffineTransformRotate(CGAffineTransform t, CGFloat angle)

/// ç¼©æ”¾è§†å›¾ã€‚ç­‰åŒäºCGAffineTransformScale(self.transform, sx, sy)
CGAffineTransformMakeScale(CGFloat sx, CGFloat sy)
CGAffineTransformScale(CGAffineTransform t, CGFloat sx, CGFloat sy)

/// ç¼©æ”¾è§†å›¾ã€‚ç­‰åŒäºCGAffineTransformTranslate(self.transform, tx, ty)
CGAffineTransformMakeTranslation(CGFloat tx, CGFloat ty)
CGAffineTransformTranslate(CGAffineTransform t, CGFloat tx, CGFloat ty)
</code></pre>

<ul>
<li><strong>å¸¸ç”¨å‡½æ•°</strong></li>
</ul>
<pre><code>
- (void)viewDidAppear:(BOOL)animated {
    CGFloat offset = self.label1.frame.size.height * 0.5;

    self.label1.transform = CGAffineTransformConcat(
                                                    CGAffineTransformMakeScale(1, 0),
                                                    CGAffineTransformMakeTranslation(0, -offset));

    self.label1.alpha = 0;
    [UIView animateWithDuration:3.0 animations:^{
        self.label1.transform = CGAffineTransformIdentity;
        self.label1.alpha = 1;

        self.label2.transform = CGAffineTransformConcat(
                                                        CGAffineTransformMakeScale(1, 0.1),
                                                        CGAffineTransformMakeTranslation(0, offset));
        self.label2.alpha = 0;
    }];
}
</code></pre>


<h3 id="6-UIViewåŠ¨ç”»ï¼ˆé¦–å°¾æ–¹å¼ï¼‰"><a href="#6-UIViewåŠ¨ç”»ï¼ˆé¦–å°¾æ–¹å¼ï¼‰" class="headerlink" title="6.UIViewåŠ¨ç”»ï¼ˆé¦–å°¾æ–¹å¼ï¼‰"></a>6.UIViewåŠ¨ç”»ï¼ˆé¦–å°¾æ–¹å¼ï¼‰</h3><p>UIKitç›´æ¥å°†åŠ¨ç”»é›†æˆåˆ°UIViewç±»ä¸­ï¼Œå½“å†…éƒ¨çš„ä¸€äº›å±æ€§å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒUIViewå°†ä¸ºè¿™äº›æ”¹å˜æä¾›åŠ¨ç”»æ”¯æŒ<br>æ‰§è¡ŒåŠ¨ç”»æ‰€éœ€è¦çš„å·¥ä½œç”±UIViewç±»è‡ªåŠ¨å®Œæˆï¼Œä½†ä»è¦åœ¨å¸Œæœ›æ‰§è¡ŒåŠ¨ç”»æ—¶é€šçŸ¥è§†å›¾ï¼Œä¸ºæ­¤éœ€è¦å°†æ”¹å˜å±æ€§çš„ä»£ç æ”¾åœ¨[UIView beginAnimations:nil context:nil]å’Œ[UIView commitAnimations]ä¹‹é—´</p>
<p>å¸¸è§æ–¹æ³•è§£æ:<br>ã€€ã€€<strong>+ (void)setAnimationDelegate:(id)delegate</strong>     è®¾ç½®åŠ¨ç”»ä»£ç†å¯¹è±¡ï¼Œå½“åŠ¨ç”»å¼€å§‹æˆ–è€…ç»“æŸæ—¶ä¼šå‘æ¶ˆæ¯ç»™ä»£ç†å¯¹è±¡<br>ã€€ã€€<strong>+ (void)setAnimationWillStartSelector:(SEL)selector</strong>   å½“åŠ¨ç”»å³å°†å¼€å§‹æ—¶ï¼Œæ‰§è¡Œdelegateå¯¹è±¡çš„selectorï¼Œå¹¶ä¸”æŠŠbeginAnimations:context:ä¸­ä¼ å…¥çš„å‚æ•°ä¼ è¿›selector<br>ã€€ã€€<strong>+ (void)setAnimationDidStopSelector:(SEL)selector</strong>  å½“åŠ¨ç”»ç»“æŸæ—¶ï¼Œæ‰§è¡Œdelegateå¯¹è±¡çš„selectorï¼Œå¹¶ä¸”æŠŠbeginAnimations:context:ä¸­ä¼ å…¥çš„å‚æ•°ä¼ è¿›selector<br>ã€€ã€€<strong>+ (void)setAnimationDuration:(NSTimeInterval)duration</strong>   åŠ¨ç”»çš„æŒç»­æ—¶é—´ï¼Œç§’ä¸ºå•ä½<br>ã€€ã€€<strong>+ (void)setAnimationDelay:(NSTimeInterval)delay</strong>  åŠ¨ç”»å»¶è¿Ÿdelayç§’åå†å¼€å§‹<br>ã€€ã€€<strong>+ (void)setAnimationStartDate:(NSDate *)startDate</strong>   åŠ¨ç”»çš„å¼€å§‹æ—¶é—´ï¼Œé»˜è®¤ä¸ºnow<br>ã€€ã€€<strong>+ (void)setAnimationCurve:(UIViewAnimationCurve)curve</strong>  åŠ¨ç”»çš„èŠ‚å¥æ§åˆ¶<br>ã€€ã€€<strong>+ (void)setAnimationRepeatCount:(float)repeatCount</strong>  åŠ¨ç”»çš„é‡å¤æ¬¡æ•°<br>ã€€ã€€<strong>+ (void)setAnimationRepeatAutoreverses:(BOOL)repeatAutoreverses</strong>  å¦‚æœè®¾ç½®ä¸ºYES,ä»£è¡¨åŠ¨ç”»æ¯æ¬¡é‡å¤æ‰§è¡Œçš„æ•ˆæœä¼šè·Ÿä¸Šä¸€æ¬¡ç›¸å<br>ã€€ã€€<strong>+ (void)setAnimationTransition:(UIViewAnimationTransition)transition forView:(UIView *)view cache:(BOOL)cache</strong>  è®¾ç½®è§†å›¾viewçš„è¿‡æ¸¡æ•ˆæœ, transitionæŒ‡å®šè¿‡æ¸¡ç±»å‹, cacheè®¾ç½®YESä»£è¡¨ä½¿ç”¨è§†å›¾ç¼“å­˜ï¼Œæ€§èƒ½è¾ƒå¥½</p>
<p><strong>ä»£ç ç¤ºä¾‹: </strong></p>
<pre><code>
@interface ViewController ()
@property (weak, nonatomic) IBOutlet UIView *customView;


@end

@implementation YYViewController

- (void)viewDidLoad
{
     [super viewDidLoad];

}

-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
     //æ‰“å°åŠ¨ç”»å—çš„ä½ç½®
     NSLog(@"åŠ¨ç”»æ‰§è¡Œä¹‹å‰çš„ä½ç½®ï¼š%@",NSStringFromCGPoint(self.customView.center));

     //é¦–å°¾å¼åŠ¨ç”»
     [UIView beginAnimations:nil context:nil];
     //æ‰§è¡ŒåŠ¨ç”»
     //è®¾ç½®åŠ¨ç”»æ‰§è¡Œæ—¶é—´
     [UIView setAnimationDuration:2.0];
     //è®¾ç½®ä»£ç†
     [UIView setAnimationDelegate:self];
     //è®¾ç½®åŠ¨ç”»æ‰§è¡Œå®Œæ¯•è°ƒç”¨çš„äº‹ä»¶
     [UIView setAnimationDidStopSelector:@selector(didStopAnimation)];
     self.customView.center=CGPointMake(200, 300);
     [UIView commitAnimations];

}

-(void)didStopAnimation
{
     NSLog(@"åŠ¨ç”»æ‰§è¡Œå®Œæ¯•");
     //æ‰“å°åŠ¨ç”»å—çš„ä½ç½®
     NSLog(@"åŠ¨ç”»æ‰§è¡Œä¹‹åçš„ä½ç½®ï¼š%@",NSStringFromCGPoint(self.customView.center));
}
@end
</code></pre>

<p><strong>è¯´æ˜:</strong><br>ã€€ã€€ä½¿ç”¨UIViewå’ŒCALayeréƒ½èƒ½å®ç°åŠ¨ç”»æ•ˆæœï¼Œä½†æ˜¯åœ¨çœŸå®çš„å¼€å‘ä¸­ï¼Œä¸€èˆ¬è¿˜æ˜¯ä¸»è¦ä½¿ç”¨UIViewå°è£…çš„åŠ¨ç”»ï¼Œè€Œå¾ˆå°‘ä½¿ç”¨CALayerçš„åŠ¨ç”»ã€‚</p>
<p>CALayeræ ¸å¿ƒåŠ¨ç”»ä¸UIViewåŠ¨ç”»çš„åŒºåˆ«ï¼š<br>ã€€ã€€<strong>UIViewå°è£…çš„åŠ¨ç”»æ‰§è¡Œå®Œæ¯•ä¹‹åä¸ä¼šåå¼¹ã€‚å³å¦‚æœæ˜¯é€šè¿‡CALayeræ ¸å¿ƒåŠ¨ç”»æ”¹å˜layerçš„ä½ç½®çŠ¶æ€ï¼Œè¡¨é¢ä¸Šçœ‹è™½ç„¶å·²ç»æ”¹å˜äº†ï¼Œä½†æ˜¯å®é™…ä¸Šå®ƒçš„ä½ç½®æ˜¯æ²¡æœ‰æ”¹å˜çš„ã€‚</strong></p>
<h3 id="7-è¡¥å……"><a href="#7-è¡¥å……" class="headerlink" title="7.è¡¥å……"></a>7.è¡¥å……</h3><h5 id="UIImageViewçš„å¸§åŠ¨ç”»"><a href="#UIImageViewçš„å¸§åŠ¨ç”»" class="headerlink" title="UIImageViewçš„å¸§åŠ¨ç”»"></a>UIImageViewçš„å¸§åŠ¨ç”»</h5><p>UIImageViewå¯ä»¥è®©ä¸€ç³»åˆ—çš„å›¾ç‰‡åœ¨ç‰¹å®šçš„æ—¶é—´å†…æŒ‰é¡ºåºæ˜¾ç¤º</p>
<p>ç›¸å…³å±æ€§è§£æ:<br>ã€€ã€€<strong>animationImages</strong>ï¼šè¦æ˜¾ç¤ºçš„å›¾ç‰‡(ä¸€ä¸ªè£…ç€UIImageçš„NSArray)<br>ã€€ã€€<strong>animationDuration</strong>ï¼šå®Œæ•´åœ°æ˜¾ç¤ºä¸€æ¬¡animationImagesä¸­çš„æ‰€æœ‰å›¾ç‰‡æ‰€éœ€çš„æ—¶é—´<br>ã€€ã€€<strong>animationRepeatCount</strong>ï¼šåŠ¨ç”»çš„æ‰§è¡Œæ¬¡æ•°(é»˜è®¤ä¸º0ï¼Œä»£è¡¨æ— é™å¾ªç¯)</p>
<p>ç›¸å…³æ–¹æ³•è§£æ:<br>ã€€ã€€<strong>- (void)startAnimating</strong>; å¼€å§‹åŠ¨ç”»<br>ã€€ã€€<strong>- (void)stopAnimating</strong>;  åœæ­¢åŠ¨ç”»<br>ã€€ã€€<strong>- (BOOL)isAnimating</strong>;  æ˜¯å¦æ­£åœ¨è¿è¡ŒåŠ¨ç”»</p>
<h5 id="UIActivityIndicatorView"><a href="#UIActivityIndicatorView" class="headerlink" title="UIActivityIndicatorView"></a>UIActivityIndicatorView</h5><p>æ˜¯ä¸€ä¸ªæ—‹è½¬è¿›åº¦è½®ï¼Œå¯ä»¥ç”¨æ¥å‘ŠçŸ¥ç”¨æˆ·æœ‰ä¸€ä¸ªæ“ä½œæ­£åœ¨è¿›è¡Œä¸­ï¼Œä¸€èˆ¬ç”¨initWithActivityIndicatorStyleåˆå§‹åŒ–</p>
<p>ç›¸å…³æ–¹æ³•è§£æ:<br>ã€€ã€€<strong>- (void)startAnimating</strong>; å¼€å§‹åŠ¨ç”»<br>ã€€ã€€<strong>- (void)stopAnimating</strong>;  åœæ­¢åŠ¨ç”»<br>ã€€ã€€<strong>- (BOOL)isAnimating</strong>;  æ˜¯å¦æ­£åœ¨è¿è¡ŒåŠ¨ç”»</p>
<p>UIActivityIndicatorViewStyleæœ‰3ä¸ªå€¼å¯ä¾›é€‰æ‹©ï¼š<br>ã€€ã€€<strong>UIActivityIndicatorViewStyleWhiteLarge</strong>   //å¤§å‹ç™½è‰²æŒ‡ç¤ºå™¨<br>ã€€ã€€<strong>UIActivityIndicatorViewStyleWhite</strong>      //æ ‡å‡†å°ºå¯¸ç™½è‰²æŒ‡ç¤ºå™¨<br>ã€€ã€€<strong>UIActivityIndicatorViewStyleGray</strong>    //ç°è‰²æŒ‡ç¤ºå™¨ï¼Œç”¨äºç™½è‰²èƒŒæ™¯</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[iOSåŠ¨ç”»ç¯‡ä¹‹CoreAnimationåŠ¨ç”»]]></title>
      <url>http://yoursite.com/2016/02/27/iOS%E5%8A%A8%E7%94%BB%E7%AF%87%E4%B9%8BCoreAnimation%E5%8A%A8%E7%94%BB/</url>
      <content type="html"><![CDATA[<p>Appå¦‚æœæƒ³è¢«å¤§ä¼—å–œæ¬¢ï¼Œæ¼‚äº®çš„UIå’Œç²¾ç¾çš„åŠ¨ç”»éƒ½æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œè‹¹æœè™½ç„¶ä¸ºUIViewæä¾›äº†ä¸€äº›å¸¸ç”¨åŠ¨ç”»ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†çœ‹èµ·æ¥æ¯”è¾ƒä¸é”™çš„æ•ˆæœéƒ½æ˜¯é€šè¿‡æ“ä½œLayerå±‚å®ç°çš„ï¼Œå› æ­¤äº†è§£æ ¸å¿ƒåŠ¨ç”»æ˜¯å¿…è¦çš„.CoreAnimationæ˜¯ç›´æ¥ä½œç”¨åœ¨CALayerä¸Šçš„(å¹¶éUIViewä¸Š)éå¸¸å¼ºå¤§çš„è·¨Mac OS Xå’ŒiOSå¹³å°çš„åŠ¨ç”»å¤„ç†APIï¼ŒCore Animationçš„åŠ¨ç”»æ‰§è¡Œè¿‡ç¨‹éƒ½æ˜¯åœ¨åå°æ“ä½œçš„ï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚<br><a id="more"></a></p>
<h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>å¼€å‘ä¸­ç”¨çš„æœ€å¤šçš„æ˜¯<code>CoreAnimation</code>åŠ¨ç”»åº“ï¼Œç®€ç§°æ˜¯CAï¼Œæ‰€ä»¥åŠ¨ç”»ç±»éƒ½æ˜¯CAå¼€å¤´ã€‚æ‰€æœ‰çš„åŠ¨ç”»ç±»éƒ½åœ¨<code>QuartzCore</code>åº“ä¸­ï¼Œåœ¨iOS7ä¹‹å‰ä½¿ç”¨éœ€è¦<code>#import &lt;QuartzCore/QuartzCore.h&gt;</code>,iOS7ä¹‹åç³»ç»Ÿå·²ç»å°†å…¶è‡ªåŠ¨å¯¼å…¥äº†ã€‚<code>CoreAnimation</code>åŠ¨ç”»éƒ½æ˜¯ä½œç”¨åœ¨<code>layer</code>ä¸Šã€‚<br>å…ˆæ¥çœ‹ä¸‹åŠ¨ç”»ç±»çš„å±‚çº§å…³ç³»ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_12.png?raw=true" alt="åŠ¨ç”»å±‚çº§ç»“æ„"><br></div><br>å…³äºä¸Šå›¾ä¸­çš„å±‚çº§ç»“æ„åªéœ€è¦äº†è§£ä¸€ä¸‹ï¼Œç”¨çš„å¤šäº†ï¼Œè‡ªç„¶å°±è®°ä½äº†ã€‚æœ¬ç¯‡åªè®²è¿°<code>CABasicAnimation</code>ã€<code>CAKeyframeAnimation</code>ã€<code>CAAnimationGroup</code>çš„ä½¿ç”¨ã€‚<br><br>### ä½¿ç”¨<br>ä¸Šé¢è®²äº†CAåŠ¨ç”»éƒ½æ˜¯ä½œç”¨åœ¨Layerä¸Šï¼Œè€ŒCAåŠ¨ç”»ä¸­ä¿®æ”¹çš„ä¹Ÿæ˜¯Layerçš„åŠ¨ç”»å±æ€§ï¼Œå¯ä»¥äº§ç”ŸåŠ¨ç”»çš„layerå±æ€§ä¹Ÿæœ‰<code>Animatable</code>æ ‡è¯†ã€‚<br>#### 1.CABasicAnimation<br><code>CABasicAnimation</code>åŠ¨ç”»ä¸»è¦æ˜¯è®¾ç½®æŸä¸ªåŠ¨ç”»å±æ€§çš„åˆå§‹å€¼fromValueå’Œç»“æŸå€¼toValueï¼Œæ¥äº§ç”ŸåŠ¨ç”»æ•ˆæœã€‚<br>å…ˆä¸Šä¸ªç¤ºä¾‹ä»£ç ï¼Œå°†ä¸€ä¸ªè§†å›¾å¾€ä¸Šç§»åŠ¨ä¸€æ®µè·ç¦»ï¼š<br><div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_13.gif?raw=true" alt="animation"><br></div>

<pre><code>
CABasicAnimation *postionAnimation = [CABasicAnimation animationWithKeyPath:@"position.y"];
postionAnimation.duration = 1.0f;
postionAnimation.fromValue = @(self.squareView.center.y);
postionAnimation.toValue = @(self.squareView.center.y - 300);
postionAnimation.removedOnCompletion = NO;
postionAnimation.delegate = self;
postionAnimation.autoreverses = YES;
postionAnimation.fillMode = kCAFillModeForwards;
postionAnimation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
[self.squareView.layer addAnimation:postionAnimation forKey:@"posstionAnimation"];
</code></pre>

<blockquote>
<ul>
<li>åŠ¨ç”»çš„åˆ›å»ºä½¿ç”¨<code>animationWithKeyPath:</code>,å› ä¸ºä½¿ç”¨çš„keyPathæ‰€ä»¥åŠ¨ç”»å±æ€§æˆ–è€…å…¶ç»“æ„ä½“ä¸­å…ƒç´ éƒ½å¯ä»¥äº§ç”ŸåŠ¨ç”»ã€‚</li>
<li><code>duration</code> åŠ¨ç”»çš„æ—¶é•¿ã€‚</li>
<li><code>fromValue</code>å’Œ<code>toValue</code> æ˜¯<code>CABasicAnimation</code>çš„å±æ€§ï¼Œéƒ½æ˜¯idç±»å‹çš„ï¼Œæ‰€ä»¥è¦å°†åŸºæœ¬ç±»å‹åŒ…è£…æˆå¯¹è±¡ã€‚</li>
<li><code>removedOnCompletion</code> å†³å®šåŠ¨ç”»æ‰§è¡Œå®Œä¹‹åæ˜¯å¦å°†è¯¥åŠ¨ç”»çš„å½±å“ç§»é™¤ï¼Œé»˜è®¤æ˜¯YES,åˆ™layerå›åˆ°åŠ¨ç”»å‰çš„çŠ¶æ€ã€‚</li>
<li><code>fillMode</code> æ˜¯ä¸ªæšä¸¾å€¼ï¼ˆå››ç§ï¼‰ï¼Œå½“<code>removedOnCompletion</code>è®¾ç½®ä¸ºNOä¹‹åæ‰ä¼šèµ·ä½œç”¨ã€‚å¯ä»¥è®¾ç½®layeræ˜¯ä¿æŒåŠ¨ç”»å¼€å§‹å‰çš„çŠ¶æ€è¿˜æ˜¯åŠ¨ç”»ç»“æŸåçš„çŠ¶æ€ï¼Œæˆ–æ˜¯å…¶ä»–çš„ã€‚</li>
<li><code>autoreverses</code> è¡¨ç¤ºåŠ¨ç”»ç»“æŸåæ˜¯å¦ backwards(å›é€€) åˆ°åŠ¨ç”»å¼€å§‹å‰çš„çŠ¶æ€ã€‚å¯ä¸ä¸Šé¢ä¸¤ä¸ªå±æ€§ç»„åˆå‡ºä¸åŒæ•ˆæœã€‚</li>
<li><code>timingFunction</code> åŠ¨ç”»çš„è¿åŠ¨æ˜¯åŒ€é€Ÿçº¿æ€§çš„è¿˜æ˜¯å…ˆå¿«åæ…¢ç­‰ï¼Œç±»ä¼¼UIViewåŠ¨ç”»çš„opitionsã€‚å¦å¤–ï¼ŒCAMediaTimingFunction æ–¹æ³•å¯ä»¥è‡ªå®šä¹‰ã€‚</li>
<li><code>delegate</code> ä»£ç†ï¼Œä¸¤ä¸ªåŠ¨ç”»ä»£ç†æ–¹æ³•ï¼š<code>- (void)animationDidStart:(CAAnimation *)anim</code>; å’Œ<code>- (void)animationDidStop:(CAAnimation *)anim finished:(BOOL)flag</code>;</li>
<li><code>-(void)addAnimation:(CAAnimation *)anim forKey:(nullable NSString *)key</code>; ç»™æŸä¸ªlayeræ·»åŠ åŠ¨ç”»ï¼Œä¸ä¹‹å¯¹åº”çš„ç§»é™¤æŸä¸ªåŠ¨ç”»æ˜¯<code>- (void)removeAnimationForKey:(NSString *)key</code>;</li>
<li>è¿˜æœ‰ä¸€äº›å…¶ä»–çš„å±æ€§ï¼Œå°±ä¸ä¸€ä¸€ä»‹ç»äº†ï¼Œå¯ä»¥åœ¨ä½¿ç”¨çš„ä½¿ç”¨å».hæ–‡ä»¶ä¸­æŸ¥çœ‹ã€‚</li>
</ul>
</blockquote>
<p>åœ¨è¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹fillMode<br>æ³¨æ„ï¼šfillModeè¿™ä¸ªå±æ€§ï¼Œå¿…é¡»è¦é…åˆä¸‹é¢è¿™ä¸ªå±æ€§æ¥ä½¿ç”¨ã€‚è¿™ä¸ªå±æ€§çš„é»˜è®¤å€¼æ˜¯YES(å›åˆ°åŸå¤„),æ­¤æ—¶fillModeæ˜¯æ²¡æœ‰ä½œç”¨çš„å¦‚æœè®¾ç½®ä¸ºNOé‚£ä¹ˆå°±éœ€è¦è®¾ç½®ä¸€ä¸ªfillModeå±æ€§ï¼Œå°±æ˜¯åŠ¨ç”»ç»“æŸä¹‹åçš„çŠ¶æ€ï¼Œå¦‚æœä¸è®¾ç½®ï¼ŒåŠ¨ç”»ä¹Ÿä¼šå›åˆ°åŸå¤„ã€‚</p>
<p><code>postionAnimation.removedOnCompletion = NO;</code></p>
<pre><code>
kCAFillModeRemoved è¿™ä¸ªæ˜¯é»˜è®¤å€¼,ä¹Ÿå°±æ˜¯è¯´å½“åŠ¨ç”»å¼€å§‹å‰å’ŒåŠ¨ç”»ç»“æŸå,åŠ¨ç”»å¯¹layeréƒ½æ²¡æœ‰å½±å“,åŠ¨ç”»ç»“æŸå,layerä¼šæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€ 
kCAFillModeForwards å½“åŠ¨ç”»ç»“æŸå,layerä¼šä¸€ç›´ä¿æŒç€åŠ¨ç”»æœ€åçš„çŠ¶æ€ 
kCAFillModeBackwards è¿™ä¸ªå’ŒkCAFillModeForwardsæ˜¯ç›¸å¯¹çš„,å°±æ˜¯åœ¨åŠ¨ç”»å¼€å§‹å‰,ä½ åªè¦å°†åŠ¨ç”»åŠ å…¥äº†
ä¸€ä¸ªlayer,layerä¾¿ç«‹å³è¿›å…¥åŠ¨ç”»çš„åˆå§‹çŠ¶æ€å¹¶ç­‰å¾…åŠ¨ç”»å¼€å§‹.ä½ å¯ä»¥è¿™æ ·è®¾å®šæµ‹è¯•ä»£ç ,å°†ä¸€ä¸ªåŠ¨ç”»åŠ å…¥ä¸€ä¸ª
layerçš„æ—¶å€™å»¶è¿Ÿ5ç§’æ‰§è¡Œ.ç„¶åå°±ä¼šå‘ç°åœ¨åŠ¨ç”»æ²¡æœ‰å¼€å§‹çš„æ—¶å€™,åªè¦åŠ¨ç”»è¢«åŠ å…¥äº†layer,layerä¾¿å¤„äºåŠ¨ç”»åˆ
å§‹çŠ¶æ€ 
kCAFillModeBoth ç†è§£äº†ä¸Šé¢ä¸¤ä¸ª,è¿™ä¸ªå°±å¾ˆå¥½ç†è§£äº†,è¿™ä¸ªå…¶å®å°±æ˜¯ä¸Šé¢ä¸¤ä¸ªçš„åˆæˆ.åŠ¨ç”»åŠ å…¥åå¼€å§‹ä¹‹
å‰,layerä¾¿å¤„äºåŠ¨ç”»åˆå§‹çŠ¶æ€,åŠ¨ç”»ç»“æŸålayerä¿æŒåŠ¨ç”»æœ€åçš„çŠ¶æ€.</code></pre>    


<h5 id="Rotationæ—‹è½¬"><a href="#Rotationæ—‹è½¬" class="headerlink" title="Rotationæ—‹è½¬"></a>Rotationæ—‹è½¬</h5><ul>
<li><strong>Zè½´</strong></li>
</ul>
<pre><code>
CABasicAnimation *rotationAnimation = [CABasicAnimation animationWithKeyPath:@"transform.rotation"];
rotationAnimation.fromValue = [NSNumber numberWithFloat:0.0];
rotationAnimation.toValue = [NSNumber numberWithFloat:2*M_PI];
rotationAnimation.repeatCount = MAXFLOAT;
rotationAnimation.duration =10;
[self.rotationImgView.layer addAnimation:rotationAnimation forKey:@"transform.rotation.z"];
</code></pre>

<ul>
<li><strong>Xè½´</strong></li>
</ul>
<pre><code>
CABasicAnimation *rotationXAnimation = [CABasicAnimation animationWithKeyPath:@"transform.rotation.x"];
rotationXAnimation.fromValue = [NSNumber numberWithFloat:0.0];
rotationXAnimation.toValue = [NSNumber numberWithFloat:2*M_PI];
rotationXAnimation.repeatCount = MAXFLOAT;
rotationXAnimation.duration =3;
[self.rotationXImgView.layer addAnimation:rotationXAnimation forKey:@"transform.rotation.x"];
</code></pre>

<ul>
<li><strong>Yè½´</strong></li>
</ul>
<pre><code>
CABasicAnimation *rotationYAnimation = [CABasicAnimation animationWithKeyPath:@"transform.rotation.y"];
rotationYAnimation.fromValue = [NSNumber numberWithFloat:0.0];
rotationYAnimation.toValue = [NSNumber numberWithFloat:2*M_PI];
rotationYAnimation.repeatCount = MAXFLOAT;
rotationYAnimation.duration =10;
[self.rotationYImgView.layer addAnimation:rotationYAnimation forKey:@"transform.rotation.y"];
</code></pre>

<h5 id="Scaleæ”¾å¤§ç¼©å°"><a href="#Scaleæ”¾å¤§ç¼©å°" class="headerlink" title="Scaleæ”¾å¤§ç¼©å°"></a>Scaleæ”¾å¤§ç¼©å°</h5><ul>
<li><strong>ä»»æ„æ–¹å‘æ”¾å¤§</strong></li>
</ul>
<pre><code>
CABasicAnimation *scaleAnimation = [CABasicAnimation animationWithKeyPath:@"transform.scale"];
scaleAnimation.fromValue = [NSNumber numberWithFloat:1.0];
scaleAnimation.toValue = [NSNumber numberWithFloat:1.5];
scaleAnimation.autoreverses = YES;//è‡ªåŠ¨åå‘æ‰§è¡ŒåŠ¨ç”»æ•ˆæœ
scaleAnimation.repeatCount = MAXFLOAT;
scaleAnimation.duration = 0.8;
[self.scaleImgView.layer addAnimation:scaleAnimation forKey:@"FlyElephant.scale"];
</code></pre>

<ul>
<li><strong>Xè½´æ”¾å¤§</strong></li>
</ul>
<pre><code>
CABasicAnimation *scaleXAnimation = [CABasicAnimation animationWithKeyPath:@"transform.scale.x"];
scaleXAnimation.fromValue = [NSNumber numberWithFloat:1.0];
scaleXAnimation.toValue = [NSNumber numberWithFloat:1.5];
scaleXAnimation.autoreverses = YES;//è‡ªåŠ¨åå‘æ‰§è¡ŒåŠ¨ç”»æ•ˆæœ
scaleXAnimation.repeatCount = MAXFLOAT;
scaleXAnimation.duration = 0.8;
[self.scaleXImgView.layer addAnimation:scaleXAnimation forKey:@"FlyElephant.scale.x"];
</code></pre>

<ul>
<li><strong>Yè½´æ”¾å¤§</strong></li>
</ul>
<pre><code>
CABasicAnimation *scaleYAnimation = [CABasicAnimation animationWithKeyPath:@"transform.scale.y"];
scaleYAnimation.fromValue = [NSNumber numberWithFloat:1.0];
scaleYAnimation.toValue = [NSNumber numberWithFloat:1.5];
scaleYAnimation.autoreverses = YES;//è‡ªåŠ¨åå‘æ‰§è¡ŒåŠ¨ç”»æ•ˆæœ
scaleYAnimation.repeatCount = MAXFLOAT;
scaleYAnimation.duration = 0.8;
[self.scaleYImgView.layer addAnimation:scaleYAnimation forKey:@"FlyElephant.scale.y"];
</code></pre>

<ul>
<li><strong>Zè½´æ”¾å¤§</strong></li>
</ul>
<pre><code>
CABasicAnimation *scaleZAnimation = [CABasicAnimation animationWithKeyPath:@"transform.scale.z"];
scaleZAnimation.fromValue = [NSNumber numberWithFloat:1.0];
scaleZAnimation.toValue = [NSNumber numberWithFloat:1.5];
scaleZAnimation.autoreverses = YES;//è‡ªåŠ¨åå‘æ‰§è¡ŒåŠ¨ç”»æ•ˆæœ
scaleZAnimation.repeatCount = MAXFLOAT;
scaleZAnimation.duration = 0.8;
[self.scaleZImgView.layer addAnimation:scaleZAnimation forKey:@"FlyElephant.scale.z"];
</code></pre>

<h5 id="Translationå¹³ç§»"><a href="#Translationå¹³ç§»" class="headerlink" title="Translationå¹³ç§»"></a>Translationå¹³ç§»</h5><ul>
<li><strong>Xè½´å¹³ç§»</strong></li>
</ul>
<pre><code>
CABasicAnimation *translationX=[CABasicAnimation animationWithKeyPath:@"transform.translation.x"];
translationX.toValue=@(200);
translationX.duration=5;
translationX.removedOnCompletion=NO;
translationX.fillMode=kCAFillModeForwards;
translationX.repeatCount=MAXFLOAT;
translationX.autoreverses=YES;
[self.translationXImgView.layer addAnimation:translationX forKey:@"FlyElephant.translation.x"];

</code></pre>

<ul>
<li><strong>Yè½´å¹³ç§»</strong></li>
</ul>
<pre><code>
CABasicAnimation *translationY=[CABasicAnimation animationWithKeyPath:@"transform.translation.y"];
translationY.toValue=@(100);
translationY.duration=5;
translationY.removedOnCompletion=NO;
translationY.fillMode=kCAFillModeForwards;
translationY.repeatCount=MAXFLOAT;
translationY.autoreverses=YES;
[self.translationYImgView.layer addAnimation:translationY forKey:@"FlyElephant.translation.y"];
</code></pre>

<ul>
<li><strong>XYè½´å¹³ç§»</strong></li>
</ul>
<pre><code>
CABasicAnimation *translation=[CABasicAnimation animationWithKeyPath:@"transform.translation"];
translation.toValue=[NSValue valueWithCGPoint:CGPointMake(100, 100)];
translation.duration=5;
translation.removedOnCompletion=NO;
translation.fillMode=kCAFillModeForwards;
translation.repeatCount=MAXFLOAT;
translation.autoreverses=YES;
[self.translationImgView.layer addAnimation:translation forKey:@"FlyElephant.translation"];
</code></pre>

<p><font color="blue"><strong>åŠ¨ç”»å®ä¾‹å›¾ï¼š</strong></font></p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_14.gif?raw=true" alt="animation"><br></div>

<h4 id="2-CAKeyframeAnimation"><a href="#2-CAKeyframeAnimation" class="headerlink" title="2.CAKeyframeAnimation"></a>2.CAKeyframeAnimation</h4><p>CAKeyframeAnimationæˆ‘ä»¬ä¸€èˆ¬ç§°ä¸ºå…³é”®å¸§åŠ¨ç”»ï¼Œä¸»è¦æ˜¯åˆ©ç”¨å…¶valueså±æ€§ï¼Œè®¾ç½®å¤šä¸ªå…³é”®å¸§å±æ€§å€¼ï¼Œæ¥äº§ç”ŸåŠ¨ç”»ã€‚</p>
<h5 id="åŸºäºScaleå˜æ¢"><a href="#åŸºäºScaleå˜æ¢" class="headerlink" title="åŸºäºScaleå˜æ¢:"></a>åŸºäºScaleå˜æ¢:</h5><div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_15.gif?raw=true" alt="animation"><br></div>

<pre><code>
CAKeyframeAnimation *keyAnimation = [CAKeyframeAnimation animationWithKeyPath:@"transform"];
keyAnimation.duration = 1.0f;
keyAnimation.beginTime = CACurrentMediaTime() + 1.0;

CATransform3D transform1 = CATransform3DMakeScale(1.5, 1.5, 0);
CATransform3D transform2 = CATransform3DMakeScale(0.8, 0.8, 0);
CATransform3D transform3 = CATransform3DMakeScale(3, 3, 0);

keyAnimation.values = @[[NSValue valueWithCATransform3D:transform1],[NSValue valueWithCATransform3D:transform2],[NSValue valueWithCATransform3D:transform3]];
keyAnimation.keyTimes = @[@0,@0.5,@1];
keyAnimation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
keyAnimation.removedOnCompletion = NO;
keyAnimation.fillMode = kCAFillModeForwards;
[_someView.layer addAnimation:keyAnimation forKey:nil];
</code></pre>

<blockquote>
<ul>
<li><code>beginTime</code> ä¹Ÿæ˜¯<code>CAAnimation</code>ç±»çš„å±æ€§ï¼Œå¯ä»¥è®¾ç½®åŠ¨ç”»å»¶è¿Ÿå¤šä¹…æ‰§è¡Œï¼Œç¤ºä¾‹ä»£ç æ˜¯å»¶è¿Ÿ1ç§’æ‰§è¡Œã€‚</li>
<li><code>values</code> æ˜¯<code>CAKeyframeAnimation</code>çš„å±æ€§ï¼Œè®¾ç½®keyPathå±æ€§åœ¨å‡ ä¸ªå…³é”®å¸§çš„å€¼ï¼Œä¹Ÿæ˜¯idç±»å‹çš„ã€‚</li>
<li><code>keyTimes</code> ä¹Ÿæ˜¯<code>CAKeyframeAnimation</code>çš„å±æ€§ï¼Œæ¯ä¸ªå€¼å¯¹åº”ç›¸åº”å…³é”®å¸§çš„æ—¶é—´æ¯”ä¾‹å€¼ã€‚</li>
<li><code>timingFunctions</code> ä¹Ÿæ˜¯<code>CAKeyframeAnimation</code>çš„å±æ€§ï¼Œå¯¹åº”æ¯ä¸ªåŠ¨ç”»æ®µçš„åŠ¨ç”»è¿‡æ¸¡æƒ…å†µï¼›è€Œ<code>timingFunction</code>æ˜¯<code>CAAnimation</code>çš„å±æ€§ã€‚</li>
</ul>
</blockquote>
<h5 id="åŸºäºPointçš„å˜æ¢"><a href="#åŸºäºPointçš„å˜æ¢" class="headerlink" title="åŸºäºPointçš„å˜æ¢:"></a>åŸºäºPointçš„å˜æ¢:</h5><div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_16.gif?raw=true" alt="animation"><br></div>

<pre><code>
CGPoint p1=CGPointMake(self.positionImgView.center.x, self.positionImgView.center.y);
CGPoint p2=CGPointMake(80, 100);
CGPoint p3=CGPointMake(100, 120);

CGPoint p4=CGPointMake(120, 150);
CGPoint p5=CGPointMake(140, 160);
NSArray *values=[NSArray arrayWithObjects:[NSValue valueWithCGPoint:p1],[NSValue valueWithCGPoint:p2],[NSValue valueWithCGPoint:p3],[NSValue valueWithCGPoint:p4],[NSValue valueWithCGPoint:p5], nil];
CAKeyframeAnimation *animation = [CAKeyframeAnimation animationWithKeyPath:@"position"];
[animation setValues:values];
[animation setDuration:10.0];
[animation setCalculationMode:kCAAnimationCubic];
animation.timingFunction=[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn];
[self.positionImgView.layer addAnimation:animation forKey:@"FlyElephant.point"];
</code></pre>

<h5 id="åŸºäºPathçš„å˜æ¢"><a href="#åŸºäºPathçš„å˜æ¢" class="headerlink" title="åŸºäºPathçš„å˜æ¢:"></a>åŸºäºPathçš„å˜æ¢:</h5><div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_17.gif?raw=true" alt="animation"><br></div>

<pre><code>
CGMutablePathRef path = CGPathCreateMutable();
CGPathMoveToPoint(path,NULL,self.positionImgView.center.x,self.positionImgView.center.y);
for(NSInteger i = 1; i < 5 i++){
    CGPathAddLineToPoint(path, NULL, self.positionImgView.center.x+i*10,     self.positionImgView.center.y);
}
//æ›²çº¿
CGPathAddCurveToPoint(path,NULL,50.0,275.0,150.0,275.0,70.0,120.0);
CGPathAddCurveToPoint(path,NULL,150.0,275.0,250.0,275.0,90.0,120.0);
CGPathAddCurveToPoint(path,NULL,250.0,275.0,350.0,275.0,110.0,120.0);
CGPathAddCurveToPoint(path,NULL,350.0,275.0,450.0,275.0,130.0,120.0);
CAKeyframeAnimation *animation = [CAKeyframeAnimation animationWithKeyPath:@"position"];
[animation setPath:path];
[animation setDuration:3.0];
// [animation setAutoreverses:YES];
CFRelease(path);
[self.positionImgView.layer addAnimation:animation:@"FlyElephant"];
</code></pre>

<p>é€šè¿‡ä»£ç æˆ‘ä»¬å‘ç°ï¼ŒPathå’Œvaluesæ¥æ”¶éƒ½æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå›ºå®šå€¼ï¼Œè¿™é‡Œé¢æˆ‘ä»¬æ²¡æœ‰è®¾ç½®keyTimesï¼Œä¸‹é¢çœ‹ä¸€ä¸ªå¸¸è§çš„æŠ–åŠ¨æ•ˆæœ:</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_18.gif?raw=true" alt="animation"><br></div>

<pre><code>
CAKeyframeAnimation *animation = [CAKeyframeAnimation animation];
animation.keyPath = @"position.x";
animation.values = @[ @0, @20, @-20, @20, @0 ];
animation.keyTimes = @[ @0, @(1 /8.0), @(1/ 2.0), @(7/ 8.0), @1 ];
animation.duration =0.5;
animation.additive = YES;
[self.textField.layer addAnimation:animation forKey:@"FlyElephant.Shake"];
</code></pre>

<h4 id="3-CAAnimationGroup"><a href="#3-CAAnimationGroup" class="headerlink" title="3.CAAnimationGroup"></a>3.CAAnimationGroup</h4><p>CAAnimationGroupçš„ç”¨æ³•ä¸å…¶ä»–åŠ¨ç”»ç±»ä¸€æ ·ï¼Œéƒ½æ˜¯æ·»åŠ åˆ°layerä¸Šï¼Œæ¯”CAAnimationå¤šäº†ä¸€ä¸ªanimationså±æ€§ã€‚<br>å…ˆçœ‹ç¤ºä¾‹ä»£ç ï¼ŒåŠ¨ç”»æ•ˆæœæ˜¯è§†å›¾ä¸€è¾¹å‘ä¸Šç§»åŠ¨ï¼Œä¸€è¾¹ç»•Yè½´æ—‹è½¬ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_19.gif?raw=true" alt="animation"><br></div>

<pre><code>
CABasicAnimation *rotationYAnimation = [CABasicAnimation animationWithKeyPath:@"transform.rotation.y"];
rotationYAnimation.fromValue = @0;
rotationYAnimation.toValue = @(M_PI);
rotationYAnimation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];

CABasicAnimation *postionAnimation = [CABasicAnimation animationWithKeyPath:@"position.y"];
postionAnimation.fromValue = @(_markView.center.y);
postionAnimation.toValue = @(_markView.center.y - 100);
postionAnimation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];

CAAnimationGroup *animationGroup = [CAAnimationGroup animation];
animationGroup.duration = kUpDuration;
animationGroup.removedOnCompletion = NO;
animationGroup.fillMode = kCAFillModeForwards;
animationGroup.delegate = self;
animationGroup.animations = @[rotationYAnimation, postionAnimation];

[_markView.layer addAnimation:animationGroup forKey:kJumpAnimation];
</code></pre>

<blockquote>
<p>CAAnimationGroupçš„animationsä¸­å¯ä»¥æ”¾å…¶ä»–ä»»ä½•åŠ¨ç”»ç±»ï¼ˆåŒ…æ‹¬CAAnimationGroupï¼‰ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯animationsé‡Œçš„åŠ¨ç”»è®¾ç½®äº†durationä¹‹ååŠ¨ç”»å¯èƒ½ä¼šæœ‰ä¸åŒï¼Œä¸€èˆ¬é‡Œé¢ä¸è®¾ç½®ï¼Œåœ¨æœ€å¤–å±‚è®¾ç½®groupçš„durationå³å¯ã€‚</p>
</blockquote>
<h5 id="AnimationWithKeyPathçš„å€¼"><a href="#AnimationWithKeyPathçš„å€¼" class="headerlink" title="AnimationWithKeyPathçš„å€¼"></a>AnimationWithKeyPathçš„å€¼</h5><p>æœ€å¼€å§‹åšåŠ¨ç”»ä¸€èˆ¬éƒ½ä¼šå¯¹keyPathè¿™ä¸ªå€¼è«åå…¶å¦™ï¼Œå› ä¸ºå®ƒä¸æ˜¯å¸¸é‡ï¼Œéœ€è¦å˜æ¢çš„æ—¶å€™æ‰¾ä¸åˆ°å¯¹åº”çš„éœ€è¦è®¾ç½®çš„å€¼ï¼Œå¦‚æœä½ åœ¨ç½‘ä¸Šæœç´¢ï¼Œå¾ˆå¯èƒ½çœ‹åˆ°çš„æ˜¯è¿™å¼ å›¾:</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_20.png?raw=true" alt="animation"><br></div><br>ä¸‹é¢è¿™å¼ å›¾ä½ åŸºæœ¬ä¸Šæ˜¯æ‰¾ä¸åˆ°çš„ï¼Œå¦‚ä¸‹:<br><div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_21.png?raw=true" alt="animation"><br></div>

<h4 id="4-CATransition"><a href="#4-CATransition" class="headerlink" title="4.CATransition"></a>4.CATransition</h4><p>CATransitionä¸€èˆ¬æ¥åšè½¬åœºåŠ¨ç”»ã€‚å…ˆä¸ŠgifåŠ¨ç”»æ•ˆæœ</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_22.gif?raw=true" alt="animation"><br></div>

<pre><code>
//ä¿®æ”¹è§†å›¾çš„èƒŒæ™¯è‰²
_someView.backgroundColor = [UIColor greenColor];
CATransition *animation = [CATransition animation];
animation.duration = 0.5;
/* è¿™é‡Œå¯è®¾ç½®çš„å‚æ•°æœ‰ï¼škCATransitionFadeã€kCATransitionPushã€kCATransitionRevealã€kCATransitionMoveInã€
"cube"ã€"suckEffect"ã€"oglFlip"ã€"rippleEffect"ã€"pageCurl"ã€"pageUnCurl"ã€"cameraIrisHollowOpen"ã€
 "cameraIrisHollowClose"ï¼Œè¿™äº›éƒ½æ˜¯åŠ¨ç”»ç±»å‹
*/
animation.type = @"cube";
// åŠ¨ç”»æ‰§è¡Œçš„æ–¹å‘ï¼ŒkCATransitionFromRightã€kCATransitionFromLeftã€kCATransitionFromTopã€kCATransitionFromBottom
animation.subtype = kCATransitionFromRight;
animation.timingFunction = UIViewAnimationOptionCurveEaseInOut;
[_someView.layer addAnimation:animation forKey:nil];
//ä¹Ÿå¯ä»¥å†™è¿™é‡Œ
//    _someView.backgroundColor = [UIColor greenColor];
</code></pre>

<p>åªéœ€è¦åœ¨åŠ¨ç”»å¼€å§‹å‰æˆ–è€…åŠ¨ç”»å¼€å§‹åæ›¿æ¢æ‰è§†å›¾ä¸Šæ˜¾ç¤ºçš„å†…å®¹å³å¯ã€‚å…·ä½“å¯ä»¥çœ‹æˆ‘çš„è¿™ç¯‡åšå®¢<a href="http://www.guiyongdong.com/2016/09/22/iOS%E5%8A%A8%E7%94%BB%E4%B9%8BCATransition%E5%8A%A8%E7%94%BB/" target="_blank" rel="external">iOSåŠ¨ç”»ä¹‹CATransitionåŠ¨ç”»</a></p>
<h4 id="é™„åŠ "><a href="#é™„åŠ " class="headerlink" title="é™„åŠ "></a>é™„åŠ </h4><p>é™„åŠ çš„å†…å®¹æ˜¯å…³äºCALayerå’ŒUIBezierPathã€‚ä¸ªäººè§‰å¾—ç†è§£äº†UIBezierPathå’ŒCALayer,æ‰èƒ½æ›´å¥½çš„ç†è§£CoreAnimationåŠ¨ç”»ã€‚</p>
<h5 id="1-UIBezierPath"><a href="#1-UIBezierPath" class="headerlink" title="1.UIBezierPath"></a>1.UIBezierPath</h5><p>UIBezierPathä¸»è¦æ˜¯ç”¨æ¥ç»˜åˆ¶è·¯å¾„çš„ï¼Œåˆ†ä¸ºä¸€é˜¶ã€äºŒé˜¶â€¦..né˜¶ã€‚ä¸€é˜¶æ˜¯ç›´çº¿ï¼ŒäºŒé˜¶ä»¥ä¸Šæ‰æ˜¯æ›²çº¿ã€‚è€Œæœ€ç»ˆè·¯å¾„çš„æ˜¾ç¤ºè¿˜æ˜¯å¾—ä¾é CALayerã€‚ç”¨CoreGraphicså°†è·¯å¾„ç»˜åˆ¶å‡ºæ¥ï¼Œæœ€ç»ˆä¹Ÿæ˜¯ç»˜åˆ¶åˆ°CALayerä¸Šã€‚</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_23.png?raw=true" alt="animation"><br></div>

<blockquote>
<p>æ–¹æ³•ä¸€ï¼šæ„é€ bezierPathå¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºè‡ªå®šä¹‰è·¯å¾„ã€‚<br>æ–¹æ³•äºŒï¼šç»˜åˆ¶åœ†å¼§è·¯å¾„ï¼Œå‚æ•°1æ˜¯ä¸­å¿ƒç‚¹ä½ç½®ï¼Œå‚æ•°2æ˜¯åŠå¾„ï¼Œå‚æ•°3æ˜¯å¼€å§‹çš„å¼§åº¦å€¼ï¼Œå‚æ•°4æ˜¯ç»“æŸçš„å¼§åº¦å€¼ï¼Œå‚æ•°5æ˜¯æ˜¯å¦é¡ºæ—¶é’ˆ(YESæ˜¯é¡ºæ—¶é’ˆæ–¹å‘ï¼ŒNOé€†æ—¶é’ˆ)ã€‚<br>æ–¹æ³•ä¸‰ï¼šæ ¹æ®æŸä¸ªè·¯å¾„ç»˜åˆ¶è·¯å¾„ã€‚<br>æ–¹æ³•å››ï¼šæ ¹æ®æŸä¸ªCGRectç»˜åˆ¶å†…åˆ‡åœ†æˆ–æ¤­åœ†ï¼ˆCGRectæ˜¯æ­£æ–¹å½¢å³ä¸ºåœ†ï¼Œä¸ºé•¿æ–¹å½¢åˆ™ä¸ºæ¤­åœ†ï¼‰ã€‚<br>æ–¹æ³•äº”ï¼šæ ¹æ®æŸä¸ªCGRectç»˜åˆ¶è·¯å¾„ã€‚<br>æ–¹æ³•å…­ï¼šç»˜åˆ¶å¸¦åœ†è§’çš„çŸ©å½¢è·¯å¾„ï¼Œå‚æ•°2å“ªä¸ªè§’ï¼Œå‚æ•°3ï¼Œæ¨ªã€çºµå‘åŠå¾„ã€‚<br>æ–¹æ³•ä¸ƒï¼šç»˜åˆ¶æ¯ä¸ªè§’éƒ½æ˜¯åœ†è§’çš„çŸ©å½¢ï¼Œå‚æ•°2æ˜¯åŠå¾„ã€‚</p>
</blockquote>
<p>è‡ªå®šä¹‰è·¯å¾„æ—¶å¸¸ç”¨çš„API:</p>
<pre><code>
- (void)moveToPoint:(CGPoint)point; // ç§»åˆ°æŸä¸ªç‚¹
- (void)addLineToPoint:(CGPoint)point; // ç»˜åˆ¶ç›´çº¿
- (void)addCurveToPoint:(CGPoint)endPoint controlPoint1:(CGPoint)controlPoint1 controlPoint2:(CGPoint)controlPoint2; //ç»˜åˆ¶è´å¡å°”æ›²çº¿
- (void)addQuadCurveToPoint:(CGPoint)endPoint controlPoint:(CGPoint)controlPoint; // ç»˜åˆ¶è§„åˆ™çš„è´å¡å°”æ›²çº¿
- (void)addArcWithCenter:(CGPoint)center radius:(CGFloat)radius startAngle:(CGFloat)startAngle endAngle:(CGFloat)endAngle clockwise:(BOOL)clockwise
// ç»˜åˆ¶åœ†å½¢æ›²çº¿
- (void)appendPath:(UIBezierPath *)bezierPath; // æ‹¼æ¥æ›²çº¿
</code></pre>

<h5 id="å¦‚æœå°†è·¯å¾„æ˜¾ç¤ºçš„å›¾æ¡ˆæ˜¾ç¤ºåˆ°è§†å›¾ä¸Šå‘¢ï¼Ÿ"><a href="#å¦‚æœå°†è·¯å¾„æ˜¾ç¤ºçš„å›¾æ¡ˆæ˜¾ç¤ºåˆ°è§†å›¾ä¸Šå‘¢ï¼Ÿ" class="headerlink" title="å¦‚æœå°†è·¯å¾„æ˜¾ç¤ºçš„å›¾æ¡ˆæ˜¾ç¤ºåˆ°è§†å›¾ä¸Šå‘¢ï¼Ÿ"></a>å¦‚æœå°†è·¯å¾„æ˜¾ç¤ºçš„å›¾æ¡ˆæ˜¾ç¤ºåˆ°è§†å›¾ä¸Šå‘¢ï¼Ÿ</h5><p>æœ‰ä¸‰ç§æ–¹å¼ï¼š1ã€ç›´æ¥ä½¿ç”¨UIBezierPathçš„æ–¹æ³•ï¼›2ã€ä½¿ç”¨CoreGraphicsç»˜åˆ¶ï¼›3ã€åˆ©ç”¨CAShapeLayerç»˜åˆ¶ã€‚<br>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼Œç»˜åˆ¶ä¸€ä¸ªå³ä¾§ä¸ºå¼§å‹çš„è§†å›¾ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_24.gif?raw=true" alt="animation"><br></div>

<pre><code>
- (void)drawRect:(CGRect)rect
{
    UIColor *fillColor = [UIColor colorWithRed:0.0 green:0.722 blue:1.0 alpha:1.0];

    UIBezierPath *bezierPath = [UIBezierPath bezierPath];
    [bezierPath moveToPoint:CGPointMake(0, 0)];
    [bezierPath addLineToPoint:CGPointMake(rect.size.width - spaceWidth, 0)];
    [bezierPath addQuadCurveToPoint:CGPointMake(rect.size.width - spaceWidth, rect.size.height) controlPoint:CGPointMake(rect.size.width - spaceWidth + _deltaWith, rect.size.height * 0.5)];
    [bezierPath addLineToPoint:CGPointMake(0, rect.size.height)];
    [bezierPath addLineToPoint:CGPointMake(0, 0)];
    [bezierPath closePath];

    // 1ã€bezierPathæ–¹æ³•
//    [fillColor setFill];
//    [bezierPath fill];

    // 2ã€ä½¿ç”¨CoreGraphics
//    CGContextRef ctx = UIGraphicsGetCurrentContext();
//    CGContextAddPath(ctx, bezierPath.CGPath);
//    CGContextSetFillColorWithColor(ctx, fillColor.CGColor);
//    CGContextFillPath(ctx);

    // 3.CAShaperLayer
    [self.layer.sublayers makeObjectsPerformSelector:@selector(removeFromSuperlayer)];
    CAShapeLayer *shapeLayer = [CAShapeLayer layer];
    shapeLayer.path = bezierPath.CGPath;
    shapeLayer.fillColor = fillColor.CGColor;
    [self.layer addSublayer:shapeLayer];
}
</code></pre>

<p><div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_25.gif?raw=true" alt="animation"><br></div><br>ä¸Šå›¾è¿™æ ·çš„è§†å›¾æ˜¯ç”¨UIBezierPathç”¨å¤šä¸ªCAShapeLayeråˆ¶ä½œå‡ºæ¥çš„ï¼Œè€ŒåŠ¨ç”»æ•ˆæœåªéœ€è¦æ”¹å˜è¿›åº¦çš„layerçš„strokeEndå’Œä¿®æ”¹ä¸‹é¢ä»£è¡¨æ°´é¢è¿›åº¦çš„è§†å›¾ä½ç½®å³å¯ã€‚åŠ¨ç”»çš„ç»„åˆä¹Ÿå¯ä»¥æœ‰å¤šç§æ–¹å¼ç»„åˆ<br>åŠ¨ç”»çš„ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code>
- (void)setProgress:(CGFloat)progress animated:(BOOL)animated duration:(NSTimeInterval)duration
{
    CGFloat tempPro = progress;
    if (tempPro > 1.0) {
        tempPro = 1.0;
    } else if (progress < 0.0){
        tempPro = 0.0;
    }
    _progress = tempPro;

    CABasicAnimation *pathAniamtion = [CABasicAnimation animationWithKeyPath:@"strokeEnd"];
    pathAniamtion.duration = duration;
    pathAniamtion.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
    pathAniamtion.fromValue = [NSNumber numberWithFloat:0.0f];
    pathAniamtion.toValue = [NSNumber numberWithFloat:_progress];
    pathAniamtion.autoreverses = NO;
    [_progressLayer addAnimation:pathAniamtion forKey:nil];

    // æ°´ä½ä¸Šå‡çš„åŠ¨ç”»
    if (!_showSolidAnimation) {
        return;
    }

    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
        _imageView.transform = CGAffineTransformIdentity;
        [UIView animateWithDuration:duration animations:^{
            CGRect rect = _imageView.frame;
            CGFloat dy = rect.size.height * progress;
            _imageView.transform = CGAffineTransformMakeTranslation(0, -dy);
        }];
    });
}
</code></pre>

<p>åœ¨ç”¨è‡ªå®šä¹‰çš„CAShapeLayeråšåŠ¨ç”»æ—¶ï¼Œå»ºè®®åœ¨åŠ¨ç”»å¼€å§‹å‰å…ˆå°†åŠ¨ç”»å±æ€§ä¸æœ€ç»ˆçš„å±æ€§å€¼ä¸€è‡´ï¼Œå†å¼€å§‹åŠ¨ç”»ï¼Œä¸è¦ä½¿ç”¨removedOnCompletionæ§åˆ¶æœ€ç»ˆçš„çŠ¶æ€ï¼Œè¿™åœ¨WWDCè‹¹æœè¿™ä¹ˆå»ºè®®ã€‚</p>
<p><strong>å…·ä½“UIBezierPathå¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« <a href="http://www.guiyongdong.com/2016/09/22/UIBezierPath%E8%AF%A6%E8%A7%A3/" target="_blank" rel="external">UIBezierPathè¯¦è§£</a></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[iOSåŠ¨ç”»ä¹‹CATransitionåŠ¨ç”»]]></title>
      <url>http://yoursite.com/2016/02/08/iOS%E5%8A%A8%E7%94%BB%E4%B9%8BCATransition%E5%8A%A8%E7%94%BB/</url>
      <content type="html"><![CDATA[<p>ä»Šå¤©ä¸»è¦ç”¨åˆ°çš„åŠ¨ç”»ç±»æ˜¯CALayerä¸‹çš„CATransitionè‡³äºå„ç§åŠ¨ç”»ç±»ä¸­å¦‚ä½•ç»§æ‰¿çš„åœ¨è¿™ä¹Ÿä¸åšèµ˜è¿°ï¼Œç½‘ä¸Šçš„èµ„æ–™æ˜¯ä¸€æŠ“ä¸€å¤§æŠŠã€‚å¥½åºŸè¯å°‘è¯´åˆ‡å…¥ä»Šå¤©çš„æ­£é¢˜ã€‚</p>
<a id="more"></a>
<h3 id="ä¸€-å°è£…åŠ¨ç”»æ–¹æ³•"><a href="#ä¸€-å°è£…åŠ¨ç”»æ–¹æ³•" class="headerlink" title="ä¸€.å°è£…åŠ¨ç”»æ–¹æ³•"></a>ä¸€.å°è£…åŠ¨ç”»æ–¹æ³•</h3><h5 id="1-ç”¨CATransitionå®ç°åŠ¨ç”»çš„å°è£…æ–¹æ³•å¦‚ä¸‹ï¼Œæ¯å¥ä»£ç æ˜¯ä½•æ„æ€ï¼Œè¯·çœ‹æ³¨é‡Šä¹‹ã€‚"><a href="#1-ç”¨CATransitionå®ç°åŠ¨ç”»çš„å°è£…æ–¹æ³•å¦‚ä¸‹ï¼Œæ¯å¥ä»£ç æ˜¯ä½•æ„æ€ï¼Œè¯·çœ‹æ³¨é‡Šä¹‹ã€‚" class="headerlink" title="1.ç”¨CATransitionå®ç°åŠ¨ç”»çš„å°è£…æ–¹æ³•å¦‚ä¸‹ï¼Œæ¯å¥ä»£ç æ˜¯ä½•æ„æ€ï¼Œè¯·çœ‹æ³¨é‡Šä¹‹ã€‚"></a>1.ç”¨CATransitionå®ç°åŠ¨ç”»çš„å°è£…æ–¹æ³•å¦‚ä¸‹ï¼Œæ¯å¥ä»£ç æ˜¯ä½•æ„æ€ï¼Œè¯·çœ‹æ³¨é‡Šä¹‹ã€‚</h5><pre><code>
 #pragma CATransitionåŠ¨ç”»å®ç°
 - (void) transitionWithType:(NSString *) type WithSubtype:(NSString *) subtype ForView : (UIView *) view
 {
     //åˆ›å»ºCATransitionå¯¹è±¡
     CATransition *animation = [CATransition animation];

     //è®¾ç½®è¿åŠ¨æ—¶é—´
     animation.duration = DURATION;

     //è®¾ç½®è¿åŠ¨type
     animation.type = type;
     if (subtype != nil) {

         //è®¾ç½®å­ç±»
         animation.subtype = subtype;
     }

     //è®¾ç½®è¿åŠ¨é€Ÿåº¦
     animation.timingFunction = UIViewAnimationOptionCurveEaseInOut;

     [view.layer addAnimation:animation forKey:@"animation"];
 }
</code></pre>

<p><strong>ä»£ç è¯´æ˜ï¼š</strong><br><strong>CATransition</strong>å¸¸ç”¨çš„å±æ€§å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>duration</strong>:è®¾ç½®åŠ¨ç”»æ—¶é—´</li>
<li><strong>type</strong>:ç¨åä¸‹é¢ä¼šè¯¦ç»†çš„ä»‹ç»è¿åŠ¨ç±»å‹</li>
<li><strong>subtype</strong>:å’ŒtypeåŒ¹é…ä½¿ç”¨ï¼ŒæŒ‡å®šè¿åŠ¨çš„æ–¹å‘ï¼Œä¸‹é¢ä¹Ÿä¼šè¯¦ç»†ä»‹ç»</li>
<li><strong>timingFunction</strong> ï¼š<ul>
<li>åŠ¨ç”»çš„è¿åŠ¨è½¨è¿¹ï¼Œç”¨äºå˜åŒ–èµ·ç‚¹å’Œç»ˆç‚¹ä¹‹é—´çš„æ’å€¼è®¡ç®—,å½¢è±¡ç‚¹è¯´å®ƒå†³å®šäº†åŠ¨ç”»è¿è¡Œçš„èŠ‚å¥,æ¯”å¦‚æ˜¯å‡åŒ€å˜åŒ–(ç›¸åŒæ—¶é—´å˜åŒ–é‡ç›¸åŒ)è¿˜æ˜¯å…ˆå¿«åæ…¢,å…ˆæ…¢åå¿«è¿˜æ˜¯å…ˆæ…¢å†å¿«å†æ…¢.</li>
<li>åŠ¨ç”»çš„å¼€å§‹ä¸ç»“æŸçš„å¿«æ…¢,æœ‰äº”ä¸ªé¢„ç½®åˆ†åˆ«ä¸º(ä¸‹åŒ):<ul>
<li>kCAMediaTimingFunctionLinear            çº¿æ€§,å³åŒ€é€Ÿ</li>
<li>kCAMediaTimingFunctionEaseIn            å…ˆæ…¢åå¿«</li>
<li>kCAMediaTimingFunctionEaseOut           å…ˆå¿«åæ…¢</li>
<li>kCAMediaTimingFunctionEaseInEaseOut     å…ˆæ…¢åå¿«å†æ…¢</li>
<li>kCAMediaTimingFunctionDefault           å®é™…æ•ˆæœæ˜¯åŠ¨ç”»ä¸­é—´æ¯”è¾ƒå¿«.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="2-ç”¨UIViewçš„blockå›è°ƒå®ç°åŠ¨ç”»çš„ä»£ç å°è£…"><a href="#2-ç”¨UIViewçš„blockå›è°ƒå®ç°åŠ¨ç”»çš„ä»£ç å°è£…" class="headerlink" title="2.ç”¨UIViewçš„blockå›è°ƒå®ç°åŠ¨ç”»çš„ä»£ç å°è£…ã€€"></a>2.ç”¨UIViewçš„blockå›è°ƒå®ç°åŠ¨ç”»çš„ä»£ç å°è£…ã€€</h5><pre><code>
 #pragma UIViewå®ç°åŠ¨ç”»
 - (void) animationWithView : (UIView *)view WithAnimationTransition : (UIViewAnimationTransition) transition
 {
     [UIView animateWithDuration:DURATION animations:^{
         [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
         [UIView setAnimationTransition:transition forView:view cache:YES];
     }];
 }
</code></pre>

<h5 id="3-æ”¹å˜Viewçš„èƒŒæ™¯å›¾ï¼Œä¾¿äºåˆ‡æ¢æ—¶è§‚å¯Ÿ"><a href="#3-æ”¹å˜Viewçš„èƒŒæ™¯å›¾ï¼Œä¾¿äºåˆ‡æ¢æ—¶è§‚å¯Ÿ" class="headerlink" title="3.æ”¹å˜Viewçš„èƒŒæ™¯å›¾ï¼Œä¾¿äºåˆ‡æ¢æ—¶è§‚å¯Ÿ"></a>3.æ”¹å˜Viewçš„èƒŒæ™¯å›¾ï¼Œä¾¿äºåˆ‡æ¢æ—¶è§‚å¯Ÿ</h5><pre><code>
 #pragma ç»™Viewæ·»åŠ èƒŒæ™¯å›¾
 -(void)addBgImageWithImageName:(NSString *) imageName
 {
     self.view.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:imageName]];
 }
</code></pre>

<h3 id="äºŒ-è°ƒç”¨ä¸Šé¢çš„æ–¹æ³•å®ç°æˆ‘ä»¬æƒ³è¦çš„åŠ¨ç”»"><a href="#äºŒ-è°ƒç”¨ä¸Šé¢çš„æ–¹æ³•å®ç°æˆ‘ä»¬æƒ³è¦çš„åŠ¨ç”»" class="headerlink" title="äºŒ.è°ƒç”¨ä¸Šé¢çš„æ–¹æ³•å®ç°æˆ‘ä»¬æƒ³è¦çš„åŠ¨ç”»"></a>äºŒ.è°ƒç”¨ä¸Šé¢çš„æ–¹æ³•å®ç°æˆ‘ä»¬æƒ³è¦çš„åŠ¨ç”»</h3><h5 id="1-æˆ‘ä»¬åœ¨Viewä¸Šæ·»åŠ å¤šä¸ªButton-ç»™ä¸åŒçš„Buttonè®¾ç½®ä¸åŒçš„Tagå€¼ï¼Œç„¶åå†ViewControllerä¸­ç»‘å®šåŒä¸€ä¸ªæ–¹æ³•ï¼Œç‚¹å‡»ä¸åŒçš„buttonå®ç°ä¸åŒçš„é¡µé¢åˆ‡æ¢æ•ˆæœã€‚storyBoardä¸Šçš„æ§ä»¶æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š"><a href="#1-æˆ‘ä»¬åœ¨Viewä¸Šæ·»åŠ å¤šä¸ªButton-ç»™ä¸åŒçš„Buttonè®¾ç½®ä¸åŒçš„Tagå€¼ï¼Œç„¶åå†ViewControllerä¸­ç»‘å®šåŒä¸€ä¸ªæ–¹æ³•ï¼Œç‚¹å‡»ä¸åŒçš„buttonå®ç°ä¸åŒçš„é¡µé¢åˆ‡æ¢æ•ˆæœã€‚storyBoardä¸Šçš„æ§ä»¶æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š" class="headerlink" title="1.æˆ‘ä»¬åœ¨Viewä¸Šæ·»åŠ å¤šä¸ªButton,ç»™ä¸åŒçš„Buttonè®¾ç½®ä¸åŒçš„Tagå€¼ï¼Œç„¶åå†ViewControllerä¸­ç»‘å®šåŒä¸€ä¸ªæ–¹æ³•ï¼Œç‚¹å‡»ä¸åŒçš„buttonå®ç°ä¸åŒçš„é¡µé¢åˆ‡æ¢æ•ˆæœã€‚storyBoardä¸Šçš„æ§ä»¶æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š"></a>1.æˆ‘ä»¬åœ¨Viewä¸Šæ·»åŠ å¤šä¸ªButton,ç»™ä¸åŒçš„Buttonè®¾ç½®ä¸åŒçš„Tagå€¼ï¼Œç„¶åå†ViewControllerä¸­ç»‘å®šåŒä¸€ä¸ªæ–¹æ³•ï¼Œç‚¹å‡»ä¸åŒçš„buttonå®ç°ä¸åŒçš„é¡µé¢åˆ‡æ¢æ•ˆæœã€‚storyBoardä¸Šçš„æ§ä»¶æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</h5><div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_1.png?raw=true" alt="image" width="375" height="667/"><br></div>

<h5 id="2-ä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹ç¼–å†™ç‚¹å‡»buttonè¦å›è°ƒçš„æ–¹æ³•"><a href="#2-ä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹ç¼–å†™ç‚¹å‡»buttonè¦å›è°ƒçš„æ–¹æ³•" class="headerlink" title="2.ä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹ç¼–å†™ç‚¹å‡»buttonè¦å›è°ƒçš„æ–¹æ³•"></a>2.ä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹ç¼–å†™ç‚¹å‡»buttonè¦å›è°ƒçš„æ–¹æ³•</h5><ul>
<li>å®šä¹‰æšä¸¾æ¥æ ‡ç¤ºæŒ‰é’®æ‰€å¯¹åº”çš„åŠ¨ç”»ç±»å‹ï¼Œä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<pre><code>
typedef enum : NSUInteger {
    Fade = 1,                   //æ·¡å…¥æ·¡å‡º
    Push,                       //æ¨æŒ¤
    Reveal,                     //æ­å¼€
    MoveIn,                     //è¦†ç›–
    Cube,                       //ç«‹æ–¹ä½“
    SuckEffect,                 //å®å¸
    OglFlip,                    //ç¿»è½¬
    RippleEffect,               //æ³¢çº¹
    PageCurl,                   //ç¿»é¡µ
    PageUnCurl,                 //åç¿»é¡µ
    CameraIrisHollowOpen,       //å¼€é•œå¤´
    CameraIrisHollowClose,      //å…³é•œå¤´
    CurlDown,                   //ä¸‹ç¿»é¡µ
    CurlUp,                     //ä¸Šç¿»é¡µ
    FlipFromLeft,               //å·¦ç¿»è½¬
    FlipFromRight,              //å³ç¿»è½¬

} AnimationType;
</code></pre>

<ul>
<li>è·å–Buttonçš„Tagå€¼ï¼š</li>
</ul>
<pre><code>
     UIButton *button = sender;
     AnimationType animationType = button.tag;
</code></pre>

<ul>
<li>æ¯æ¬¡ç‚¹å‡»buttonéƒ½æ”¹å˜subtypeçš„å€¼ï¼ŒåŒ…æ‹¬ä¸Š,å·¦,ä¸‹,å³</li>
</ul>
<pre><code>
NSString *subtypeString;

    switch (_subtype) {
        case 0:
            subtypeString = kCATransitionFromLeft;
            break;
        case 1:
            subtypeString = kCATransitionFromBottom;
            break;
        case 2:
            subtypeString = kCATransitionFromRight;
            break;
        case 3:
            subtypeString = kCATransitionFromTop;
            break;
        default:
            break;
    }
    _subtype += 1;
    if (_subtype > 3) {
        _subtype = 0;
    }
</code></pre>

<ul>
<li>é€šè¿‡switchç»“åˆä¸Šè¾¹çš„æšä¸¾æ¥åˆ¤æ–­æ˜¯é‚£ä¸ªæŒ‰é’®ç‚¹å‡»çš„</li>
</ul>
<pre><code>
 switch (animationType)
 {
     //å„ç§Case,æ­¤å¤„ä»£ç ä¸‹é¢ä¼šç»™å‡º  
 }
</code></pre>

<h5 id="3-è°ƒç”¨æˆ‘ä»¬å°è£…çš„è¿åŠ¨æ–¹æ³•ï¼Œæ¥å®ç°åŠ¨ç”»æ•ˆæœ"><a href="#3-è°ƒç”¨æˆ‘ä»¬å°è£…çš„è¿åŠ¨æ–¹æ³•ï¼Œæ¥å®ç°åŠ¨ç”»æ•ˆæœ" class="headerlink" title="3.è°ƒç”¨æˆ‘ä»¬å°è£…çš„è¿åŠ¨æ–¹æ³•ï¼Œæ¥å®ç°åŠ¨ç”»æ•ˆæœ"></a>3.è°ƒç”¨æˆ‘ä»¬å°è£…çš„è¿åŠ¨æ–¹æ³•ï¼Œæ¥å®ç°åŠ¨ç”»æ•ˆæœ</h5><ul>
<li>æ·¡åŒ–æ•ˆæœ</li>
</ul>
<pre><code>
case Fade:
     [self transitionWithType:kCATransitionFade WithSubtype:subtypeString ForView:self.view];
     break;
</code></pre>

<ul>
<li>Pushæ•ˆæœ</li>
</ul>
<pre><code>
case Push: 
     [self transitionWithType:kCATransitionPush WithSubtype:subtypeString ForView:self.view];
     break;
</code></pre>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_2.png?raw=true" alt="image" width="375" height="667"><br></div>

<ul>
<li>æ­å¼€æ•ˆæœï¼š</li>
</ul>
<pre><code>
case Reveal:
    [self transitionWithType:kCATransitionReveal WithSubtype:subtypeString ForView:self.view];
    break;
</code></pre>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_3.png?raw=true" alt="image" width="375" height="667"><br></div>

<ul>
<li>è¦†ç›–æ•ˆæœï¼š</li>
</ul>
<pre><code>
case MoveIn:
    [self transitionWithType:kCATransitionMoveIn WithSubtype:subtypeString ForView:self.view];
    break;
</code></pre>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_4.png?raw=true" alt="image" width="375" height="667"><br></div>

<ul>
<li>ç«‹æ–¹ä½“æ•ˆæœï¼š</li>
</ul>
<pre><code>
case Cube:
    [self transitionWithType:@"cube" WithSubtype:subtypeString ForView:self.view];
    break;
</code></pre>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_5.png?raw=true" alt="image" width="375" height="667"><br></div>

<ul>
<li>å®å¸æ•ˆæœï¼š</li>
</ul>
<pre><code>
case SuckEffect:
    [self transitionWithType:@"suckEffect" WithSubtype:subtypeString ForView:self.view];
    break;
</code></pre>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_6.png?raw=true" alt="image" width="375" height="667"><br></div>

<ul>
<li>ç¿»è½¬æ•ˆæœï¼š</li>
</ul>
<pre><code>
case OglFlip:
    [self transitionWithType:@"oglFlip" WithSubtype:subtypeString ForView:self.view];
    break;
</code></pre>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_7.png?raw=true" alt="image" width="375" height="667"><br></div> 

<ul>
<li>æ³¢çº¹æ•ˆæœï¼š</li>
</ul>
<pre><code>
case RippleEffect:
    [self transitionWithType:@"rippleEffect" WithSubtype:subtypeString ForView:self.view];
    break;
</code></pre>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_8.png?raw=true" alt="image" width="375" height="667"><br></div> 

<ul>
<li>ç¿»é¡µå’Œåç¿»é¡µæ•ˆæœï¼š</li>
</ul>
<pre><code>
case PageCurl:
            [self transitionWithType:@"pageCurl" WithSubtype:subtypeString ForView:self.view];
            break;

        case PageUnCurl:
            [self transitionWithType:@"pageUnCurl" WithSubtype:subtypeString ForView:self.view];
            break;
</code></pre>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_9.png?raw=true" alt="image" width="375" height="667"><br></div><br><div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_10.png?raw=true" alt="image" width="375" height="667"><br></div> 

<ul>
<li>ç›¸æœºæ‰“å¼€æ•ˆæœï¼š</li>
</ul>
<pre><code>
case CameraIrisHollowOpen:
            [self transitionWithType:@"cameraIrisHollowOpen" WithSubtype:subtypeString ForView:self.view];
            break;

        case CameraIrisHollowClose:
            [self transitionWithType:@"cameraIrisHollowClose" WithSubtype:subtypeString ForView:self.view];
            break;
</code></pre>

<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/Animation/Animation_11.png?raw=true" alt="image" width="375" height="667"><br></div> 

<ul>
<li>è°ƒç”¨ä¸Šé¢å°è£…çš„ç¬¬äºŒä¸ªåŠ¨ç”»æ–¹æ³•</li>
</ul>
<pre><code>
case CurlDown:
            [self animationWithView:self.view WithAnimationTransition:UIViewAnimationTransitionCurlDown];
            break;

        case CurlUp:
            [self animationWithView:self.view WithAnimationTransition:UIViewAnimationTransitionCurlUp];
            break;

        case FlipFromLeft:
            [self animationWithView:self.view WithAnimationTransition:UIViewAnimationTransitionFlipFromLeft];
            break;

        case FlipFromRight:
            [self animationWithView:self.view WithAnimationTransition:UIViewAnimationTransitionFlipFromRight];
            break;
</code></pre>

<p><a href="https://github.com/guiyongdong/Resource/tree/master/demo/CATransitionDemo" target="_blank" rel="external">Demoä¼ é€é—¨</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[RunLoopæ€»ç»“]]></title>
      <url>http://yoursite.com/2016/02/01/RunLoop%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘ç ”ç©¶äº†ä¸€ä¸‹RunLoopï¼Œåœ¨è¿™é‡Œå¯¹RunLoopåšä¸€ä¸ªæ€»ç»“ï¼Œä¸»è¦æ˜¯å¯¹<code>&lt;CoreFoundation/CFRunLoop.h&gt;</code>çš„å¤´æ–‡ä»¶å‡½æ•°æ€»ç»“ã€‚</p>
<a id="more"></a>
<h3 id="å…³äºRunLoopçš„èµ„æ–™æ€»ç»“"><a href="#å…³äºRunLoopçš„èµ„æ–™æ€»ç»“" class="headerlink" title="å…³äºRunLoopçš„èµ„æ–™æ€»ç»“"></a>å…³äºRunLoopçš„èµ„æ–™æ€»ç»“</h3><p>ç½‘ä¸Šå…³äºRunLoopçš„æ€»ç»“å¤§è‡´ç›¸åŒï¼Œè¿™é‡Œæ¨èå‡ ç¯‡å¥½çš„æ–‡ç« å…±å¤§å®¶å­¦ä¹ ã€‚</p>
<ul>
<li><p>YYModelä½œè€…å…³äºRunLoopçš„æ€»ç»“ ã€Š<a href="http://blog.ibireme.com/2015/05/18/runloop/" target="_blank" rel="external">æ·±å…¥ç†è§£RunLoop</a>ã€‹</p>
</li>
<li><p>ç®€ä¹¦ä¸Šä¸é”™çš„æ–‡ç«  ã€Š<a href="http://www.jianshu.com/p/37ab0397fec7" target="_blank" rel="external">ã€iOSç¨‹åºå¯åŠ¨ä¸è¿è½¬ã€‘- RunLoopä¸ªäººå°ç»“</a>ã€‹</p>
</li>
<li><p>sunnyxxçš„RunLoopçº¿ä¸‹è®¨è®ºä¼š <a href="https://pan.baidu.com/s/1i5bN3dN" target="_blank" rel="external">ç™¾åº¦ç½‘ç›˜</a></p>
</li>
<li><p>ç”¨RunLoopæ•è·ç¨‹åºCrash é˜²æ­¢ç”¨æˆ·ä½¿ç”¨æ—¶ç¨‹åºå´©æºƒ <a href="https://github.com/guiyongdong/Resource/tree/master/%20CrashManager" target="_blank" rel="external">gitè¿æ¥</a></p>
</li>
</ul>
<h3 id="å…³äºCFRunLoop-hçš„æ€»ç»“"><a href="#å…³äºCFRunLoop-hçš„æ€»ç»“" class="headerlink" title="å…³äºCFRunLoop.hçš„æ€»ç»“"></a>å…³äºCFRunLoop.hçš„æ€»ç»“</h3><pre><code>

//Runloop
typedef struct __CFRunLoop * CFRunLoopRef;
//äº‹ä»¶æº
typedef struct __CFRunLoopSource * CFRunLoopSourceRef;
//è§‚å¯Ÿè€…
typedef struct __CFRunLoopObserver * CFRunLoopObserverRef;
//å®šæ—¶å™¨
typedef struct CF_BRIDGED_MUTABLE_TYPE(NSTimer) __CFRunLoopTimer * CFRunLoopTimerRef;

/* Reasons for CFRunLoopRunInMode() to Return */
enum {
    kCFRunLoopRunFinished = 1, //Run Loopç»“æŸï¼Œæ²¡æœ‰Timeræˆ–è€…å…¶ä»–Input Source
    kCFRunLoopRunStopped = 2, //Run Loopè¢«åœæ­¢ï¼Œä½¿ç”¨CFRunLoopStopåœæ­¢Run Loop
    kCFRunLoopRunTimedOut = 3, //RunLoop è¶…æ—¶
    kCFRunLoopRunHandledSource = 4 //Run Loopå¤„ç†å®Œäº‹ä»¶ï¼Œæ³¨æ„Timeräº‹ä»¶çš„è§¦å‘æ˜¯ä¸ä¼šè®©Run Loopé€€å‡ºè¿”å›çš„ï¼Œå³ä½¿CFRunLoopRunInModeçš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯YESä¹Ÿä¸è¡Œ
};

/* Run Loop Observer Activities */
typedef CF_OPTIONS(CFOptionFlags, CFRunLoopActivity) {
    kCFRunLoopEntry = (1UL << 0), // å³å°†è¿›å…¥Loop
    kCFRunLoopBeforeTimers = (1UL << 1), // å³å°†å¤„ç† Timer
    kCFRunLoopBeforeSources = (1UL << 2), // å³å°†å¤„ç† Source
    kCFRunLoopBeforeWaiting = (1UL << 5), // å³å°†è¿›å…¥ä¼‘çœ 
    kCFRunLoopAfterWaiting = (1UL << 6), // åˆšä»ä¼‘çœ ä¸­å”¤é†’
    kCFRunLoopExit = (1UL << 7), // å³å°†é€€å‡ºLoop
    kCFRunLoopAllActivities = 0x0FFFFFFFU
};

//é»˜è®¤model
CF_EXPORT const CFStringRef kCFRunLoopDefaultMode;
//å½“uiscrollViewæ»‘åŠ¨æ—¶Model
CF_EXPORT const CFStringRef kCFRunLoopCommonModes;

//è·å–å½“å‰RunLoop å½“å½“å‰RunLoopæ²¡æœ‰çš„æ—¶å€™å›åˆ›å»ºä¸€ä¸ª  ä¸€ä¸ªçº¿ç¨‹å¯¹åº”ä¸€ä¸ªRunLoop
CF_EXPORT CFRunLoopRef CFRunLoopGetCurrent(void);
//è·å–ä¸»çº¿ç¨‹çš„RunLoop
CF_EXPORT CFRunLoopRef CFRunLoopGetMain(void);
//å¤åˆ¶å½“å‰RunLoop
CF_EXPORT CFStringRef CFRunLoopCopyCurrentMode(CFRunLoopRef rl);
//å¤åˆ¶å½“å‰RunLoopçš„æ‰€æœ‰Model
CF_EXPORT CFArrayRef CFRunLoopCopyAllModes(CFRunLoopRef rl);
//ç»™å½“å‰RunLoopæ·»åŠ Model
CF_EXPORT void CFRunLoopAddCommonMode(CFRunLoopRef rl, CFStringRef mode);
//è·å–RunLoop modelçš„è¶…æ—¶æ—¶é—´
CF_EXPORT CFAbsoluteTime CFRunLoopGetNextTimerFireDate(CFRunLoopRef rl, CFStringRef mode);
//æ‰‹åŠ¨å¯åŠ¨RunLoop
CF_EXPORT void CFRunLoopRun(void);
/**
 *  åˆ‡æ¢å½“å‰RunLoopçš„model
 *
 *  @param mode                     model
 *  @param seconds                  æ‰§è¡Œæ—¶é—´
 *  @param returnAfterSourceHandled æ‰§è¡Œå®Œæ˜¯å¦ç»“æŸ
 */
CF_EXPORT SInt32 CFRunLoopRunInMode(CFStringRef mode, CFTimeInterval seconds, Boolean returnAfterSourceHandled);
//å½“å‰RunLoopæ˜¯å¦ä¼‘çœ 
CF_EXPORT Boolean CFRunLoopIsWaiting(CFRunLoopRef rl);
//å”¤é†’RunLoop
CF_EXPORT void CFRunLoopWakeUp(CFRunLoopRef rl);
//æ‰‹åŠ¨åœæ­¢RunLoop
CF_EXPORT void CFRunLoopStop(CFRunLoopRef rl);

#if __BLOCKS__
//åœ¨RunLoop ç‰¹å®šModelæ‰§è¡Œ æ“ä½œ
CF_EXPORT void CFRunLoopPerformBlock(CFRunLoopRef rl, CFTypeRef mode, void (^block)(void)) CF_AVAILABLE(10_6, 4_0); 
#endif
//RunLoopä¸‹æ˜¯å¦åŒ…å«æŸä¸ªSource
CF_EXPORT Boolean CFRunLoopContainsSource(CFRunLoopRef rl, CFRunLoopSourceRef source, CFStringRef mode);
//æ·»åŠ Source
CF_EXPORT void CFRunLoopAddSource(CFRunLoopRef rl, CFRunLoopSourceRef source, CFStringRef mode);
//ç§»é™¤Source
CF_EXPORT void CFRunLoopRemoveSource(CFRunLoopRef rl, CFRunLoopSourceRef source, CFStringRef mode);
//æ˜¯å¦åŒ…æ¢è§‚å¯Ÿè€…
CF_EXPORT Boolean CFRunLoopContainsObserver(CFRunLoopRef rl, CFRunLoopObserverRef observer, CFStringRef mode);
//æ·»åŠ æŸä¸ªmodelä¸‹çš„è§‚å¯Ÿè€…
CF_EXPORT void CFRunLoopAddObserver(CFRunLoopRef rl, CFRunLoopObserverRef observer, CFStringRef mode);
//ç§»é™¤è§‚å¯Ÿè€…
CF_EXPORT void CFRunLoopRemoveObserver(CFRunLoopRef rl, CFRunLoopObserverRef observer, CFStringRef mode);
//æ˜¯å¦åŒ…å«å®šæ—¶å™¨
CF_EXPORT Boolean CFRunLoopContainsTimer(CFRunLoopRef rl, CFRunLoopTimerRef timer, CFStringRef mode);
//æ·»åŠ å®šæ—¶å™¨
CF_EXPORT void CFRunLoopAddTimer(CFRunLoopRef rl, CFRunLoopTimerRef timer, CFStringRef mode);
//ç§»é™¤å®šæ—¶å™¨
CF_EXPORT void CFRunLoopRemoveTimer(CFRunLoopRef rl, CFRunLoopTimerRef timer, CFStringRef mode);

typedef struct {
    CFIndex    version;
    void *    info;
    const void *(*retain)(const void *info);
    void    (*release)(const void *info);
    CFStringRef    (*copyDescription)(const void *info);
    Boolean    (*equal)(const void *info1, const void *info2);
    CFHashCode    (*hash)(const void *info);
    void    (*schedule)(void *info, CFRunLoopRef rl, CFStringRef mode);
    void    (*cancel)(void *info, CFRunLoopRef rl, CFStringRef mode);
    void    (*perform)(void *info);
} CFRunLoopSourceContext;

typedef struct {
    CFIndex    version;
    void *    info;
    const void *(*retain)(const void *info);
    void    (*release)(const void *info);
    CFStringRef    (*copyDescription)(const void *info);
    Boolean    (*equal)(const void *info1, const void *info2);
    CFHashCode    (*hash)(const void *info);
#if (TARGET_OS_MAC && !(TARGET_OS_EMBEDDED || TARGET_OS_IPHONE)) || (TARGET_OS_EMBEDDED || TARGET_OS_IPHONE)
    mach_port_t    (*getPort)(void *info);
    void *    (*perform)(void *msg, CFIndex size, CFAllocatorRef allocator, void *info);
#else
    void *    (*getPort)(void *info);
    void    (*perform)(void *info);
#endif
} CFRunLoopSourceContext1;

CF_EXPORT CFTypeID CFRunLoopSourceGetTypeID(void);

//åˆ›å»ºäº‹ä»¶æº
CF_EXPORT CFRunLoopSourceRef CFRunLoopSourceCreate(CFAllocatorRef allocator, CFIndex order, CFRunLoopSourceContext *context);

CF_EXPORT CFIndex CFRunLoopSourceGetOrder(CFRunLoopSourceRef source);
CF_EXPORT void CFRunLoopSourceInvalidate(CFRunLoopSourceRef source);
CF_EXPORT Boolean CFRunLoopSourceIsValid(CFRunLoopSourceRef source);
CF_EXPORT void CFRunLoopSourceGetContext(CFRunLoopSourceRef source, CFRunLoopSourceContext *context);
CF_EXPORT void CFRunLoopSourceSignal(CFRunLoopSourceRef source);

typedef struct {
    CFIndex    version;
    void *    info;
    const void *(*retain)(const void *info);
    void    (*release)(const void *info);
    CFStringRef    (*copyDescription)(const void *info);
} CFRunLoopObserverContext;

typedef void (*CFRunLoopObserverCallBack)(CFRunLoopObserverRef observer, CFRunLoopActivity activity, void *info);

CF_EXPORT CFTypeID CFRunLoopObserverGetTypeID(void);

CF_EXPORT CFRunLoopObserverRef CFRunLoopObserverCreate(CFAllocatorRef allocator, CFOptionFlags activities, Boolean repeats, CFIndex order, CFRunLoopObserverCallBack callout, CFRunLoopObserverContext *context);
#if __BLOCKS__
/**
 *  åˆ›å»ºè§‚å¯Ÿè€…
 *
 *  @param allocator  é»˜è®¤ kCFAllocatorDefault
 *  @param activities ç›‘å¬ RunLoopçš„å“ªç§çŠ¶æ€
 *  @param repeats    æ˜¯å¦ä¸€ç›´ç›‘å¬
 *  @param order      ä¼˜å…ˆçº§ é»˜è®¤ 0
 *  @param ^block     å›è°ƒ
 *
 */
CF_EXPORT CFRunLoopObserverRef CFRunLoopObserverCreateWithHandler(CFAllocatorRef allocator, CFOptionFlags activities, Boolean repeats, CFIndex order, void (^block) (CFRunLoopObserverRef observer, CFRunLoopActivity activity)) CF_AVAILABLE(10_7, 5_0);
#endif

//è·å–å½“å‰è§‚å¯Ÿè€…è§‚å¯Ÿçš„çŠ¶æ€
CF_EXPORT CFOptionFlags CFRunLoopObserverGetActivities(CFRunLoopObserverRef observer);
//è·å–å½“å‰è§‚å¯Ÿè€…æ˜¯å¦ä¸€ç›´è§‚å¯Ÿ
CF_EXPORT Boolean CFRunLoopObserverDoesRepeat(CFRunLoopObserverRef observer);
//è·å–ä¼˜å…ˆçº§
CF_EXPORT CFIndex CFRunLoopObserverGetOrder(CFRunLoopObserverRef observer);
CF_EXPORT void CFRunLoopObserverInvalidate(CFRunLoopObserverRef observer);
CF_EXPORT Boolean CFRunLoopObserverIsValid(CFRunLoopObserverRef observer);
CF_EXPORT void CFRunLoopObserverGetContext(CFRunLoopObserverRef observer, CFRunLoopObserverContext *context);

typedef struct {
    CFIndex    version;
    void *    info;
    const void *(*retain)(const void *info);
    void    (*release)(const void *info);
    CFStringRef    (*copyDescription)(const void *info);
} CFRunLoopTimerContext;

typedef void (*CFRunLoopTimerCallBack)(CFRunLoopTimerRef timer, void *info);

CF_EXPORT CFTypeID CFRunLoopTimerGetTypeID(void);
//åˆ›å»ºå®šæ—¶å™¨
CF_EXPORT CFRunLoopTimerRef CFRunLoopTimerCreate(CFAllocatorRef allocator, CFAbsoluteTime fireDate, CFTimeInterval interval, CFOptionFlags flags, CFIndex order, CFRunLoopTimerCallBack callout, CFRunLoopTimerContext *context);
#if __BLOCKS__
//ä½¿ç”¨Blockåˆ›å»ºå®šæ—¶å™¨
CF_EXPORT CFRunLoopTimerRef CFRunLoopTimerCreateWithHandler(CFAllocatorRef allocator, CFAbsoluteTime fireDate, CFTimeInterval interval, CFOptionFlags flags, CFIndex order, void (^block) (CFRunLoopTimerRef timer)) CF_AVAILABLE(10_7, 5_0);
#endif
//è·å–è¶…æ—¶æ—¶é—´
CF_EXPORT CFAbsoluteTime CFRunLoopTimerGetNextFireDate(CFRunLoopTimerRef timer);
//è®¾ç½®è¶…æ—¶æ—¶é—´
CF_EXPORT void CFRunLoopTimerSetNextFireDate(CFRunLoopTimerRef timer, CFAbsoluteTime fireDate);
CF_EXPORT CFTimeInterval CFRunLoopTimerGetInterval(CFRunLoopTimerRef timer);
//æ˜¯å¦å¾ªç¯æ‰§è¡Œ
CF_EXPORT Boolean CFRunLoopTimerDoesRepeat(CFRunLoopTimerRef timer);
//è·å–ä¼˜å…ˆçº§
CF_EXPORT CFIndex CFRunLoopTimerGetOrder(CFRunLoopTimerRef timer);
CF_EXPORT void CFRunLoopTimerInvalidate(CFRunLoopTimerRef timer);
CF_EXPORT Boolean CFRunLoopTimerIsValid(CFRunLoopTimerRef timer);
CF_EXPORT void CFRunLoopTimerGetContext(CFRunLoopTimerRef timer, CFRunLoopTimerContext *context);

// Setting a tolerance for a timer allows it to fire later than the scheduled fire date, improving the ability of the system to optimize for increased power savings and responsiveness. The timer may fire at any time between its scheduled fire date and the scheduled fire date plus the tolerance. The timer will not fire before the scheduled fire date. For repeating timers, the next fire date is calculated from the original fire date regardless of tolerance applied at individual fire times, to avoid drift. The default value is zero, which means no additional tolerance is applied. The system reserves the right to apply a small amount of tolerance to certain timers regardless of the value of this property.
// As the user of the timer, you will have the best idea of what an appropriate tolerance for a timer may be. A general rule of thumb, though, is to set the tolerance to at least 10% of the interval, for a repeating timer. Even a small amount of tolerance will have a significant positive impact on the power usage of your application. The system may put a maximum value of the tolerance.
CF_EXPORT CFTimeInterval CFRunLoopTimerGetTolerance(CFRunLoopTimerRef timer) CF_AVAILABLE(10_9, 7_0);
CF_EXPORT void CFRunLoopTimerSetTolerance(CFRunLoopTimerRef timer, CFTimeInterval tolerance) CF_AVAILABLE(10_9, 7_0);

CF_EXTERN_C_END
CF_IMPLICIT_BRIDGING_DISABLED


</code></pre>






<!-- more -->
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ReactiveCocoaå’ŒRXSwifté€ŸæŸ¥è¡¨]]></title>
      <url>http://yoursite.com/2016/01/24/ReactiveCocoa%E5%92%8CRXSwift%E9%80%9F%E6%9F%A5%E8%A1%A8/</url>
      <content type="html"><![CDATA[<p>åœ¨æ¥è§¦äº†RACä»¥å,å¯¹RACæœ‰äº†ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ï¼Œè¿™é‡Œæ•´ç†äº†ä¸€ä¸‹RACè„‘å›¾ï¼Œæ–¹ä¾¿æ—¥åæŸ¥çœ‹ã€‚ps(<a href="https://github.com/aiqiuqiu/FRPCheatSheeta" target="_blank" rel="external">è½¬è½½</a>)</p>
<a id="more"></a>
<h3 id="ReactiveCocoa-Objective-Céƒ¨åˆ†"><a href="#ReactiveCocoa-Objective-Céƒ¨åˆ†" class="headerlink" title="ReactiveCocoa-Objective-Céƒ¨åˆ†"></a>ReactiveCocoa-Objective-Céƒ¨åˆ†</h3><p><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/ReactiveCocoa-Objective-C.png?raw=true" alt="ReactiveCocoa-Objective-C Swartz"></p>
<h3 id="ReactiveCocoaV4-x-Swiftéƒ¨åˆ†"><a href="#ReactiveCocoaV4-x-Swiftéƒ¨åˆ†" class="headerlink" title="ReactiveCocoaV4.x-Swiftéƒ¨åˆ†"></a>ReactiveCocoaV4.x-Swiftéƒ¨åˆ†</h3><p><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/ReactiveCocoaV4.x-Swift.png?raw=true" alt="ReactiveCocoaV4.x-Swift Swartz"></p>
<h3 id="RXSwiftéƒ¨åˆ†"><a href="#RXSwiftéƒ¨åˆ†" class="headerlink" title="RXSwiftéƒ¨åˆ†"></a>RXSwiftéƒ¨åˆ†</h3><p><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/RXSwift.png?raw=true" alt="ReactiveCocoaV4.x-Swift Swartz"></p>
<!-- more -->
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[UIBezierPathè¯¦è§£]]></title>
      <url>http://yoursite.com/2016/01/22/UIBezierPath%E8%AF%A6%E8%A7%A3/</url>
      <content type="html"><![CDATA[<p>æˆ‘åœ¨å†™æœ¬ç¯‡æ–‡ç« ä¹‹å‰ï¼Œä¹Ÿæ²¡æœ‰ç³»ç»Ÿå­¦ä¹ è¿‡è´å¡å°”æ›²çº¿ï¼Œåªæ˜¯æ›¾ç»æŸä¸€æ¬¡çš„éœ€æ±‚éœ€è¦ä½¿ç”¨åˆ°ï¼Œæ‰ä¸´æ—¶ç™¾åº¦çœ‹äº†ä¸€çœ‹è€Œä¸”ä½¿ç”¨æœ€åŸºæœ¬çš„åŠŸèƒ½ã€‚ç°åœ¨æ€»ç®—æœ‰æ—¶é—´åœä¸‹æ¥å¥½å¥½ç ”ç©¶ç ”ç©¶è¿™ä¸ªç¥å¥‡è€Œä¼Ÿå¤§çš„è´å¡å°”å…ˆç”Ÿï¼</p>
<a id="more"></a>
<h4 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h4><hr>
<p>ä½¿ç”¨<code>UIBezierPath</code>å¯ä»¥åˆ›å»ºåŸºäºçŸ¢é‡çš„è·¯å¾„ï¼Œæ­¤ç±»æ˜¯<code>Core Graphics</code>æ¡†æ¶å…³äºè·¯å¾„çš„å°è£…ã€‚ä½¿ç”¨æ­¤ç±»å¯ä»¥å®šä¹‰ç®€å•çš„å½¢çŠ¶ï¼Œå¦‚æ¤­åœ†ã€çŸ©å½¢æˆ–è€…æœ‰å¤šä¸ªç›´çº¿å’Œæ›²çº¿æ®µç»„æˆçš„å½¢çŠ¶ç­‰ã€‚</p>
<p><code>UIBezierPath</code>æ˜¯<code>CGPathRef</code>æ•°æ®ç±»å‹çš„å°è£…ã€‚å¦‚æœæ˜¯åŸºäºçŸ¢é‡å½¢çŠ¶çš„è·¯å¾„ï¼Œéƒ½ç”¨ç›´çº¿å’Œæ›²çº¿å»åˆ›å»ºã€‚æˆ‘ä»¬ä½¿ç”¨ç›´çº¿æ®µå»åˆ›å»ºçŸ©å½¢å’Œå¤šè¾¹å½¢ï¼Œä½¿ç”¨æ›²çº¿å»åˆ›å»ºåœ†å¼§ï¼ˆarcï¼‰ã€åœ†æˆ–è€…å…¶ä»–å¤æ‚çš„æ›²çº¿å½¢çŠ¶ã€‚</p>
<p>ä½¿ç”¨<code>UIBezierPath</code>ç”»å›¾æ­¥éª¤ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªUIBezierPathå¯¹è±¡</li>
<li>è°ƒç”¨-moveToPoint:è®¾ç½®åˆå§‹çº¿æ®µçš„èµ·ç‚¹</li>
<li>æ·»åŠ çº¿æˆ–è€…æ›²çº¿å»å®šä¹‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªå­è·¯å¾„</li>
<li>æ”¹å˜UIBezierPathå¯¹è±¡è·Ÿç»˜å›¾ç›¸å…³çš„å±æ€§ã€‚å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ç”»ç¬”çš„å±æ€§ã€å¡«å……æ ·å¼ç­‰</li>
</ol>
<h4 id="UIBezierPathåˆ›å»ºæ–¹æ³•ä»‹ç»"><a href="#UIBezierPathåˆ›å»ºæ–¹æ³•ä»‹ç»" class="headerlink" title="UIBezierPathåˆ›å»ºæ–¹æ³•ä»‹ç»"></a>UIBezierPathåˆ›å»ºæ–¹æ³•ä»‹ç»</h4><hr>
<p>æˆ‘ä»¬å…ˆçœ‹çœ‹<code>UIBezierPath</code>ç±»æä¾›äº†å“ªäº›åˆ›å»ºæ–¹å¼ï¼Œè¿™äº›éƒ½æ˜¯å·¥å‚æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨å³å¯ã€‚</p>
<pre><code>
+ (instancetype)bezierPath;
+ (instancetype)bezierPathWithRect:(CGRect)rect;
+ (instancetype)bezierPathWithOvalInRect:(CGRect)rect;
+ (instancetype)bezierPathWithRoundedRect:(CGRect)rect
                            cornerRadius:(CGFloat)cornerRadius;
+ (instancetype)bezierPathWithRoundedRect:(CGRect)rect
                        byRoundingCorners:(UIRectCorner)corners 
                              cornerRadii:(CGSize)cornerRadii;
+ (instancetype)bezierPathWithArcCenter:(CGPoint)center 
                                 radius:(CGFloat)radius 
                             startAngle:(CGFloat)startAngle 
                               endAngle:(CGFloat)endAngle 
                              clockwise:(BOOL)clockwise;
+ (instancetype)bezierPathWithCGPath:(CGPathRef)CGPath;
</code></pre>

<p>ä¸‹é¢æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªåœ°ä»‹ç»å…¶ç”¨é€”ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">+ (instancetype)bezierPath;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªä½¿ç”¨æ¯”è¾ƒå¤šï¼Œå› ä¸ºè¿™ä¸ªå·¥å‚æ–¹æ³•åˆ›å»ºçš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æˆ‘ä»¬çš„éœ€è¦ä»»æ„å®šåˆ¶æ ·å¼ï¼Œå¯ä»¥ç”»ä»»ä½•æˆ‘ä»¬æƒ³ç”»çš„å›¾å½¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">+ (instancetype)bezierPathWithRect:(CGRect)rect;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªå·¥å‚æ–¹æ³•æ ¹æ®ä¸€ä¸ªçŸ©å½¢ç”»è´å¡å°”æ›²çº¿ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">+ (instancetype)bezierPathWithOvalInRect:(CGRect)rect;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªå·¥å‚æ–¹æ³•æ ¹æ®ä¸€ä¸ªçŸ©å½¢ç”»å†…åˆ‡æ›²çº¿ã€‚é€šå¸¸ç”¨å®ƒæ¥ç”»åœ†æˆ–è€…æ¤­åœ†ã€‚</p>
<pre><code>
+ (instancetype)bezierPathWithRoundedRect:(CGRect)rect
                            cornerRadius:(CGFloat)cornerRadius;
+ (instancetype)bezierPathWithRoundedRect:(CGRect)rect
                        byRoundingCorners:(UIRectCorner)corners 
                              cornerRadii:(CGSize)cornerRadii;
</code></pre>

<p>ç¬¬ä¸€ä¸ªå·¥å‚æ–¹æ³•æ˜¯ç”»çŸ©å½¢ï¼Œä½†æ˜¯è¿™ä¸ªçŸ©å½¢æ˜¯å¯ä»¥ç”»åœ†è§’çš„ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯çŸ©å½¢ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯åœ†è§’å¤§å°ã€‚<br>ç¬¬äºŒä¸ªå·¥å‚æ–¹æ³•åŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å¯ä»¥æŒ‡å®šæŸä¸€ä¸ªè§’ç”»æˆåœ†è§’ã€‚åƒè¿™ç§æˆ‘ä»¬å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°ç»™UIViewæ‰©å±•æ·»åŠ åœ†è§’çš„æ–¹æ³•äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">+ (instancetype)bezierPathWithArcCenter:(CGPoint)center </div><div class="line">                                 radius:(CGFloat)radius </div><div class="line">                             startAngle:(CGFloat)startAngle </div><div class="line">                               endAngle:(CGFloat)endAngle </div><div class="line">                              clockwise:(BOOL)clockwise;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªå·¥å‚æ–¹æ³•ç”¨äºç”»å¼§ï¼Œå‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š<br><code>center</code>: å¼§çº¿ä¸­å¿ƒç‚¹çš„åæ ‡<br><code>radius</code>: å¼§çº¿æ‰€åœ¨åœ†çš„åŠå¾„<br><code>startAngle</code>: å¼§çº¿å¼€å§‹çš„è§’åº¦å€¼<br><code>endAngle</code>: å¼§çº¿ç»“æŸçš„è§’åº¦å€¼<br><code>clockwise</code>: æ˜¯å¦é¡ºæ—¶é’ˆç”»å¼§çº¿</p>
<blockquote>
<p>æ¸©é¦¨æç¤ºï¼šæˆ‘ä»¬ä¸‹é¢çš„ä»£ç éƒ½æ˜¯åœ¨è‡ªå®šä¹‰çš„BezierPathViewç±»ä¸­çš„<code>- (void)drawRect:(CGRect)rect</code>æ–¹æ³•ä¸­è°ƒç”¨</p>
</blockquote>
<h5 id="ç”»ä¸‰è§’å½¢"><a href="#ç”»ä¸‰è§’å½¢" class="headerlink" title="ç”»ä¸‰è§’å½¢"></a>ç”»ä¸‰è§’å½¢</h5><hr>
<p>å…ˆçœ‹æ•ˆæœå›¾ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/UIBezierPath/UIBezierPath_1.jpg?raw=true" alt="image"><br></div>

<pre><code>
// ç”»ä¸‰è§’å½¢
- (void)drawTrianglePath {

  UIBezierPath *path = [UIBezierPath bezierPath];
  [path moveToPoint:CGPointMake(20, 20)];
  [path addLineToPoint:CGPointMake(self.frame.size.width - 40, 20)];
  [path addLineToPoint:CGPointMake(self.frame.size.width / 2, self.frame.size.height - 20)];

  // æœ€åçš„é—­åˆçº¿æ˜¯å¯ä»¥é€šè¿‡è°ƒç”¨closePathæ–¹æ³•æ¥è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨-addLineToPoint:æ–¹æ³•æ¥æ·»åŠ 
  //  [path addLineToPoint:CGPointMake(20, 20)];

  [path closePath];

  // è®¾ç½®çº¿å®½
  path.lineWidth = 1.5;

  // è®¾ç½®å¡«å……é¢œè‰²
  UIColor *fillColor = [UIColor greenColor];
  [fillColor set];
  [path fill];

  // è®¾ç½®ç”»ç¬”é¢œè‰²
  UIColor *strokeColor = [UIColor blueColor];
  [strokeColor set];

  // æ ¹æ®æˆ‘ä»¬è®¾ç½®çš„å„ä¸ªç‚¹è¿çº¿
  [path stroke];
}
</code></pre>

<p>æˆ‘ä»¬è®¾ç½®ç”»ç¬”é¢œè‰²é€šè¿‡setæ–¹æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">UIColor *strokeColor = [UIColor blueColor];</div><div class="line">[strokeColor set];</div></pre></td></tr></table></figure></p>
<p>å¦‚æœæˆ‘ä»¬éœ€è¦è®¾ç½®å¡«å……é¢œè‰²ï¼Œæ¯”å¦‚è¿™é‡Œè®¾ç½®ä¸ºç»¿è‰²ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨è®¾ç½®ç”»ç¬”é¢œè‰²ä¹‹å‰å…ˆè®¾ç½®å¡«å……é¢œè‰²ï¼Œå¦åˆ™ç”»ç¬”é¢œè‰²å°±è¢«å¡«å……é¢œè‰²æ›¿ä»£äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¦è®©å¡«å……é¢œè‰²ä¸ç”»ç¬”é¢œè‰²ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„é¡ºåºå¿…é¡»æ˜¯å…ˆè®¾ç½®å¡«å……é¢œè‰²å†è®¾ç½®ç”»ç¬”é¢œè‰²ã€‚å¦‚ä¸‹ï¼Œè¿™ä¸¤è€…é¡ºåºä¸èƒ½æ”¹å˜ã€‚å› ä¸ºæˆ‘ä»¬è®¾ç½®å¡«å……é¢œè‰²ä¹Ÿæ˜¯è·Ÿè®¾ç½®ç”»ç¬”é¢œè‰²ä¸€æ ·è°ƒç”¨UIColorçš„-setæ–¹æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// è®¾ç½®å¡«å……é¢œè‰²</div><div class="line">UIColor *fillColor = [UIColor greenColor];</div><div class="line">[fillColor set];</div><div class="line">[path fill];</div><div class="line"></div><div class="line">// è®¾ç½®ç”»ç¬”é¢œè‰²</div><div class="line">UIColor *strokeColor = [UIColor blueColor];</div><div class="line">[strokeColor set];</div></pre></td></tr></table></figure>
<h5 id="ç”»çŸ©å½¢"><a href="#ç”»çŸ©å½¢" class="headerlink" title="ç”»çŸ©å½¢"></a>ç”»çŸ©å½¢</h5><hr>
<p>å…ˆçœ‹æ•ˆæœå›¾ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/UIBezierPath/UIBezierPath_2.jpg?raw=true" alt="image"><br></div>

<pre><code>
// ç”»çŸ©å½¢
- (void)drawRectPath {
  UIBezierPath *path = [UIBezierPath bezierPathWithRect:CGRectMake(20, 20, self.frame.size.width - 40, self.frame.size.height - 40)];

  path.lineWidth = 1.5;
  path.lineCapStyle = kCGLineCapRound;
  path.lineJoinStyle = kCGLineJoinBevel;

  // è®¾ç½®å¡«å……é¢œè‰²
  UIColor *fillColor = [UIColor greenColor];
  [fillColor set];
  [path fill];

  // è®¾ç½®ç”»ç¬”é¢œè‰²
  UIColor *strokeColor = [UIColor blueColor];
  [strokeColor set];

  // æ ¹æ®æˆ‘ä»¬è®¾ç½®çš„å„ä¸ªç‚¹è¿çº¿
  [path stroke];
}
</code></pre>

<p>lineCapStyleå±æ€§æ˜¯ç”¨æ¥è®¾ç½®çº¿æ¡æ‹è§’å¸½çš„æ ·å¼çš„ï¼Œå…¶ä¸­æœ‰ä¸‰ä¸ªé€‰æ‹©ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">/* Line cap styles. */</div><div class="line"></div><div class="line">typedef CF_ENUM(int32_t, CGLineCap) &#123;</div><div class="line">    kCGLineCapButt,</div><div class="line">    kCGLineCapRound,</div><div class="line">    kCGLineCapSquare</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œç¬¬ä¸€ä¸ªæ˜¯é»˜è®¤çš„ï¼Œç¬¬äºŒä¸ªæ˜¯è½»å¾®åœ†è§’ï¼Œç¬¬ä¸‰ä¸ªæ­£æ–¹å½¢ã€‚</p>
<p>lineJoinStyleå±æ€§æ˜¯ç”¨æ¥è®¾ç½®ä¸¤æ¡çº¿è¿ç»“ç‚¹çš„æ ·å¼ï¼Œå…¶ä¸­ä¹Ÿæœ‰ä¸‰ä¸ªé€‰æ‹©ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">/* Line join styles. */</div><div class="line"></div><div class="line">typedef CF_ENUM(int32_t, CGLineJoin) &#123;</div><div class="line">    kCGLineJoinMiter,</div><div class="line">    kCGLineJoinRound,</div><div class="line">    kCGLineJoinBevel</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œç¬¬ä¸€ä¸ªæ˜¯é»˜è®¤çš„è¡¨ç¤ºæ–œæ¥ï¼Œç¬¬äºŒä¸ªæ˜¯åœ†æ»‘è¡”æ¥ï¼Œç¬¬ä¸‰ä¸ªæ˜¯æ–œè§’è¿æ¥ã€‚</p>
<h5 id="ç”»åœ†"><a href="#ç”»åœ†" class="headerlink" title="ç”»åœ†"></a>ç”»åœ†</h5><hr>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨+ bezierPathWithOvalInRect:æ–¹æ³•æ¥ç”»åœ†ï¼Œå½“æˆ‘ä»¬ä¼ çš„rectå‚æ•°æ˜¯ä¸€ä¸‹æ­£æ–¹å½¢æ—¶ï¼Œç”»å‡ºæ¥çš„å°±æ˜¯åœ†ã€‚</p>
<p>å…ˆçœ‹æ•ˆæœå›¾ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/UIBezierPath/UIBezierPath_3.jpg?raw=true" alt="image"><br></div>

<pre><code>
- (void)drawCiclePath {
  // ä¼ çš„æ˜¯æ­£æ–¹å½¢ï¼Œå› æ­¤å°±å¯ä»¥ç»˜åˆ¶å‡ºåœ†äº†
  UIBezierPath *path = [UIBezierPath bezierPathWithOvalInRect:CGRectMake(20, 20, self.frame.size.width - 40, self.frame.size.width - 40)];

  // è®¾ç½®å¡«å……é¢œè‰²
  UIColor *fillColor = [UIColor greenColor];
  [fillColor set];
  [path fill];

  // è®¾ç½®ç”»ç¬”é¢œè‰²
  UIColor *strokeColor = [UIColor blueColor];
  [strokeColor set];

  // æ ¹æ®æˆ‘ä»¬è®¾ç½®çš„å„ä¸ªç‚¹è¿çº¿
  [path stroke];
}
</code></pre>

<blockquote>
<p>æ³¨æ„ï¼šè¦ç”»åœ†ï¼Œæˆ‘ä»¬éœ€è¦ä¼ çš„rectå‚æ•°å¿…é¡»æ˜¯æ­£æ–¹å½¢å“¦ï¼</p>
</blockquote>
<h5 id="ç”»æ¤­åœ†"><a href="#ç”»æ¤­åœ†" class="headerlink" title="ç”»æ¤­åœ†"></a>ç”»æ¤­åœ†</h5><hr>
<p>å…ˆçœ‹æ•ˆæœå›¾ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/UIBezierPath/UIBezierPath_4.jpg?raw=true" alt="image"><br></div><br>å‰é¢æˆ‘ä»¬å·²ç»ç”»åœ†äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨+ bezierPathWithOvalInRect:æ–¹æ³•æ¥ç”»åœ†ï¼Œå½“æˆ‘ä»¬ä¼ çš„rectå‚æ•°æ˜¯ä¸€ä¸‹æ­£æ–¹å½¢æ—¶ï¼Œç”»å‡ºæ¥çš„å°±æ˜¯åœ†ã€‚é‚£ä¹ˆæˆ‘ä»¬è¦æ˜¯ä¸ä¼ æ­£æ–¹å½¢ï¼Œé‚£ä¹ˆç»˜åˆ¶å‡ºæ¥çš„å°±æ˜¯æ¤­åœ†äº†ã€‚<br><br><pre><code><br>// ç”»æ¤­åœ†<br>- (void)drawOvalPath {<br>  // ä¼ çš„æ˜¯ä¸æ˜¯æ­£æ–¹å½¢ï¼Œå› æ­¤å°±å¯ä»¥ç»˜åˆ¶å‡ºæ¤­åœ†åœ†äº†<br>  UIBezierPath <em>path = [UIBezierPath bezierPathWithOvalInRect:CGRectMake(20, 20, self.frame.size.width - 80, self.frame.size.height - 40)];<br><br>  // è®¾ç½®å¡«å……é¢œè‰²<br>  UIColor </em>fillColor = [UIColor greenColor];<br>  [fillColor set];<br>  [path fill];<br><br>  // è®¾ç½®ç”»ç¬”é¢œè‰²<br>  UIColor <em>strokeColor = [UIColor blueColor];<br>  [strokeColor set];<br><br>  // æ ¹æ®æˆ‘ä»¬è®¾ç½®çš„å„ä¸ªç‚¹è¿çº¿<br>  [path stroke];<br>}<br></em></code></pre><br><br>##### ç”»å¸¦åœ†è§’çš„çŸ©å½¢<br>**<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">+ (instancetype)bezierPathWithRoundedRect:(CGRect)rect</div><div class="line">                            cornerRadius:(CGFloat)cornerRadius;</div><div class="line">+ (instancetype)bezierPathWithRoundedRect:(CGRect)rect</div><div class="line">                        byRoundingCorners:(UIRectCorner)corners </div><div class="line">                              cornerRadii:(CGSize)cornerRadii;</div></pre></td></tr></table></figure><br><br>ç¬¬ä¸€ä¸ªå·¥å‚æ–¹æ³•æ˜¯ç”»çŸ©å½¢ï¼Œä½†æ˜¯è¿™ä¸ªçŸ©å½¢æ˜¯å¯ä»¥ç”»åœ†è§’çš„ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯çŸ©å½¢ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯åœ†è§’å¤§å°ã€‚<br>ç¬¬äºŒä¸ªå·¥å‚æ–¹æ³•åŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å¯ä»¥æŒ‡å®šæŸä¸€ä¸ªè§’ç”»æˆåœ†è§’ã€‚åƒè¿™ç§æˆ‘ä»¬å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°ç»™UIViewæ‰©å±•æ·»åŠ åœ†è§’çš„æ–¹æ³•äº†ã€‚<br><br>å››ä¸ªéƒ½æ˜¯åœ†è§’10ï¼š<br><div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/UIBezierPath/UIBezierPath_5.jpg?raw=true" alt="image"><br></div>

<pre><code>
- (void)drawRoundedRectPath {
  UIBezierPath *path = [UIBezierPath bezierPathWithRoundedRect:CGRectMake(20, 20, self.frame.size.width - 40, self.frame.size.height - 40) cornerRadius:10];

  // è®¾ç½®å¡«å……é¢œè‰²
  UIColor *fillColor = [UIColor greenColor];
  [fillColor set];
  [path fill];

  // è®¾ç½®ç”»ç¬”é¢œè‰²
  UIColor *strokeColor = [UIColor blueColor];
  [strokeColor set];

  // æ ¹æ®æˆ‘ä»¬è®¾ç½®çš„å„ä¸ªç‚¹è¿çº¿
  [path stroke];
}
</code></pre>

<p>å¦‚æœè¦ç”»åªæœ‰ä¸€ä¸ªè§’æ˜¯åœ†è§’ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¿®æ”¹åˆ›å»ºæ–¹æ³•ï¼š</p>
<pre><code>
UIBezierPath *path = [UIBezierPath bezierPathWithRoundedRect:CGRectMake(20, 20, self.frame.size.width - 40, self.frame.size.height - 40) byRoundingCorners:UIRectCornerTopRight cornerRadii:CGSizeMake(20, 20)];
</code></pre>

<p>å…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä¸€æ ·æ˜¯ä¼ äº†ä¸ªçŸ©å½¢ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‡å®šåœ¨å“ªä¸ªæ–¹å‘ç”»åœ†è§’ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªCGSizeç±»å‹ï¼Œç”¨æ¥æŒ‡å®šæ°´å¹³å’Œå‚ç›´æ–¹å‘çš„åŠå¾„çš„å¤§å°ã€‚çœ‹ä¸‹æ•ˆæœå›¾ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/UIBezierPath/UIBezierPath_6.jpg?raw=true" alt="image"><br></div>

<h5 id="ç”»å¼§"><a href="#ç”»å¼§" class="headerlink" title="ç”»å¼§"></a>ç”»å¼§</h5><hr>
<p>ç”»å¼§å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å…¶å‚è€ƒç³»ï¼Œå¦‚ä¸‹å›¾ï¼ˆå›¾ç‰‡æ¥è‡ªç½‘ç»œï¼‰ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/UIBezierPath/UIBezierPath_7.jpg?raw=true" alt="image"><br></div>

<pre><code>
#define   kDegreesToRadians(degrees)  ((pi * degrees)/ 180)
- (void)drawARCPath {
  const CGFloat pi = 3.14159265359;

  CGPoint center = CGPointMake(self.frame.size.width / 2, self.frame.size.height / 2);
  UIBezierPath *path = [UIBezierPath bezierPathWithArcCenter:center
                                                      radius:100
                                                  startAngle:0
                                                    endAngle:kDegreesToRadians(135)
                                                   clockwise:YES];

  path.lineCapStyle = kCGLineCapRound;
  path.lineJoinStyle = kCGLineJoinRound;
  path.lineWidth = 5.0;

  UIColor *strokeColor = [UIColor redColor];
  [strokeColor set];

  [path stroke];
}
</code></pre>

<p>æ•ˆæœå›¾å¦‚ä¸‹ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/UIBezierPath/UIBezierPath_8.jpg?raw=true" alt="image"><br></div>

<p>æˆ‘ä»¬è¦æ˜ç¡®ä¸€ç‚¹ï¼Œç”»å¼§å‚æ•°startAngleå’ŒendAngleä½¿ç”¨çš„æ˜¯å¼§åº¦ï¼Œè€Œä¸æ˜¯è§’åº¦ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†å¸¸ç”¨çš„è§’åº¦è½¬æ¢æˆå¼§åº¦ã€‚å¯¹äºæ•ˆæœå›¾ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®å¼§çš„ä¸­å¿ƒä¸ºæ§ä»¶çš„ä¸­å¿ƒï¼Œèµ·ç‚¹å¼§åº¦ä¸º0ï¼Œä¹Ÿå°±æ˜¯æ­£ä¸œæ–¹å‘ï¼Œè€Œç»ˆç‚¹æ˜¯135åº¦è§’çš„ä½ç½®ã€‚å¦‚æœè®¾ç½®çš„clockwise:YESæ˜¯é€†æ—¶é’ˆæ–¹å‘ç»˜åˆ¶ï¼Œå¦‚æœè®¾ç½®ä¸ºNOï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/UIBezierPath/UIBezierPath_9.jpg?raw=true" alt="image"><br></div>

<p>è¿™ä¸¤è€…æ­£å¥½æ˜¯ç›¸åçš„ã€‚</p>
<h5 id="ç”»äºŒæ¬¡è´å¡å°”æ›²çº¿"><a href="#ç”»äºŒæ¬¡è´å¡å°”æ›²çº¿" class="headerlink" title="ç”»äºŒæ¬¡è´å¡å°”æ›²çº¿"></a>ç”»äºŒæ¬¡è´å¡å°”æ›²çº¿</h5><hr>
<p>å…ˆæ¥å­¦ä¹ ä¸€ä¸‹å…³äºæ§åˆ¶ç‚¹ï¼Œå¦‚ä¸‹å›¾ï¼ˆå›¾ç‰‡æ¥è‡ªç½‘ç»œï¼‰ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/UIBezierPath/UIBezierPath_10.jpeg?raw=true" alt="image"><br></div><br>ç”»äºŒæ¬¡è´å¡å°”æ›²çº¿ï¼Œæ˜¯é€šè¿‡è°ƒç”¨æ­¤æ–¹æ³•æ¥å®ç°çš„ï¼š<br><br><pre><code>- (void)addQuadCurveToPoint:(CGPoint)endPoint controlPoint:(CGPoint)controlPoint<br></code></pre><br><br>å‚æ•°è¯´æ˜ï¼š<br><br>endPointï¼šç»ˆç«¯ç‚¹<br><br>controlPointï¼šæ§åˆ¶ç‚¹ï¼Œå¯¹äºäºŒæ¬¡è´å¡å°”æ›²çº¿ï¼Œåªæœ‰ä¸€ä¸ªæ§åˆ¶ç‚¹<br><br>çœ‹æ•ˆæœå›¾ï¼š<br><div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/UIBezierPath/UIBezierPath_11.jpg?raw=true" alt="image"><br></div>

<pre><code>
- (void)drawSecondBezierPath {
  UIBezierPath *path = [UIBezierPath bezierPath];

  // é¦–å…ˆè®¾ç½®ä¸€ä¸ªèµ·å§‹ç‚¹
  [path moveToPoint:CGPointMake(20, self.frame.size.height - 100)];

  // æ·»åŠ äºŒæ¬¡æ›²çº¿
  [path addQuadCurveToPoint:CGPointMake(self.frame.size.width - 20, self.frame.size.height - 100)
               controlPoint:CGPointMake(self.frame.size.width / 2, 0)];

  path.lineCapStyle = kCGLineCapRound;
  path.lineJoinStyle = kCGLineJoinRound;
  path.lineWidth = 5.0;

  UIColor *strokeColor = [UIColor redColor];
  [strokeColor set];

  [path stroke];
}
</code></pre>

<p>ç”»äºŒæ¬¡è´å¡å°”æ›²çº¿çš„æ­¥éª¤ï¼š</p>
<ol>
<li>å…ˆè®¾ç½®ä¸€ä¸ªèµ·å§‹ç‚¹ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡-moveToPoint:è®¾ç½®</li>
<li>è°ƒç”¨-addQuadCurveToPoint:controlPoint:æ–¹æ³•è®¾ç½®ç»ˆç«¯ç‚¹å’Œæ§åˆ¶ç‚¹ï¼Œä»¥ç”»äºŒæ¬¡æ›²çº¿</li>
</ol>
<p>åœ¨æ•ˆæœå›¾ä¸­ï¼Œæ‹±æ¡¥å·¦è¾¹çš„èµ·å§‹ç‚¹å°±æ˜¯æˆ‘ä»¬è®¾ç½®çš„èµ·å§‹ç‚¹ï¼Œæœ€å³è¾¹çš„ç»ˆç‚¹ï¼Œå°±æ˜¯æˆ‘ä»¬è®¾ç½®çš„ç»ˆç«¯ç‚¹ï¼Œè€Œæˆ‘ä»¬è®¾ç½®çš„æ§åˆ¶ç‚¹ä¸ºï¼ˆwidth / 2, 0ï¼‰å¯¹åº”äºçº¢è‰²çŸ©å½¢ä¸­æ°´å¹³æ–¹å‘åœ¨æ­£ä¸­å¤®ï¼Œè€Œå‚ç›´æ–¹å‘åœ¨æœ€é¡¶éƒ¨ã€‚</p>
<blockquote>
<p>è¿™ä¸ªæ ·å¼çœ‹èµ·æ¥å¾ˆåƒsinæˆ–è€…coså‡½æ•°å§ï¼Ÿè¿™ä¸¤ä¸ªåªæ˜¯ç‰¹ä¾‹è€Œå·²ï¼Œå…¶å®å¯ä»¥ç”»ä»»æ„å›¾å½¢ï¼Œåªæ˜¯æƒ³ä¸åˆ°ï¼Œæ²¡æœ‰åšä¸åˆ°çš„ã€‚</p>
</blockquote>
<h5 id="ç”»ä¸‰æ¬¡è´å¡å°”æ›²çº¿"><a href="#ç”»ä¸‰æ¬¡è´å¡å°”æ›²çº¿" class="headerlink" title="ç”»ä¸‰æ¬¡è´å¡å°”æ›²çº¿"></a>ç”»ä¸‰æ¬¡è´å¡å°”æ›²çº¿</h5><hr>
<p>è´å¡å°”æ›²çº¿å¿…å®šé€šè¿‡é¦–å°¾ä¸¤ä¸ªç‚¹ï¼Œç§°ä¸ºç«¯ç‚¹ï¼›ä¸­é—´ä¸¤ä¸ªç‚¹è™½ç„¶æœªå¿…è¦é€šè¿‡ï¼Œä½†å´èµ·åˆ°ç‰µåˆ¶æ›²çº¿å½¢çŠ¶è·¯å¾„çš„ä½œç”¨ï¼Œç§°ä½œæ§åˆ¶ç‚¹ã€‚å…³äºä¸‰æ¬¡è´å¡å°”æ›²çº¿çš„æ§åˆ¶å™¨ï¼Œçœ‹ä¸‹å›¾ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/UIBezierPath/UIBezierPath_12.jpeg?raw=true" alt="image"><br></div>

<blockquote>
<p>æç¤ºï¼šå…¶ç»„æˆæ˜¯èµ·å§‹ç«¯ç‚¹+æ§åˆ¶ç‚¹1+æ§åˆ¶ç‚¹2+ç»ˆæ­¢ç«¯ç‚¹</p>
</blockquote>
<p>å¦‚ä¸‹æ–¹æ³•å°±æ˜¯ç”»ä¸‰æ¬¡è´å¡å°”æ›²çº¿çš„å…³é”®æ–¹æ³•ï¼Œä»¥ä¸‰ä¸ªç‚¹ç”»ä¸€æ®µæ›²çº¿ï¼Œä¸€èˆ¬å’Œ-moveToPoint:é…åˆä½¿ç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (void)addCurveToPoint:(CGPoint)endPoint </div><div class="line">          controlPoint1:(CGPoint)controlPoint1 </div><div class="line">          controlPoint2:(CGPoint)controlPoint2</div></pre></td></tr></table></figure>
<p>çœ‹ä¸‹æ•ˆæœå›¾ï¼š</p>
<div align="center"><br><img src="https://github.com/guiyongdong/Resource/blob/master/hexoImage/UIBezierPath/UIBezierPath_13.jpg?raw=true" alt="image"><br></div>

<p>å®ç°ä»£ç æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code>
- (void)drawThirdBezierPath {
  UIBezierPath *path = [UIBezierPath bezierPath];

  // è®¾ç½®èµ·å§‹ç«¯ç‚¹
  [path moveToPoint:CGPointMake(20, 150)];

  [path addCurveToPoint:CGPointMake(300, 150)
          controlPoint1:CGPointMake(160, 0)
          controlPoint2:CGPointMake(160, 250)];

  path.lineCapStyle = kCGLineCapRound;
  path.lineJoinStyle = kCGLineJoinRound;
  path.lineWidth = 5.0;

  UIColor *strokeColor = [UIColor redColor];
  [strokeColor set];

  [path stroke];
}
</code></pre>

<p>æˆ‘ä»¬éœ€è¦æ³¨æ„ï¼Œè¿™é‡Œç¡®å®šçš„èµ·å§‹ç«¯ç‚¹ä¸º(20,150)ï¼Œç»ˆæ­¢ç«¯ç‚¹ä¸º(300, 150)ï¼ŒåŸºæ°´å¹³æ–¹å‘æ˜¯ä¸€è‡´çš„ã€‚æ§åˆ¶ç‚¹1çš„åæ ‡æ˜¯ï¼ˆ160ï¼Œ0ï¼‰ï¼Œæ°´å¹³æ–¹å‘ç›¸å½“äºåœ¨ä¸­é—´é™„è¿‘ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥è°ƒæ•´ã€‚æ§åˆ¶ç‚¹2çš„åæ ‡æ˜¯ï¼ˆ160ï¼Œ250ï¼‰ï¼Œå¦‚æœä»¥ä¸¤ä¸ªç«¯ç‚¹çš„è¿çº¿ä¸ºæ°´å¹³çº¿ï¼Œé‚£ä¹ˆå°±æ˜¯250-150=100ï¼Œä¹Ÿå°±æ˜¯åœ¨æ°´å¹³çº¿ä¸‹100ã€‚è¿™æ ·çœ‹èµ·æ¥å°±åƒä¸€ä¸ªsinå‡½æ•°äº†ã€‚</p>
]]></content>
    </entry>
    
  
  
</search>
